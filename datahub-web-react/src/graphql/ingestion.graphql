# SPDX-License-Identifier: Apache-2.0
#
# This file is unmodified from its original version developed by Acryl Data, Inc.,
# and is now included as part of a repository maintained by the National Digital Twin Programme.
# All support, maintenance and further development of this code is now the responsibility
# of the National Digital Twin Programme.

query listIngestionSources($input: ListIngestionSourcesInput!) {
    listIngestionSources(input: $input) {
        start
        count
        total
        ingestionSources {
            ...ingestionSourceFields
            executions(start: 0, count: 1) {
                start
                count
                total
                executionRequests {
                    ...ingestionExecutionRequestFields
                }
            }
            ownership {
                ...ownershipFields
            }
        }
    }
}

query getIngestionSource($urn: String!, $runStart: Int, $runCount: Int) {
    ingestionSource(urn: $urn) {
        ...ingestionSourceFields
        executions(start: $runStart, count: $runCount) {
            start
            count
            total
            executionRequests {
                ...ingestionExecutionRequestFields
            }
        }
        ownership {
            ...ownershipFields
        }
    }
}

query getIngestionExecutionRequest($urn: String!) {
    executionRequest(urn: $urn) {
        ...ingestionExecutionRequestFields
    }
}

query listIngestionExecutionRequests($input: ListExecutionRequestsInput!) {
    listExecutionRequests(input: $input) {
        start
        total
        count
        executionRequests {
            ...ingestionExecutionRequestFields
            source {
                ...ingestionSourceFields
                latestSuccessfulExecution {
                    ...minimalIngestionExecutionRequestFields
                }
            }
        }
    }
}

mutation createIngestionSource($input: UpdateIngestionSourceInput!) {
    createIngestionSource(input: $input)
}

mutation updateIngestionSource($urn: String!, $input: UpdateIngestionSourceInput!) {
    updateIngestionSource(urn: $urn, input: $input)
}

mutation deleteIngestionSource($urn: String!) {
    deleteIngestionSource(urn: $urn)
}

query listSecrets($input: ListSecretsInput!) {
    listSecrets(input: $input) {
        start
        count
        total
        secrets {
            urn
            name
            description
        }
    }
}

mutation createSecret($input: CreateSecretInput!) {
    createSecret(input: $input)
}

mutation updateSecret($input: UpdateSecretInput!) {
    updateSecret(input: $input)
}

mutation deleteSecret($urn: String!) {
    deleteSecret(urn: $urn)
}

mutation createIngestionExecutionRequest($input: CreateIngestionExecutionRequestInput!) {
    createIngestionExecutionRequest(input: $input)
}

mutation cancelIngestionExecutionRequest($input: CancelIngestionExecutionRequestInput!) {
    cancelIngestionExecutionRequest(input: $input)
}

mutation createTestConnectionRequest($input: CreateTestConnectionRequestInput!) {
    createTestConnectionRequest(input: $input)
}

mutation rollbackIngestion($input: RollbackIngestionInput!) {
    rollbackIngestion(input: $input)
}
