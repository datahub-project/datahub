# SPDX-License-Identifier: Apache-2.0
#
# This file is unmodified from its original version developed by Acryl Data, Inc.,
# and is now included as part of a repository maintained by the National Digital Twin Programme.
# All support, maintenance and further development of this code is now the responsibility
# of the National Digital Twin Programme.

fragment childGlossaryTerm on GlossaryTerm {
    urn
    type
    name
    hierarchicalName
    properties {
        name
        description
    }
}

fragment glossaryNodeFields on GlossaryNode {
    urn
    type
    exists
    properties {
        name
        description
        customProperties {
            ...customPropertiesFields
        }
        createdOn {
            time
        }
    }
    ownership {
        ...ownershipFields
    }
    parentNodes {
        ...parentNodesFields
    }
    privileges {
        ...entityPrivileges
    }
    autoRenderAspects: aspects(input: { autoRenderOnly: true }) {
        ...autoRenderAspectFields
    }
    institutionalMemory {
        ...institutionalMemoryFields
    }
    structuredProperties {
        properties {
            ...structuredPropertiesFields
        }
    }
    forms {
        ...formsFields
    }
    childrenCount {
        termsCount
        nodesCount
    }
    displayProperties {
        ...displayPropertiesFields
    }
    ...notes
    settings {
        ...AssetSettingsFields
    }
}

query getGlossaryNode($urn: String!) {
    glossaryNode(urn: $urn) {
        ...glossaryNodeFields
    }
}

query getGlossaryNodeWithChildren($urn: String!) {
    glossaryNode(urn: $urn) {
        ...glossaryNodeFields
        children: relationships(input: { types: ["IsPartOf"], direction: INCOMING, start: 0, count: 1000 }) {
            total
            relationships {
                direction
                entity {
                    type
                    urn
                    ... on GlossaryNode {
                        ...glossaryNode
                    }
                    ... on GlossaryTerm {
                        ...childGlossaryTerm
                    }
                }
            }
        }
    }
}
