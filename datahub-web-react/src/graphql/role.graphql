# SPDX-License-Identifier: Apache-2.0
#
# This file is unmodified from its original version developed by Acryl Data, Inc.,
# and is now included as part of a repository maintained by the National Digital Twin Programme.
# All support, maintenance and further development of this code is now the responsibility
# of the National Digital Twin Programme.

query listRoles($input: ListRolesInput!) {
    listRoles(input: $input) {
        start
        count
        total
        roles {
            urn
            type
            name
            description
            users: relationships(input: { types: ["IsMemberOfRole"], direction: INCOMING, start: 0, count: 20 }) {
                start
                count
                total
                relationships {
                    entity {
                        urn
                        type
                        ... on CorpUser {
                            urn
                            type
                            username
                            info {
                                active
                                displayName
                                title
                                firstName
                                lastName
                                fullName
                            }
                            editableProperties {
                                displayName
                                title
                                pictureLink
                            }
                        }
                        ...entityDisplayNameFields
                    }
                }
            }
            policies: relationships(
                input: { types: ["IsAssociatedWithRole"], direction: INCOMING, start: 0, count: 10 }
            ) {
                start
                count
                total
                relationships {
                    entity {
                        ... on DataHubPolicy {
                            urn
                            type
                            name
                            relationships(input: { types: ["IsAssociatedWithRole"], direction: OUTGOING }) {
                                start
                                count
                                total
                            }
                        }
                    }
                }
            }
        }
    }
}

query getInviteToken($input: GetInviteTokenInput!) {
    getInviteToken(input: $input) {
        inviteToken
    }
}
