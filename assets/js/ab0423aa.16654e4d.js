"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[60101],{15680:(e,a,t)=>{t.d(a,{xA:()=>g,yg:()=>c});var r=t(96540);function n(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function l(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?l(Object(t),!0).forEach((function(a){n(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function o(e,a){if(null==e)return{};var t,r,n=function(e,a){if(null==e)return{};var t,r,n={},l=Object.keys(e);for(r=0;r<l.length;r++)t=l[r],a.indexOf(t)>=0||(n[t]=e[t]);return n}(e,a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var s=r.createContext({}),p=function(e){var a=r.useContext(s),t=a;return e&&(t="function"==typeof e?e(a):i(i({},a),e)),t},g=function(e){var a=p(e.components);return r.createElement(s.Provider,{value:a},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var a=e.children;return r.createElement(r.Fragment,{},a)}},m=r.forwardRef((function(e,a){var t=e.components,n=e.mdxType,l=e.originalType,s=e.parentName,g=o(e,["components","mdxType","originalType","parentName"]),u=p(t),m=n,c=u["".concat(s,".").concat(m)]||u[m]||d[m]||l;return t?r.createElement(c,i(i({ref:a},g),{},{components:t})):r.createElement(c,i({ref:a},g))}));function c(e,a){var t=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var l=t.length,i=new Array(l);i[0]=m;var o={};for(var s in a)hasOwnProperty.call(a,s)&&(o[s]=a[s]);o.originalType=e,o[u]="string"==typeof e?e:n,i[1]=o;for(var p=2;p<l;p++)i[p]=t[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},44849:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>g,contentTitle:()=>s,default:()=>c,frontMatter:()=>o,metadata:()=>p,toc:()=>u});t(96540);var r=t(15680);function n(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function l(e,a){return a=null!=a?a:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):function(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,r)}return t}(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})),e}function i(e,a){if(null==e)return{};var t,r,n=function(e,a){if(null==e)return{};var t,r,n={},l=Object.keys(e);for(r=0;r<l.length;r++)t=l[r],a.indexOf(t)>=0||(n[t]=e[t]);return n}(e,a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}const o={title:"DataHub Airflow Plugin Example DAGs",sidebar_label:"Airflow Plugin Example DAGs",slug:"/metadata-ingestion-modules/airflow-plugin/src/datahub_airflow_plugin/example_dags",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/metadata-ingestion-modules/airflow-plugin/src/datahub_airflow_plugin/example_dags/README.md"},s="DataHub Airflow Plugin Example DAGs",p={unversionedId:"metadata-ingestion-modules/airflow-plugin/src/datahub_airflow_plugin/example_dags/README",id:"metadata-ingestion-modules/airflow-plugin/src/datahub_airflow_plugin/example_dags/README",title:"DataHub Airflow Plugin Example DAGs",description:"This directory contains example DAGs demonstrating various features of the DataHub Airflow plugin.",source:"@site/genDocs/metadata-ingestion-modules/airflow-plugin/src/datahub_airflow_plugin/example_dags/README.md",sourceDirName:"metadata-ingestion-modules/airflow-plugin/src/datahub_airflow_plugin/example_dags",slug:"/metadata-ingestion-modules/airflow-plugin/src/datahub_airflow_plugin/example_dags",permalink:"/docs/metadata-ingestion-modules/airflow-plugin/src/datahub_airflow_plugin/example_dags",draft:!1,editUrl:"https://github.com/datahub-project/datahub/blob/master/metadata-ingestion-modules/airflow-plugin/src/datahub_airflow_plugin/example_dags/README.md",tags:[],version:"current",frontMatter:{title:"DataHub Airflow Plugin Example DAGs",sidebar_label:"Airflow Plugin Example DAGs",slug:"/metadata-ingestion-modules/airflow-plugin/src/datahub_airflow_plugin/example_dags",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/metadata-ingestion-modules/airflow-plugin/src/datahub_airflow_plugin/example_dags/README.md"}},g={},u=[{value:"Directory Structure",id:"directory-structure",level:2},{value:"Choosing the Right Examples",id:"choosing-the-right-examples",level:2},{value:"For Airflow 3.0+ Users",id:"for-airflow-30-users",level:3},{value:"For Airflow 2.x Users",id:"for-airflow-2x-users",level:3},{value:"For Cross-Version Support",id:"for-cross-version-support",level:3},{value:"Example Categories",id:"example-categories",level:2},{value:"1. Lineage Collection",id:"1-lineage-collection",level:3},{value:"2. Metadata Ingestion",id:"2-metadata-ingestion",level:3},{value:"3. Advanced Features",id:"3-advanced-features",level:3},{value:"Key Differences: Airflow 2 vs 3",id:"key-differences-airflow-2-vs-3",level:2},{value:"DAG Parameters",id:"dag-parameters",level:3},{value:"Hooks Import",id:"hooks-import",level:3},{value:"Start Date",id:"start-date",level:3},{value:"Running the Examples",id:"running-the-examples",level:2},{value:"Additional Resources",id:"additional-resources",level:2}],d={toc:u},m="wrapper";function c(e){var{components:a}=e,t=i(e,["components"]);return(0,r.yg)(m,l(function(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(a){n(e,a,t[a])}))}return e}({},d,t),{components:a,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"datahub-airflow-plugin-example-dags"},"DataHub Airflow Plugin Example DAGs"),(0,r.yg)("p",null,"This directory contains example DAGs demonstrating various features of the DataHub Airflow plugin."),(0,r.yg)("h2",{id:"directory-structure"},"Directory Structure"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"example_dags/\n\u251c\u2500\u2500 airflow2/          # Airflow 2.x examples (with compatibility layers)\n\u2502   \u251c\u2500\u2500 lineage_backend_demo.py\n\u2502   \u251c\u2500\u2500 lineage_backend_taskflow_demo.py\n\u2502   \u251c\u2500\u2500 snowflake_sample_dag.py\n\u2502   \u251c\u2500\u2500 mysql_sample_dag.py\n\u2502   \u251c\u2500\u2500 generic_recipe_sample_dag.py\n\u2502   \u251c\u2500\u2500 lineage_emission_dag.py\n\u2502   \u2514\u2500\u2500 graph_usage_sample_dag.py\n\u2502\n\u251c\u2500\u2500 airflow3/          # Airflow 3.0+ examples (native syntax, no compatibility)\n\u2502   \u251c\u2500\u2500 lineage_backend_demo.py\n\u2502   \u251c\u2500\u2500 lineage_backend_taskflow_demo.py\n\u2502   \u2514\u2500\u2500 snowflake_sample_dag.py\n\u2502\n\u2514\u2500\u2500 *.py               # Legacy examples (deprecated - use airflow2/ or airflow3/)\n")),(0,r.yg)("h2",{id:"choosing-the-right-examples"},"Choosing the Right Examples"),(0,r.yg)("h3",{id:"for-airflow-30-users"},"For Airflow 3.0+ Users"),(0,r.yg)("p",null,"Use the examples in ",(0,r.yg)("inlineCode",{parentName:"p"},"airflow3/"),". These DAGs:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Use native Airflow 3.0 syntax (",(0,r.yg)("inlineCode",{parentName:"li"},"schedule")," instead of ",(0,r.yg)("inlineCode",{parentName:"li"},"schedule_interval"),")"),(0,r.yg)("li",{parentName:"ul"},"Don't include compatibility layers"),(0,r.yg)("li",{parentName:"ul"},"Are simpler and easier to read"),(0,r.yg)("li",{parentName:"ul"},"Demonstrate best practices for Airflow 3.0+")),(0,r.yg)("h3",{id:"for-airflow-2x-users"},"For Airflow 2.x Users"),(0,r.yg)("p",null,"Use the examples in ",(0,r.yg)("inlineCode",{parentName:"p"},"airflow2/"),". These DAGs:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Work across Airflow 2.3 through 2.9"),(0,r.yg)("li",{parentName:"ul"},"Include compatibility helpers from ",(0,r.yg)("inlineCode",{parentName:"li"},"_airflow_version_specific.py")),(0,r.yg)("li",{parentName:"ul"},"Handle parameter name changes between versions")),(0,r.yg)("h3",{id:"for-cross-version-support"},"For Cross-Version Support"),(0,r.yg)("p",null,"If you need DAGs that work on both Airflow 2.x and 3.x:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"See ",(0,r.yg)("inlineCode",{parentName:"li"},"airflow2/")," examples for patterns using ",(0,r.yg)("inlineCode",{parentName:"li"},"get_airflow_compatible_dag_kwargs()")),(0,r.yg)("li",{parentName:"ul"},"Use ",(0,r.yg)("inlineCode",{parentName:"li"},"days_ago()")," helper for start_date compatibility"),(0,r.yg)("li",{parentName:"ul"},"Import hooks conditionally based on Airflow version")),(0,r.yg)("h2",{id:"example-categories"},"Example Categories"),(0,r.yg)("h3",{id:"1-lineage-collection"},"1. Lineage Collection"),(0,r.yg)("p",null,"Examples showing how to automatically collect lineage from your Airflow DAGs:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"lineage_backend_demo.py"),": Basic lineage collection using ",(0,r.yg)("inlineCode",{parentName:"li"},"inlets")," and ",(0,r.yg)("inlineCode",{parentName:"li"},"outlets")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"lineage_backend_taskflow_demo.py"),": Lineage with TaskFlow API (",(0,r.yg)("inlineCode",{parentName:"li"},"@task")," decorator)")),(0,r.yg)("h3",{id:"2-metadata-ingestion"},"2. Metadata Ingestion"),(0,r.yg)("p",null,"Examples showing how to ingest metadata from data sources into DataHub:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"snowflake_sample_dag.py"),": Ingest Snowflake metadata"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"mysql_sample_dag.py"),": Ingest MySQL metadata"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"generic_recipe_sample_dag.py"),": Run any DataHub ingestion recipe")),(0,r.yg)("h3",{id:"3-advanced-features"},"3. Advanced Features"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"lineage_emission_dag.py"),": Directly emit custom lineage using ",(0,r.yg)("inlineCode",{parentName:"li"},"DatahubEmitterOperator")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"graph_usage_sample_dag.py"),": Complex DAG graphs with multiple task dependencies")),(0,r.yg)("h2",{id:"key-differences-airflow-2-vs-3"},"Key Differences: Airflow 2 vs 3"),(0,r.yg)("h3",{id:"dag-parameters"},"DAG Parameters"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-python"},'# Airflow 2.x\nDAG(\n    schedule_interval=timedelta(days=1),\n    default_view="tree",  # Removed in Airflow 3\n)\n\n# Airflow 3.0+\nDAG(\n    schedule=timedelta(days=1),\n    # default_view parameter removed\n)\n')),(0,r.yg)("h3",{id:"hooks-import"},"Hooks Import"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-python"},"# Airflow 2.x\nfrom airflow.hooks.base import BaseHook\n\n# Airflow 3.0+\nfrom airflow.hooks.base_hook import BaseHook\n")),(0,r.yg)("h3",{id:"start-date"},"Start Date"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-python"},"# Airflow 2.x (compatibility helper)\nfrom datahub_airflow_plugin._airflow_version_specific import days_ago\nstart_date=days_ago(2)\n\n# Airflow 3.0+ (direct)\nfrom datetime import datetime\nstart_date=datetime(2023, 1, 1)\n")),(0,r.yg)("h2",{id:"running-the-examples"},"Running the Examples"),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Copy the appropriate example to your Airflow DAGs folder:"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"# For Airflow 3.0+\ncp airflow3/lineage_backend_demo.py $AIRFLOW_HOME/dags/\n\n# For Airflow 2.x\ncp airflow2/lineage_backend_demo.py $AIRFLOW_HOME/dags/\n"))),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Configure the DataHub connection in Airflow:"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"airflow connections add datahub_rest_default \\\n  --conn-type datahub-rest \\\n  --conn-host http://localhost:8080\n"))),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Enable the DAG in the Airflow UI or trigger it manually:"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"airflow dags trigger datahub_lineage_backend_demo\n")))),(0,r.yg)("h2",{id:"additional-resources"},"Additional Resources"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"https://datahubproject.io/docs/lineage/airflow/"},"DataHub Airflow Plugin Documentation")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"https://airflow.apache.org/docs/apache-airflow/stable/migration-guide.html"},"Airflow 3.0 Migration Guide")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"https://datahubproject.io/docs/metadata-ingestion/"},"DataHub Metadata Ingestion"))))}c.isMDXComponent=!0}}]);