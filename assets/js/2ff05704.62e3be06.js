"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[77045],{7653:(e,t,a)=>{a.d(t,{A:()=>n});const n={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"}},4732:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(89379),o=a(96540),r=a(7653),s=a(89990),i=function(e,t){return o.createElement(s.A,(0,n.A)((0,n.A)({},e),{},{ref:t,icon:r.A}))};const l=o.forwardRef(i)},15680:(e,t,a)=>{a.d(t,{xA:()=>c,yg:()=>g});var n=a(96540);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var l=n.createContext({}),u=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},c=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=u(a),h=o,g=p["".concat(l,".").concat(h)]||p[h]||m[h]||r;return a?n.createElement(g,s(s({ref:t},c),{},{components:a})):n.createElement(g,s({ref:t},c))}));function g(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,s=new Array(r);s[0]=h;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[p]="string"==typeof e?e:o,s[1]=i;for(var u=2;u<r;u++)s[u]=a[u];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},43655:(e,t,a)=>{a.d(t,{A:()=>b});var n=a(96540),o=a(20053);const r="availabilityCard_P5od",s="managedIcon_AxXO",i="platform_wqXv",l="platformAvailable_Y8lN";var u=a(4732),c=a(89379);const p={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"};var m=a(89990),h=function(e,t){return n.createElement(m.A,(0,c.A)((0,c.A)({},e),{},{ref:t,icon:p}))};const g=n.forwardRef(h);const d={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M811.4 418.7C765.6 297.9 648.9 212 512.2 212S258.8 297.8 213 418.6C127.3 441.1 64 519.1 64 612c0 110.5 89.5 200 199.9 200h496.2C870.5 812 960 722.5 960 612c0-92.7-63.1-170.7-148.6-193.3zm36.3 281a123.07 123.07 0 01-87.6 36.3H263.9c-33.1 0-64.2-12.9-87.6-36.3A123.3 123.3 0 01140 612c0-28 9.1-54.3 26.2-76.3a125.7 125.7 0 0166.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10c54.3 14.5 92.1 63.8 92.1 120 0 33.1-12.9 64.3-36.3 87.7z"}}]},name:"cloud",theme:"outlined"};var y=function(e,t){return n.createElement(m.A,(0,c.A)((0,c.A)({},e),{},{ref:t,icon:d}))};const f=n.forwardRef(y),b=({saasOnly:e,ossOnly:t})=>n.createElement("div",{className:(0,o.A)(r,"card")},n.createElement("strong",null,"Feature Availability"),n.createElement("div",null,n.createElement("span",{className:(0,o.A)(i,!e&&l)},"Self-Hosted DataHub ",e?n.createElement(u.A,null):n.createElement(g,null))),n.createElement("div",null,n.createElement(f,{className:s}),n.createElement("span",{className:(0,o.A)(i,!t&&l)},"DataHub Cloud ",t?n.createElement(u.A,null):n.createElement(g,null))))},59565:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>u,default:()=>d,frontMatter:()=>l,metadata:()=>c,toc:()=>m});a(96540);var n=a(15680),o=a(43655);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})),e}function i(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}const l={description:"This page provides an overview of working with DataHub Column Assertions",title:"Column Assertions",slug:"/managed-datahub/observe/column-assertions",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/managed-datahub/observe/column-assertions.md"},u="Column Assertions",c={unversionedId:"docs/managed-datahub/observe/column-assertions",id:"version-1.1.0/docs/managed-datahub/observe/column-assertions",title:"Column Assertions",description:"This page provides an overview of working with DataHub Column Assertions",source:"@site/versioned_docs/version-1.1.0/docs/managed-datahub/observe/column-assertions.md",sourceDirName:"docs/managed-datahub/observe",slug:"/managed-datahub/observe/column-assertions",permalink:"/docs/1.1.0/managed-datahub/observe/column-assertions",draft:!1,editUrl:"https://github.com/datahub-project/datahub/blob/master/docs/managed-datahub/observe/column-assertions.md",tags:[],version:"1.1.0",frontMatter:{description:"This page provides an overview of working with DataHub Column Assertions",title:"Column Assertions",slug:"/managed-datahub/observe/column-assertions",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/managed-datahub/observe/column-assertions.md"},sidebar:"overviewSidebar",previous:{title:"Assertions",permalink:"/docs/1.1.0/managed-datahub/observe/assertions"},next:{title:"Custom SQL Assertions",permalink:"/docs/1.1.0/managed-datahub/observe/custom-sql-assertions"}},p={},m=[{value:"Introduction",id:"introduction",level:2},{value:"Support",id:"support",level:2},{value:"What is a Column Assertion?",id:"what-is-a-column-assertion",level:2},{value:"Anatomy of Column Assertion",id:"anatomy-of-column-assertion",level:3},{value:"1. Evaluation Schedule",id:"1-evaluation-schedule",level:4},{value:"2. Column Selection",id:"2-column-selection",level:4},{value:"3. Evaluation Criteria",id:"3-evaluation-criteria",level:4},{value:"4. Row Selection Set",id:"4-row-selection-set",level:4},{value:"Creating a Column Assertion",id:"creating-a-column-assertion",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Steps",id:"steps",level:3},{value:"Stopping a Column Assertion",id:"stopping-a-column-assertion",level:2},{value:"Creating Column Assertions via API",id:"creating-column-assertions-via-api",level:2},{value:"GraphQL",id:"graphql",level:4},{value:"Examples",id:"examples",level:5},{value:"Tips",id:"tips",level:3}],h={toc:m},g="wrapper";function d(e){var{components:t}=e,a=i(e,["components"]);return(0,n.yg)(g,s(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){r(e,t,a[t])}))}return e}({},h,a),{components:t,mdxType:"MDXLayout"}),(0,n.yg)("h1",{id:"column-assertions"},"Column Assertions"),(0,n.yg)(o.A,{saasOnly:!0,mdxType:"FeatureAvailability"}),(0,n.yg)("blockquote",null,(0,n.yg)("p",{parentName:"blockquote"},"The ",(0,n.yg)("strong",{parentName:"p"},"Column Assertions")," feature is available as part of the ",(0,n.yg)("strong",{parentName:"p"},"DataHub Cloud Observe")," module of DataHub Cloud.\nIf you are interested in learning more about ",(0,n.yg)("strong",{parentName:"p"},"DataHub Cloud Observe")," or trying it out, please ",(0,n.yg)("a",{parentName:"p",href:"https://datahub.com/products/data-observability/"},"visit our website"),".")),(0,n.yg)("h2",{id:"introduction"},"Introduction"),(0,n.yg)("p",null,"Can you remember a time when an important warehouse table column changed dramatically, with little or no notice? Perhaps the number of null values suddenly spiked, or a new value was added to a fixed set of possible values. If the answer is yes, how did you initially find out? We'll take a guess - someone looking at an internal reporting dashboard or worse, a user using your your product, sounded an alarm when a number looked a bit out of the ordinary."),(0,n.yg)("p",null,"There are many reasons why important columns in your Snowflake, Redshift, BigQuery, or Databricks tables may change - application code bugs, new feature rollouts, etc. Oftentimes, these changes break important assumptions made about the data used in building key downstream data products like reporting dashboards or data-driven product features."),(0,n.yg)("p",null,"What if you could reduce the time to detect these incidents, so that the people responsible for the data were made aware of data issues before anyone else? With DataHub Cloud Column Assertions, you can."),(0,n.yg)("p",null,"With DataHub Cloud, you can define ",(0,n.yg)("strong",{parentName:"p"},"Column Value")," assertions to ensure each value in a column matches specific constraints, and ",(0,n.yg)("strong",{parentName:"p"},"Column Metric")," assertions to ensure that computed metrics from columns align with your expectations. As soon as things go wrong, your team will be the first to know, before the data issue becomes a larger data incident."),(0,n.yg)("p",null,"In this guide, we'll cover the basics of Column Assertions - what they are, how to configure them, and more - so that you and your team can start building trust in your most important data assets."),(0,n.yg)("p",null,"Let's dive in!"),(0,n.yg)("h2",{id:"support"},"Support"),(0,n.yg)("p",null,"Column Assertions are currently supported for:"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},"Snowflake"),(0,n.yg)("li",{parentName:"ol"},"Redshift"),(0,n.yg)("li",{parentName:"ol"},"BigQuery"),(0,n.yg)("li",{parentName:"ol"},"Databricks"),(0,n.yg)("li",{parentName:"ol"},"DataHub Dataset Profile Metrics (collected via ingestion)")),(0,n.yg)("p",null,"Note that an Ingestion Source ",(0,n.yg)("em",{parentName:"p"},"must")," be configured with the data platform of your choice in\nDataHub Cloud's ",(0,n.yg)("strong",{parentName:"p"},"Ingestion")," tab."),(0,n.yg)("blockquote",null,(0,n.yg)("p",{parentName:"blockquote"},"Note that Column Assertions are not yet supported if you are connecting to your warehouse\nusing the DataHub CLI.")),(0,n.yg)("h2",{id:"what-is-a-column-assertion"},"What is a Column Assertion?"),(0,n.yg)("p",null,"A ",(0,n.yg)("strong",{parentName:"p"},"Column Assertion")," is a highly configurable Data Quality rule used to monitor specific columns of a Data Warehouse table for unexpected changes."),(0,n.yg)("p",null,"Column Assertions are defined to validate a specific column, and can be used to"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},"Validate that the values of the column match some constraints (regex, allowed values, max, min, etc) across rows OR"),(0,n.yg)("li",{parentName:"ol"},"Validate that specific column aggregation metrics match some expectations across rows.")),(0,n.yg)("p",null,'Column Assertions can be particularly useful for documenting and enforcing column-level "contracts", i.e. formal specifications about the expected contents of a particular column that can be used for coordinating among producers and consumers of the data.'),(0,n.yg)("h3",{id:"anatomy-of-column-assertion"},"Anatomy of Column Assertion"),(0,n.yg)("p",null,"Column Assertions can be divided into two main types: ",(0,n.yg)("strong",{parentName:"p"},"Column Value")," and ",(0,n.yg)("strong",{parentName:"p"},"Column Metric")," Assertions."),(0,n.yg)("p",null,"A ",(0,n.yg)("strong",{parentName:"p"},"Column Value Assertion")," is used to monitor the value of a specific column in a table, and ensure that every row\nadheres to a specific condition. In comparison, a ",(0,n.yg)("strong",{parentName:"p"},"Column Metric Assertion")," is used to compute a metric for that column,\nand ensure that the value of that metric adheres to a specific condition."),(0,n.yg)("p",null,"At the most basic level, both types consist of a few important parts:"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},"An ",(0,n.yg)("strong",{parentName:"li"},"Evaluation Schedule")),(0,n.yg)("li",{parentName:"ol"},"A ",(0,n.yg)("strong",{parentName:"li"},"Column Selection")),(0,n.yg)("li",{parentName:"ol"},"A ",(0,n.yg)("strong",{parentName:"li"},"Evaluation Criteria")),(0,n.yg)("li",{parentName:"ol"},"A ",(0,n.yg)("strong",{parentName:"li"},"Row Evaluation Type"))),(0,n.yg)("p",null,"In this section, we'll give an overview of each."),(0,n.yg)("h4",{id:"1-evaluation-schedule"},"1. Evaluation Schedule"),(0,n.yg)("p",null,"The ",(0,n.yg)("strong",{parentName:"p"},"Evaluation Schedule"),": This defines how often to evaluate the Column Assertion against the given warehouse table.\nThis should usually be configured to match the expected change frequency of the table, although it can also be less\nfrequently depending on your requirements. You can also specify specific days of the week, hours in the day, or even\nminutes in an hour."),(0,n.yg)("h4",{id:"2-column-selection"},"2. Column Selection"),(0,n.yg)("p",null,"The ",(0,n.yg)("strong",{parentName:"p"},"Column Selection"),": This defines the column that should be monitored by the Column Assertion. You can choose from\nany of the columns from the table listed in the dropdown. Note that columns of struct / object type are not currently supported."),(0,n.yg)("h4",{id:"3-evaluation-criteria"},"3. Evaluation Criteria"),(0,n.yg)("p",null,"The ",(0,n.yg)("strong",{parentName:"p"},"Evaluation Criteria"),": This defines the condition that must be satisfied in order for the Column\nAssertion to pass."),(0,n.yg)("p",null,"For ",(0,n.yg)("strong",{parentName:"p"},"Column Value Assertions"),", you will be able to choose from a set of operators that can be applied to the column\nvalue. The options presented will vary based on the data type of the selected column. For example, if you've selected a numeric column, you\ncan verify that the column value is greater than a particular value. For string types, you can check that the column value\nmatches a particular regex pattern. Additionally, you are able to control the behavior of the check in the presence of NULL values. If the\n",(0,n.yg)("strong",{parentName:"p"},"Allow Nulls")," option is ",(0,n.yg)("em",{parentName:"p"},"disabled"),", then any null values encountered will be reported as a failure when evaluating the\nassertion. If ",(0,n.yg)("strong",{parentName:"p"},"Allow Nulls")," is enabled, then nulls will be ignored; the condition will be evaluated for rows where the column value is non-null."),(0,n.yg)("p",null,"For ",(0,n.yg)("strong",{parentName:"p"},"Column Metric Assertions"),", you will be able to choose from a list of common column metrics - MAX, MIN, MEAN, NULL COUNT, etc - and then compare these metric values to an expected value. The list of metrics will vary based on the type of the selected column. For example\nif you've selected a numeric column, you can choose to compute the MEAN value of the column, and then assert that it is greater than a\nspecific number. For string types, you can choose to compute the MAX LENGTH of the string across all column values, and then assert that it\nis less than a specific number."),(0,n.yg)("h4",{id:"4-row-selection-set"},"4. Row Selection Set"),(0,n.yg)("p",null,"The ",(0,n.yg)("strong",{parentName:"p"},"Row Selection Set"),": This defines which rows in the table the Column Assertion will be evaluated across. You can choose\nfrom the following options:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"All Table Rows"),": Evaluate the Column Assertion across all rows in the table. This is the default option. Note that\nthis may not be desirable for large tables.")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"Only Rows That Have Changed"),": Evaluate the Column Assertion only against rows that have changed since the last\nevaluation of the assertion. If you choose this option, you will need to specify a ",(0,n.yg)("strong",{parentName:"p"},"High Watermark Column")," to help determine which rows\nhave changed. A ",(0,n.yg)("strong",{parentName:"p"},"High Watermark Column"),' is a column that contains a constantly incrementing value - a date, a time, or\nanother always-increasing number - that can be used to find the "new rows" that were added since previous evaluation. When selected, a query will be issued to the table to find only the rows that have changed since the previous assertion evaluation.'))),(0,n.yg)("h2",{id:"creating-a-column-assertion"},"Creating a Column Assertion"),(0,n.yg)("h3",{id:"prerequisites"},"Prerequisites"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"Permissions"),": To create or delete Column Assertions for a specific entity on DataHub, you'll need to be granted the\n",(0,n.yg)("inlineCode",{parentName:"p"},"Edit Assertions")," and ",(0,n.yg)("inlineCode",{parentName:"p"},"Edit Monitors")," privileges for the entity. This will be granted to Entity owners as part of the ",(0,n.yg)("inlineCode",{parentName:"p"},"Asset Owners - Metadata Policy"),"\nby default.")),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},"(Optional) ",(0,n.yg)("strong",{parentName:"p"},"Data Platform Connection"),": In order to create a Column Assertion that queries the data source directly (instead of DataHub metadata), you'll need to have an ",(0,n.yg)("strong",{parentName:"p"},"Ingestion Source"),"\nconfigured to your Data Platform: Snowflake, BigQuery, or Redshift under the ",(0,n.yg)("strong",{parentName:"p"},"Ingestion")," tab."))),(0,n.yg)("p",null,"Once these are in place, you're ready to create your Column Assertions!"),(0,n.yg)("h3",{id:"steps"},"Steps"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},"Navigate to the Table that you want to monitor"),(0,n.yg)("li",{parentName:"ol"},"Click the ",(0,n.yg)("strong",{parentName:"li"},"Validations")," tab")),(0,n.yg)("p",{align:"left"},(0,n.yg)("img",{width:"90%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/observe/freshness/profile-validation-tab.png"})),(0,n.yg)("ol",{start:3},(0,n.yg)("li",{parentName:"ol"},"Click ",(0,n.yg)("strong",{parentName:"li"},"+ Create Assertion"))),(0,n.yg)("p",{align:"left"},(0,n.yg)("img",{width:"40%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/observe/column/assertion-builder-column-choose-type.png"})),(0,n.yg)("ol",{start:4},(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},"Choose ",(0,n.yg)("strong",{parentName:"p"},"Column"))),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},"Configure the evaluation ",(0,n.yg)("strong",{parentName:"p"},"schedule"),". This is the frequency at which the assertion will be evaluated to produce a\npass or fail result, and the times when the column values will be checked.")),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},"Configure the ",(0,n.yg)("strong",{parentName:"p"},"column assertion type"),". You can choose from ",(0,n.yg)("strong",{parentName:"p"},"Column Value")," or ",(0,n.yg)("strong",{parentName:"p"},"Column Metric"),".\n",(0,n.yg)("strong",{parentName:"p"},"Column Value")," assertions are used to monitor the value of a specific column in a table, and ensure that every row\nadheres to a specific condition. ",(0,n.yg)("strong",{parentName:"p"},"Column Metric")," assertions are used to compute a metric for that column, and then compare the value of that metric to your expectations."))),(0,n.yg)("p",{align:"left"},(0,n.yg)("img",{width:"30%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/observe/column/assertion-builder-column-assertion-type.png"})),(0,n.yg)("ol",{start:7},(0,n.yg)("li",{parentName:"ol"},"Configure the ",(0,n.yg)("strong",{parentName:"li"},"column selection"),". This defines the column that should be monitored by the Column Assertion.\nYou can choose from any of the columns from the table listed in the dropdown.")),(0,n.yg)("p",{align:"left"},(0,n.yg)("img",{width:"30%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/observe/column/assertion-builder-column-field-selection.png"})),(0,n.yg)("ol",{start:8},(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},"Configure the ",(0,n.yg)("strong",{parentName:"p"},"evaluation criteria"),". This step varies based on the type of assertion you chose in the previous step."),(0,n.yg)("ul",{parentName:"li"},(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"Column Value Assertions"),": You will be able to choose from a set of operators that can be applied to the column\nvalue. The options presented will vary based on the data type of the selected column. For example with numeric types, you\ncan check that the column value is greater than a specific value. For string types, you can check that the column value\nmatches a particular regex pattern. You will also be able to control the behavior of null values in the column. If the\n",(0,n.yg)("strong",{parentName:"p"},"Allow Nulls")," option is ",(0,n.yg)("em",{parentName:"p"},"disabled"),", any null values encountered will be reported as a failure when evaluating the\nassertion.")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"Column Metric Assertions"),": You will be able to choose from a list of common metrics and then specify the operator\nand value to compare against. The list of metrics will vary based on the data type of the selected column. For example\nwith numeric types, you can choose to compute the average value of the column, and then assert that it is greater than a\nspecific number. For string types, you can choose to compute the max length of all column values, and then assert that it\nis less than a specific number.")))),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},"Configure the ",(0,n.yg)("strong",{parentName:"p"},"row evaluation type"),". This defines which rows in the table the Column Assertion should evaluate. You can choose\nfrom the following options:"),(0,n.yg)("ul",{parentName:"li"},(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"All Table Rows"),": Evaluate the Column Assertion against all rows in the table. This is the default option. Note that\nthis may not be desirable for large tables.")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"Only Rows That Have Changed"),": Evaluate the Column Assertion only against rows that have changed since the last\nevaluation. If you choose this option, you will need to specify a ",(0,n.yg)("strong",{parentName:"p"},"High Watermark Column")," to help determine which rows\nhave changed. A ",(0,n.yg)("strong",{parentName:"p"},"High Watermark Column")," is a column that contains a constantly-incrementing value - a date, a time, or\nanother always-increasing number. When selected, a query will be issued to the table find only the rows which have changed since the last assertion run."))))),(0,n.yg)("p",{align:"left"},(0,n.yg)("img",{width:"60%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/observe/column/assertion-builder-column-row-evaluation-type.png"})),(0,n.yg)("ol",{start:10},(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},"(Optional) Click ",(0,n.yg)("strong",{parentName:"p"},"Advanced")," to further customize the Column Assertion. The options listed here will vary based on the\ntype of assertion you chose in the previous step."),(0,n.yg)("ul",{parentName:"li"},(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"Invalid Values Threshold"),": For ",(0,n.yg)("strong",{parentName:"p"},"Column Value")," assertions, you can configure the number of invalid values\n(i.e. rows) that are allowed to fail before the assertion is marked as failing. This is useful if you want to allow a limited number\nof invalid values in the column. By default this is 0, meaning the assertion will fail if any rows have an invalid column value.")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"Source"),": For ",(0,n.yg)("strong",{parentName:"p"},"Column Metric")," assertions, you can choose the mechanism that will be used to obtain the column\nmetric. ",(0,n.yg)("strong",{parentName:"p"},"Query")," will issue a query to the dataset to compute the metric. ",(0,n.yg)("strong",{parentName:"p"},"DataHub Dataset Profile")," will use the\nDataHub Dataset Profile metadata to compute the metric. Note that this option requires that dataset profiling\nstatistics are up-to-date as of the assertion run time.")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("p",{parentName:"li"},(0,n.yg)("strong",{parentName:"p"},"Additional Filters"),": You can choose to add additional filters to the query that will be used to evaluate the\nassertion. This is useful if you want to limit the assertion to a subset of rows in the table. Note this option will not\nbe available if you choose ",(0,n.yg)("strong",{parentName:"p"},"DataHub Dataset Profile")," as the ",(0,n.yg)("strong",{parentName:"p"},"source"),".")))),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("p",{parentName:"li"},"Configure actions that should be taken when the Column Assertion passes or fails"))),(0,n.yg)("p",{align:"left"},(0,n.yg)("img",{width:"45%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/observe/shared/assertion-builder-actions.png"})),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Raise incident"),": Automatically raise a new DataHub ",(0,n.yg)("inlineCode",{parentName:"li"},"Column")," Incident for the Table whenever the Column Assertion is failing. This\nmay indicate that the Table is unfit for consumption. Configure Slack Notifications under ",(0,n.yg)("strong",{parentName:"li"},"Settings")," to be notified when\nan incident is created due to an Assertion failure."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Resolve incident"),": Automatically resolved any incidents that were raised due to failures in this Column Assertion. Note that\nany other incidents will not be impacted.")),(0,n.yg)("ol",{start:12},(0,n.yg)("li",{parentName:"ol"},"Click ",(0,n.yg)("strong",{parentName:"li"},"Next")," and then ",(0,n.yg)("strong",{parentName:"li"},"Save"),".")),(0,n.yg)("p",null,"And that's it! DataHub will now begin to monitor your Column Assertion for the table."),(0,n.yg)("p",null,"Once your assertion has run, you will begin to see Success or Failure status for the Table"),(0,n.yg)("p",{align:"left"},(0,n.yg)("img",{width:"40%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/observe/column/profile-passing-column-assertions-expanded.png"})),(0,n.yg)("h2",{id:"stopping-a-column-assertion"},"Stopping a Column Assertion"),(0,n.yg)("p",null,"In order to temporarily stop the evaluation of the assertion:"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},"Navigate to the ",(0,n.yg)("strong",{parentName:"li"},"Validations")," tab of the Table with the assertion"),(0,n.yg)("li",{parentName:"ol"},"Click ",(0,n.yg)("strong",{parentName:"li"},"Column")," to open the Column Assertion assertions"),(0,n.yg)("li",{parentName:"ol"},'Click the "Stop" button for the assertion you wish to pause.')),(0,n.yg)("p",{align:"left"},(0,n.yg)("img",{width:"25%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/observe/shared/stop-assertion.png"})),(0,n.yg)("p",null,"To resume the assertion, simply click ",(0,n.yg)("strong",{parentName:"p"},"Start"),"."),(0,n.yg)("p",{align:"left"},(0,n.yg)("img",{width:"25%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/observe/shared/start-assertion.png"})),(0,n.yg)("h2",{id:"creating-column-assertions-via-api"},"Creating Column Assertions via API"),(0,n.yg)("p",null,"Under the hood, DataHub Cloud implements Column Assertion Monitoring using two concepts:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Assertion"),': The specific expectation for the column metric. e.g. "The value of an integer column is greater than 10 for all rows in the table." This is the "what".'),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Monitor"),': The process responsible for evaluating the Assertion on a given evaluation schedule and using specific\nmechanisms. This is the "how".')),(0,n.yg)("p",null,"Note that to create or delete Assertions and Monitors for a specific entity on DataHub, you'll need the\n",(0,n.yg)("inlineCode",{parentName:"p"},"Edit Assertions")," and ",(0,n.yg)("inlineCode",{parentName:"p"},"Edit Monitors")," privileges for it."),(0,n.yg)("h4",{id:"graphql"},"GraphQL"),(0,n.yg)("p",null,"In order to create or update a Column Assertion, you can the ",(0,n.yg)("inlineCode",{parentName:"p"},"upsertDatasetColumnAssertionMonitor")," mutation."),(0,n.yg)("h5",{id:"examples"},"Examples"),(0,n.yg)("p",null,"Creating a Field Values Column Assertion that runs every 8 hours:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-graphql"},'mutation upsertDatasetFieldAssertionMonitor {\n  upsertDatasetFieldAssertionMonitor(\n    input: {\n      entityUrn: "<urn of entity being monitored>"\n      type: FIELD_VALUES\n      fieldValuesAssertion: {\n        field: {\n          path: "<name of the column to be monitored>"\n          type: "NUMBER"\n          nativeType: "NUMBER(38,0)"\n        }\n        operator: GREATER_THAN\n        parameters: { value: { type: NUMBER, value: "10" } }\n        failThreshold: { type: COUNT, value: 0 }\n        excludeNulls: true\n      }\n      evaluationSchedule: {\n        timezone: "America/Los_Angeles"\n        cron: "0 */8 * * *"\n      }\n      evaluationParameters: { sourceType: ALL_ROWS_QUERY }\n      mode: ACTIVE\n    }\n  ) {\n    urn\n  }\n}\n')),(0,n.yg)("p",null,"You can use same endpoint with assertion urn input to update an existing Column Assertion and corresponding Monitor."),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-graphql"},'mutation upsertDatasetFieldAssertionMonitor {\n  upsertDatasetFieldAssertionMonitor(\n    assertionUrn: "<urn of assertion created in earlier query>"\n    input: {\n      entityUrn: "<urn of entity being monitored>"\n      type: FIELD_VALUES\n      fieldValuesAssertion: {\n        field: {\n          path: "<name of the column to be monitored>"\n          type: "NUMBER"\n          nativeType: "NUMBER(38,0)"\n        }\n        operator: GREATER_THAN_OR_EQUAL_TO\n        parameters: { value: { type: NUMBER, value: "10" } }\n        failThreshold: { type: COUNT, value: 0 }\n        excludeNulls: true\n      }\n      evaluationSchedule: {\n        timezone: "America/Los_Angeles"\n        cron: "0 */8 * * *"\n      }\n      evaluationParameters: { sourceType: ALL_ROWS_QUERY }\n      mode: ACTIVE\n    }\n  ) {\n    urn\n  }\n}\n')),(0,n.yg)("p",null,"You can delete assertions along with their monitors using GraphQL mutations: ",(0,n.yg)("inlineCode",{parentName:"p"},"deleteAssertion")," and ",(0,n.yg)("inlineCode",{parentName:"p"},"deleteMonitor"),"."),(0,n.yg)("h3",{id:"tips"},"Tips"),(0,n.yg)("admonition",{type:"info"},(0,n.yg)("p",{parentName:"admonition"},(0,n.yg)("strong",{parentName:"p"},"Authorization")),(0,n.yg)("p",{parentName:"admonition"},"Remember to always provide a DataHub Personal Access Token when calling the GraphQL API. To do so, just add the 'Authorization' header as follows:"),(0,n.yg)("pre",{parentName:"admonition"},(0,n.yg)("code",{parentName:"pre"},"Authorization: Bearer <personal-access-token>\n")),(0,n.yg)("p",{parentName:"admonition"},(0,n.yg)("strong",{parentName:"p"},"Exploring GraphQL API")),(0,n.yg)("p",{parentName:"admonition"},"Also, remember that you can play with an interactive version of the DataHub Cloud GraphQL API at ",(0,n.yg)("inlineCode",{parentName:"p"},"https://your-account-id.acryl.io/api/graphiql"))))}d.isMDXComponent=!0}}]);