"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[6652],{909:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>d,contentTitle:()=>u,default:()=>h,frontMatter:()=>p,metadata:()=>g,toc:()=>m});a(96540);var n=a(15680),s=a(53720),i=a(5400);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})),e}function l(e,t){if(null==e)return{};var a,n,s=function(e,t){if(null==e)return{};var a,n,s={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}const p={sidebar_position:4,title:"Azure AD",slug:"/generated/ingestion/sources/azure-ad",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/generated/ingestion/sources/azure-ad.md"},u="Azure AD",g={unversionedId:"docs/generated/ingestion/sources/azure-ad",id:"docs/generated/ingestion/sources/azure-ad",title:"Azure AD",description:"Extracting DataHub Users",source:"@site/genDocs/docs/generated/ingestion/sources/azure-ad.md",sourceDirName:"docs/generated/ingestion/sources",slug:"/generated/ingestion/sources/azure-ad",permalink:"/docs/generated/ingestion/sources/azure-ad",draft:!1,editUrl:"https://github.com/datahub-project/datahub/blob/master/docs/generated/ingestion/sources/azure-ad.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,title:"Azure AD",slug:"/generated/ingestion/sources/azure-ad",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/generated/ingestion/sources/azure-ad.md"},sidebar:"overviewSidebar",previous:{title:"Athena",permalink:"/docs/generated/ingestion/sources/athena"},next:{title:"Azure Data Factory",permalink:"/docs/generated/ingestion/sources/azure-data-factory"}},d={},m=[{value:"Extracting DataHub Users",id:"extracting-datahub-users",level:3},{value:"Usernames",id:"usernames",level:4},{value:"Responses",id:"responses",level:4},{value:"Extracting DataHub Groups",id:"extracting-datahub-groups",level:3},{value:"Group Names",id:"group-names",level:4},{value:"Responses",id:"responses-1",level:4},{value:"Extracting Group Membership",id:"extracting-group-membership",level:3},{value:"Important Capabilities",id:"important-capabilities",level:3},{value:"Extracting DataHub Users",id:"extracting-datahub-users-1",level:3},{value:"Usernames",id:"usernames-1",level:4},{value:"Responses",id:"responses-2",level:4},{value:"Extracting DataHub Groups",id:"extracting-datahub-groups-1",level:3},{value:"Group Names",id:"group-names-1",level:4},{value:"Responses",id:"responses-3",level:4},{value:"Extracting Group Membership",id:"extracting-group-membership-1",level:3},{value:"Prerequisite",id:"prerequisite",level:3},{value:"CLI based Ingestion",id:"cli-based-ingestion",level:3},{value:"Starter Recipe",id:"starter-recipe",level:3},{value:"Config Details",id:"config-details",level:3},{value:"Code Coordinates",id:"code-coordinates",level:3}],c={toc:m},y="wrapper";function h(e){var{components:t}=e,a=l(e,["components"]);return(0,n.yg)(y,o(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){r(e,t,a[t])}))}return e}({},c,a),{components:t,mdxType:"MDXLayout"}),(0,n.yg)("h1",{id:"azure-ad"},"Azure AD"),(0,n.yg)("h3",{id:"extracting-datahub-users"},"Extracting DataHub Users"),(0,n.yg)("h4",{id:"usernames"},"Usernames"),(0,n.yg)("p",null,'Usernames serve as unique identifiers for users on DataHub. This connector extracts usernames using the\n"userPrincipalName" field of an ',(0,n.yg)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/graph/api/user-list?view=graph-rest-1.0&tabs=http#response-1"},"Azure AD User Response"),",\nwhich is the unique identifier for your Azure AD users."),(0,n.yg)("p",null,"If this is not how you wish to map to DataHub usernames, you can provide a custom mapping using the configurations options detailed below. Namely, ",(0,n.yg)("inlineCode",{parentName:"p"},"azure_ad_response_to_username_attr"),"\nand ",(0,n.yg)("inlineCode",{parentName:"p"},"azure_ad_response_to_username_regex"),"."),(0,n.yg)("h4",{id:"responses"},"Responses"),(0,n.yg)("p",null,"This connector also extracts basic user response information from Azure. The following fields of the Azure User Response are extracted\nand mapped to the DataHub ",(0,n.yg)("inlineCode",{parentName:"p"},"CorpUserInfo")," aspect:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"display name"),(0,n.yg)("li",{parentName:"ul"},"first name"),(0,n.yg)("li",{parentName:"ul"},"last name"),(0,n.yg)("li",{parentName:"ul"},"email"),(0,n.yg)("li",{parentName:"ul"},"title"),(0,n.yg)("li",{parentName:"ul"},"country")),(0,n.yg)("h3",{id:"extracting-datahub-groups"},"Extracting DataHub Groups"),(0,n.yg)("h4",{id:"group-names"},"Group Names"),(0,n.yg)("p",null,'Group names serve as unique identifiers for groups on DataHub. This connector extracts group names using the "name" attribute of an Azure Group Response.\nBy default, a URL-encoded version of the full group name is used as the unique identifier (CorpGroupKey) and the raw "name" attribute is mapped\nas the display name that will appear in DataHub\'s UI.'),(0,n.yg)("p",null,"If this is not how you wish to map to DataHub group names, you can provide a custom mapping using the configurations options detailed below. Namely, ",(0,n.yg)("inlineCode",{parentName:"p"},"azure_ad_response_to_groupname_attr"),"\nand ",(0,n.yg)("inlineCode",{parentName:"p"},"azure_ad_response_to_groupname_regex"),"."),(0,n.yg)("h4",{id:"responses-1"},"Responses"),(0,n.yg)("p",null,"This connector also extracts basic group information from Azure. The following fields of the ",(0,n.yg)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/graph/api/group-list?view=graph-rest-1.0&tabs=http#response-1"},"Azure AD Group Response")," are extracted and mapped to the\nDataHub ",(0,n.yg)("inlineCode",{parentName:"p"},"CorpGroupInfo")," aspect:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"name"),(0,n.yg)("li",{parentName:"ul"},"description")),(0,n.yg)("h3",{id:"extracting-group-membership"},"Extracting Group Membership"),(0,n.yg)("p",null,"This connector additional extracts the edges between Users and Groups that are stored in ",(0,n.yg)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/graph/api/group-list-members?view=graph-rest-1.0&tabs=http#response-1"},"Azure AD"),". It maps them to the ",(0,n.yg)("inlineCode",{parentName:"p"},"GroupMembership")," aspect\nassociated with DataHub users (CorpUsers).\n",(0,n.yg)("img",{parentName:"p",src:"https://img.shields.io/badge/support%20status-certified-brightgreen",alt:"Certified"})),(0,n.yg)("h3",{id:"important-capabilities"},"Important Capabilities"),(0,n.yg)("table",null,(0,n.yg)("thead",{parentName:"table"},(0,n.yg)("tr",{parentName:"thead"},(0,n.yg)("th",{parentName:"tr",align:null},"Capability"),(0,n.yg)("th",{parentName:"tr",align:null},"Status"),(0,n.yg)("th",{parentName:"tr",align:null},"Notes"))),(0,n.yg)("tbody",{parentName:"table"},(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("a",{parentName:"td",href:"/docs/metadata-ingestion/docs/dev_guides/stateful#stale-entity-removal"},"Detect Deleted Entities")),(0,n.yg)("td",{parentName:"tr",align:null},"\u2705"),(0,n.yg)("td",{parentName:"tr",align:null},"Enabled by default via stateful ingestion.")))),(0,n.yg)("p",null,"This plugin extracts the following:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Users"),(0,n.yg)("li",{parentName:"ul"},"Groups"),(0,n.yg)("li",{parentName:"ul"},"Group Membership")),(0,n.yg)("p",null,"from your Azure AD instance."),(0,n.yg)("p",null,"Note that any users ingested from this connector will not be able to log into DataHub unless you have Azure AD OIDC\nSSO enabled. You can, however, have these users ingested into DataHub before they log in for the first time if you\nwould like to take actions like adding them to a group or assigning them a role."),(0,n.yg)("p",null,"For instructions on how to do configure Azure AD OIDC SSO, please read the documentation\n",(0,n.yg)("a",{parentName:"p",href:"/docs/authentication/guides/sso/configure-oidc-react#create-an-application-registration-in-microsoft-azure-portal"},"here"),"."),(0,n.yg)("h3",{id:"extracting-datahub-users-1"},"Extracting DataHub Users"),(0,n.yg)("h4",{id:"usernames-1"},"Usernames"),(0,n.yg)("p",null,'Usernames serve as unique identifiers for users on DataHub. This connector extracts usernames using the\n"userPrincipalName" field of an ',(0,n.yg)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/graph/api/user-list?view=graph-rest-1.0&tabs=http#response-1"},"Azure AD User Response"),",\nwhich is the unique identifier for your Azure AD users."),(0,n.yg)("p",null,"If this is not how you wish to map to DataHub usernames, you can provide a custom mapping using the configurations options detailed below. Namely, ",(0,n.yg)("inlineCode",{parentName:"p"},"azure_ad_response_to_username_attr"),"\nand ",(0,n.yg)("inlineCode",{parentName:"p"},"azure_ad_response_to_username_regex"),"."),(0,n.yg)("h4",{id:"responses-2"},"Responses"),(0,n.yg)("p",null,"This connector also extracts basic user response information from Azure. The following fields of the Azure User Response are extracted\nand mapped to the DataHub ",(0,n.yg)("inlineCode",{parentName:"p"},"CorpUserInfo")," aspect:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"display name"),(0,n.yg)("li",{parentName:"ul"},"first name"),(0,n.yg)("li",{parentName:"ul"},"last name"),(0,n.yg)("li",{parentName:"ul"},"email"),(0,n.yg)("li",{parentName:"ul"},"title"),(0,n.yg)("li",{parentName:"ul"},"country")),(0,n.yg)("h3",{id:"extracting-datahub-groups-1"},"Extracting DataHub Groups"),(0,n.yg)("h4",{id:"group-names-1"},"Group Names"),(0,n.yg)("p",null,'Group names serve as unique identifiers for groups on DataHub. This connector extracts group names using the "name" attribute of an Azure Group Response.\nBy default, a URL-encoded version of the full group name is used as the unique identifier (CorpGroupKey) and the raw "name" attribute is mapped\nas the display name that will appear in DataHub\'s UI.'),(0,n.yg)("p",null,"If this is not how you wish to map to DataHub group names, you can provide a custom mapping using the configurations options detailed below. Namely, ",(0,n.yg)("inlineCode",{parentName:"p"},"azure_ad_response_to_groupname_attr"),"\nand ",(0,n.yg)("inlineCode",{parentName:"p"},"azure_ad_response_to_groupname_regex"),"."),(0,n.yg)("h4",{id:"responses-3"},"Responses"),(0,n.yg)("p",null,"This connector also extracts basic group information from Azure. The following fields of the ",(0,n.yg)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/graph/api/group-list?view=graph-rest-1.0&tabs=http#response-1"},"Azure AD Group Response")," are extracted and mapped to the\nDataHub ",(0,n.yg)("inlineCode",{parentName:"p"},"CorpGroupInfo")," aspect:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"name"),(0,n.yg)("li",{parentName:"ul"},"description")),(0,n.yg)("h3",{id:"extracting-group-membership-1"},"Extracting Group Membership"),(0,n.yg)("p",null,"This connector additional extracts the edges between Users and Groups that are stored in ",(0,n.yg)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/graph/api/group-list-members?view=graph-rest-1.0&tabs=http#response-1"},"Azure AD"),". It maps them to the ",(0,n.yg)("inlineCode",{parentName:"p"},"GroupMembership")," aspect\nassociated with DataHub users (CorpUsers)."),(0,n.yg)("h3",{id:"prerequisite"},"Prerequisite"),(0,n.yg)("p",null,(0,n.yg)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/graph/toolkit/get-started/add-aad-app-registration"},"Create a DataHub Application")," within the Azure AD Portal with the permissions\nto read your organization's Users and Groups. The following permissions are required, with the ",(0,n.yg)("inlineCode",{parentName:"p"},"Application")," permission type:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"Group.Read.All")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"GroupMember.Read.All")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"User.Read.All"))),(0,n.yg)("h3",{id:"cli-based-ingestion"},"CLI based Ingestion"),(0,n.yg)("h3",{id:"starter-recipe"},"Starter Recipe"),(0,n.yg)("p",null,"Check out the following recipe to get started with ingestion! See ",(0,n.yg)("a",{parentName:"p",href:"#config-details"},"below")," for full configuration options."),(0,n.yg)("p",null,"For general pointers on writing and running a recipe, see our ",(0,n.yg)("a",{parentName:"p",href:"/docs/metadata-ingestion#recipes"},"main recipe guide"),"."),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-yaml"},'source:\n  type: "azure-ad"\n  config:\n    client_id: "00000000-0000-0000-0000-000000000000"\n    tenant_id: "00000000-0000-0000-0000-000000000000"\n    client_secret: "xxxxx"\n    redirect: "https://login.microsoftonline.com/common/oauth2/nativeclient"\n    authority: "https://login.microsoftonline.com/00000000-0000-0000-0000-000000000000"\n    token_url: "https://login.microsoftonline.com/00000000-0000-0000-0000-000000000000/oauth2/token"\n    graph_url: "https://graph.microsoft.com/v1.0"\n    ingest_users: True\n    ingest_groups: True\n    groups_pattern:\n      allow:\n        - ".*"\n    users_pattern:\n      allow:\n        - ".*"\n\nsink:\n  # sink configs\n')),(0,n.yg)("h3",{id:"config-details"},"Config Details"),(0,n.yg)(s.A,{mdxType:"Tabs"},(0,n.yg)(i.A,{value:"options",label:"Options",default:!0,mdxType:"TabItem"},(0,n.yg)("p",null,"Note that a ",(0,n.yg)("inlineCode",{parentName:"p"},".")," is used to denote nested fields in the YAML recipe."),(0,n.yg)("div",{className:"config-table"},(0,n.yg)("table",null,(0,n.yg)("thead",{parentName:"table"},(0,n.yg)("tr",{parentName:"thead"},(0,n.yg)("th",{parentName:"tr",align:"left"},"Field"),(0,n.yg)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.yg)("tbody",{parentName:"table"},(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"authority"),"\xa0",(0,n.yg)("abbr",{title:"Required"},"\u2705"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"string"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"The authority (",(0,n.yg)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-client-application-configuration"},"https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-client-application-configuration"),") is a URL that indicates a directory that MSAL can request tokens from.")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"client_id"),"\xa0",(0,n.yg)("abbr",{title:"Required"},"\u2705"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"string"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"Application ID. Found in your app registration on Azure AD Portal")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"client_secret"),"\xa0",(0,n.yg)("abbr",{title:"Required"},"\u2705"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"string(password)"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"Client secret. Found in your app registration on Azure AD Portal")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"tenant_id"),"\xa0",(0,n.yg)("abbr",{title:"Required"},"\u2705"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"string"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"Directory ID. Found in your app registration on Azure AD Portal")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"token_url"),"\xa0",(0,n.yg)("abbr",{title:"Required"},"\u2705"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"string"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"The token URL that acquires a token from Azure AD for authorizing requests.  This source will only work with v1.0 endpoint.")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"azure_ad_response_to_groupname_attr"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"string"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"Which Azure AD Group Response attribute to use as input to DataHub group name mapping. ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"displayName")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"azure_ad_response_to_groupname_regex"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"string"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"A regex used to parse the DataHub group name from the attribute specified in ",(0,n.yg)("inlineCode",{parentName:"td"},"azure_ad_response_to_groupname_attr"),". ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"(.","*",")")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"azure_ad_response_to_username_attr"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"string"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"Which Azure AD User Response attribute to use as input to DataHub username mapping. ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"userPrincipalName")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"azure_ad_response_to_username_regex"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"string"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"A regex used to parse the DataHub username from the attribute specified in ",(0,n.yg)("inlineCode",{parentName:"td"},"azure_ad_response_to_username_attr"),". ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"(.","*",")")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"graph_url"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"string"))),(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("a",{parentName:"td",href:"https://docs.microsoft.com/en-us/graph/use-the-api"},"Microsoft Graph API endpoint")," ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},(0,n.yg)("a",{parentName:"td",href:"https://graph.microsoft.com/v1.0"},"https://graph.microsoft.com/v1.0"))))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"ingest_group_membership"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"boolean"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"Whether group membership should be ingested into DataHub. ingest_groups must be True if this is True. ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"True")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"ingest_groups"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"boolean"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"Whether groups should be ingested into DataHub. ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"True")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"ingest_groups_users"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"boolean"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"This option is useful only when ",(0,n.yg)("inlineCode",{parentName:"td"},"ingest_users")," is set to False and ",(0,n.yg)("inlineCode",{parentName:"td"},"ingest_group_membership")," to True. As effect, only the users which belongs to the selected groups will be ingested. ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"True")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"ingest_users"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"boolean"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"Whether users should be ingested into DataHub. ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"True")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"mask_group_id"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"boolean"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"Whether workunit ID's for groups should be masked to avoid leaking sensitive information. ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"True")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"mask_user_id"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"boolean"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"Whether workunit ID's for users should be masked to avoid leaking sensitive information. ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"True")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"platform_instance"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"One of string, null"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"The instance of the platform that all assets produced by this recipe belong to. This should be unique within the platform. See ",(0,n.yg)("a",{parentName:"td",href:"https://docs.datahub.com/docs/platform-instances/"},"https://docs.datahub.com/docs/platform-instances/")," for more details. ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"None")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"redirect"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"string"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"Redirect URI.  Found in your app registration on Azure AD Portal. ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},(0,n.yg)("a",{parentName:"td",href:"https://login.microsoftonline.com/common/oauth2/na"},"https://login.microsoftonline.com/common/oauth2/na"),"...")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"env"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"string"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"The environment that all assets produced by this connector belong to ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"PROD")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"groups_pattern"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"AllowDenyPattern"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"A class to store allow deny regexes")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-prefix"},"groups_pattern."),(0,n.yg)("span",{className:"path-main"},"ignoreCase"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"One of boolean, null"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"Whether to ignore case sensitivity during pattern matching. ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"True")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"users_pattern"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"AllowDenyPattern"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"A class to store allow deny regexes")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-prefix"},"users_pattern."),(0,n.yg)("span",{className:"path-main"},"ignoreCase"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"One of boolean, null"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"Whether to ignore case sensitivity during pattern matching. ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"True")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-main"},"stateful_ingestion"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"One of StatefulStaleMetadataRemovalConfig, null"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"Azure AD Stateful Ingestion Config. ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"None")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-prefix"},"stateful_ingestion."),(0,n.yg)("span",{className:"path-main"},"enabled"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"boolean"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"Whether or not to enable stateful ingest. Default: True if a pipeline_name is set and either a datahub-rest sink or ",(0,n.yg)("inlineCode",{parentName:"td"},"datahub_api")," is specified, otherwise False ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"False")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-prefix"},"stateful_ingestion."),(0,n.yg)("span",{className:"path-main"},"fail_safe_threshold"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"number"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"Prevents large amount of soft deletes & the state from committing from accidental changes to the source configuration if the relative change percent in entities compared to the previous state is above the 'fail_safe_threshold'. ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"75.0")))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"left"},(0,n.yg)("div",{className:"path-line"},(0,n.yg)("span",{className:"path-prefix"},"stateful_ingestion."),(0,n.yg)("span",{className:"path-main"},"remove_stale_metadata"))," ",(0,n.yg)("div",{className:"type-name-line"},(0,n.yg)("span",{className:"type-name"},"boolean"))),(0,n.yg)("td",{parentName:"tr",align:"left"},"Soft-deletes the entities present in the last successful run but missing in the current run with stateful_ingestion enabled. ",(0,n.yg)("div",{className:"default-line default-line-with-docs"},"Default: ",(0,n.yg)("span",{className:"default-value"},"True")))))))),(0,n.yg)(i.A,{value:"schema",label:"Schema",mdxType:"TabItem"},(0,n.yg)("p",null,"The ",(0,n.yg)("a",{parentName:"p",href:"https://json-schema.org/"},"JSONSchema")," for this configuration is inlined below."),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-javascript"},'{\n  "$defs": {\n    "AllowDenyPattern": {\n      "additionalProperties": false,\n      "description": "A class to store allow deny regexes",\n      "properties": {\n        "allow": {\n          "default": [\n            ".*"\n          ],\n          "description": "List of regex patterns to include in ingestion",\n          "items": {\n            "type": "string"\n          },\n          "title": "Allow",\n          "type": "array"\n        },\n        "deny": {\n          "default": [],\n          "description": "List of regex patterns to exclude from ingestion.",\n          "items": {\n            "type": "string"\n          },\n          "title": "Deny",\n          "type": "array"\n        },\n        "ignoreCase": {\n          "anyOf": [\n            {\n              "type": "boolean"\n            },\n            {\n              "type": "null"\n            }\n          ],\n          "default": true,\n          "description": "Whether to ignore case sensitivity during pattern matching.",\n          "title": "Ignorecase"\n        }\n      },\n      "title": "AllowDenyPattern",\n      "type": "object"\n    },\n    "StatefulStaleMetadataRemovalConfig": {\n      "additionalProperties": false,\n      "description": "Base specialized config for Stateful Ingestion with stale metadata removal capability.",\n      "properties": {\n        "enabled": {\n          "default": false,\n          "description": "Whether or not to enable stateful ingest. Default: True if a pipeline_name is set and either a datahub-rest sink or `datahub_api` is specified, otherwise False",\n          "title": "Enabled",\n          "type": "boolean"\n        },\n        "remove_stale_metadata": {\n          "default": true,\n          "description": "Soft-deletes the entities present in the last successful run but missing in the current run with stateful_ingestion enabled.",\n          "title": "Remove Stale Metadata",\n          "type": "boolean"\n        },\n        "fail_safe_threshold": {\n          "default": 75.0,\n          "description": "Prevents large amount of soft deletes & the state from committing from accidental changes to the source configuration if the relative change percent in entities compared to the previous state is above the \'fail_safe_threshold\'.",\n          "maximum": 100.0,\n          "minimum": 0.0,\n          "title": "Fail Safe Threshold",\n          "type": "number"\n        }\n      },\n      "title": "StatefulStaleMetadataRemovalConfig",\n      "type": "object"\n    }\n  },\n  "additionalProperties": false,\n  "description": "Config to create a token and connect to Azure AD instance",\n  "properties": {\n    "env": {\n      "default": "PROD",\n      "description": "The environment that all assets produced by this connector belong to",\n      "title": "Env",\n      "type": "string"\n    },\n    "platform_instance": {\n      "anyOf": [\n        {\n          "type": "string"\n        },\n        {\n          "type": "null"\n        }\n      ],\n      "default": null,\n      "description": "The instance of the platform that all assets produced by this recipe belong to. This should be unique within the platform. See https://docs.datahub.com/docs/platform-instances/ for more details.",\n      "title": "Platform Instance"\n    },\n    "stateful_ingestion": {\n      "anyOf": [\n        {\n          "$ref": "#/$defs/StatefulStaleMetadataRemovalConfig"\n        },\n        {\n          "type": "null"\n        }\n      ],\n      "default": null,\n      "description": "Azure AD Stateful Ingestion Config."\n    },\n    "client_id": {\n      "description": "Application ID. Found in your app registration on Azure AD Portal",\n      "title": "Client Id",\n      "type": "string"\n    },\n    "tenant_id": {\n      "description": "Directory ID. Found in your app registration on Azure AD Portal",\n      "title": "Tenant Id",\n      "type": "string"\n    },\n    "client_secret": {\n      "description": "Client secret. Found in your app registration on Azure AD Portal",\n      "format": "password",\n      "title": "Client Secret",\n      "type": "string",\n      "writeOnly": true\n    },\n    "authority": {\n      "description": "The authority (https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-client-application-configuration) is a URL that indicates a directory that MSAL can request tokens from.",\n      "title": "Authority",\n      "type": "string"\n    },\n    "token_url": {\n      "description": "The token URL that acquires a token from Azure AD for authorizing requests.  This source will only work with v1.0 endpoint.",\n      "title": "Token Url",\n      "type": "string"\n    },\n    "redirect": {\n      "default": "https://login.microsoftonline.com/common/oauth2/nativeclient",\n      "description": "Redirect URI.  Found in your app registration on Azure AD Portal.",\n      "title": "Redirect",\n      "type": "string"\n    },\n    "graph_url": {\n      "default": "https://graph.microsoft.com/v1.0",\n      "description": "[Microsoft Graph API endpoint](https://docs.microsoft.com/en-us/graph/use-the-api)",\n      "title": "Graph Url",\n      "type": "string"\n    },\n    "azure_ad_response_to_username_attr": {\n      "default": "userPrincipalName",\n      "description": "Which Azure AD User Response attribute to use as input to DataHub username mapping.",\n      "title": "Azure Ad Response To Username Attr",\n      "type": "string"\n    },\n    "azure_ad_response_to_username_regex": {\n      "default": "(.*)",\n      "description": "A regex used to parse the DataHub username from the attribute specified in `azure_ad_response_to_username_attr`.",\n      "title": "Azure Ad Response To Username Regex",\n      "type": "string"\n    },\n    "azure_ad_response_to_groupname_attr": {\n      "default": "displayName",\n      "description": "Which Azure AD Group Response attribute to use as input to DataHub group name mapping.",\n      "title": "Azure Ad Response To Groupname Attr",\n      "type": "string"\n    },\n    "azure_ad_response_to_groupname_regex": {\n      "default": "(.*)",\n      "description": "A regex used to parse the DataHub group name from the attribute specified in `azure_ad_response_to_groupname_attr`.",\n      "title": "Azure Ad Response To Groupname Regex",\n      "type": "string"\n    },\n    "ingest_users": {\n      "default": true,\n      "description": "Whether users should be ingested into DataHub.",\n      "title": "Ingest Users",\n      "type": "boolean"\n    },\n    "ingest_groups": {\n      "default": true,\n      "description": "Whether groups should be ingested into DataHub.",\n      "title": "Ingest Groups",\n      "type": "boolean"\n    },\n    "ingest_group_membership": {\n      "default": true,\n      "description": "Whether group membership should be ingested into DataHub. ingest_groups must be True if this is True.",\n      "title": "Ingest Group Membership",\n      "type": "boolean"\n    },\n    "ingest_groups_users": {\n      "default": true,\n      "description": "This option is useful only when `ingest_users` is set to False and `ingest_group_membership` to True. As effect, only the users which belongs to the selected groups will be ingested.",\n      "title": "Ingest Groups Users",\n      "type": "boolean"\n    },\n    "users_pattern": {\n      "$ref": "#/$defs/AllowDenyPattern",\n      "default": {\n        "allow": [\n          ".*"\n        ],\n        "deny": [],\n        "ignoreCase": true\n      },\n      "description": "regex patterns for users to filter in ingestion."\n    },\n    "groups_pattern": {\n      "$ref": "#/$defs/AllowDenyPattern",\n      "default": {\n        "allow": [\n          ".*"\n        ],\n        "deny": [],\n        "ignoreCase": true\n      },\n      "description": "regex patterns for groups to include in ingestion."\n    },\n    "mask_group_id": {\n      "default": true,\n      "description": "Whether workunit ID\'s for groups should be masked to avoid leaking sensitive information.",\n      "title": "Mask Group Id",\n      "type": "boolean"\n    },\n    "mask_user_id": {\n      "default": true,\n      "description": "Whether workunit ID\'s for users should be masked to avoid leaking sensitive information.",\n      "title": "Mask User Id",\n      "type": "boolean"\n    }\n  },\n  "required": [\n    "client_id",\n    "tenant_id",\n    "client_secret",\n    "authority",\n    "token_url"\n  ],\n  "title": "AzureADConfig",\n  "type": "object"\n}\n')))),(0,n.yg)("p",null,"As a prerequisite, you should ",(0,n.yg)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/graph/toolkit/get-started/add-aad-app-registration"},"create a DataHub Application")," within the Azure AD Portal with the permissions\nto read your organization's Users and Groups. The following permissions are required, with the ",(0,n.yg)("inlineCode",{parentName:"p"},"Application")," permission type:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"Group.Read.All")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"GroupMember.Read.All")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"User.Read.All"))),(0,n.yg)("p",null,"You can add a permission by navigating to the permissions tab in your DataHub application on the Azure AD portal."),(0,n.yg)("p",{align:"center"},(0,n.yg)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/azure-ad/azure_ad_api_permissions.png"})),(0,n.yg)("p",null,"You can view the necessary endpoints to configure by clicking on the Endpoints button in the Overview tab."),(0,n.yg)("p",{align:"center"},(0,n.yg)("img",{width:"70%",src:"https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/azure-ad/azure_ad_endpoints.png"})),(0,n.yg)("h3",{id:"code-coordinates"},"Code Coordinates"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Class Name: ",(0,n.yg)("inlineCode",{parentName:"li"},"datahub.ingestion.source.identity.azure_ad.AzureADSource")),(0,n.yg)("li",{parentName:"ul"},"Browse on ",(0,n.yg)("a",{parentName:"li",href:"https://github.com/datahub-project/datahub/blob/master/metadata-ingestion/src/datahub/ingestion/source/identity/azure_ad.py"},"GitHub"))),(0,n.yg)("h2",null,"Questions"),(0,n.yg)("p",null,"If you've got any questions on configuring ingestion for Azure AD, feel free to ping us on ",(0,n.yg)("a",{parentName:"p",href:"https://datahub.com/slack"},"our Slack"),"."))}h.isMDXComponent=!0}}]);