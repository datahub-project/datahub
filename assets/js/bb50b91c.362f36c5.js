"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[56351],{15680:(e,t,n)=>{n.d(t,{xA:()=>u,yg:()=>y});var r=n(96540);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},g=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,l=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),p=c(n),g=a,y=p["".concat(l,".").concat(g)]||p[g]||m[g]||s;return n?r.createElement(y,i(i({ref:t},u),{},{components:n})):r.createElement(y,i({ref:t},u))}));function y(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,i=new Array(s);i[0]=g;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[p]="string"==typeof e?e:a,i[1]=o;for(var c=2;c<s;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}g.displayName="MDXCreateElement"},98280:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>l,default:()=>y,frontMatter:()=>o,metadata:()=>c,toc:()=>p});n(96540);var r=n(15680);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const o={title:"Semantic Search Smoke Tests",slug:"/smoke-test/tests/semantic",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/smoke-test/tests/semantic/README.md"},l="Semantic Search Smoke Tests",c={unversionedId:"smoke-test/tests/semantic/README",id:"smoke-test/tests/semantic/README",title:"Semantic Search Smoke Tests",description:"This directory contains smoke tests for DataHub's semantic search functionality.",source:"@site/genDocs/smoke-test/tests/semantic/README.md",sourceDirName:"smoke-test/tests/semantic",slug:"/smoke-test/tests/semantic",permalink:"/docs/smoke-test/tests/semantic",draft:!1,editUrl:"https://github.com/datahub-project/datahub/blob/master/smoke-test/tests/semantic/README.md",tags:[],version:"current",frontMatter:{title:"Semantic Search Smoke Tests",slug:"/smoke-test/tests/semantic",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/smoke-test/tests/semantic/README.md"}},u={},p=[{value:"Test Files",id:"test-files",level:2},{value:"Running Semantic Search Tests",id:"running-semantic-search-tests",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Environment Variables",id:"environment-variables",level:3},{value:"Running the Tests",id:"running-the-tests",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Test is skipped",id:"test-is-skipped",level:3},{value:"No semanticContent found",id:"no-semanticcontent-found",level:3},{value:"Semantic search returns no results",id:"semantic-search-returns-no-results",level:3},{value:"References",id:"references",level:2}],m={toc:p},g="wrapper";function y(e){var{components:t}=e,n=i(e,["components"]);return(0,r.yg)(g,s(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){a(e,t,n[t])}))}return e}({},m,n),{components:t,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"semantic-search-smoke-tests"},"Semantic Search Smoke Tests"),(0,r.yg)("p",null,"This directory contains smoke tests for DataHub's semantic search functionality."),(0,r.yg)("h2",{id:"test-files"},"Test Files"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},(0,r.yg)("inlineCode",{parentName:"strong"},"test_semantic_search.py"))," - End-to-end semantic search test (provider-agnostic)"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},(0,r.yg)("inlineCode",{parentName:"strong"},"test_event_driven_docs.py"))," - Event-driven document ingestion tests"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},(0,r.yg)("inlineCode",{parentName:"strong"},"test_source_type_filtering.py"))," - Source type filtering tests"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},(0,r.yg)("inlineCode",{parentName:"strong"},"test_stateful_ingestion.py"))," - Stateful ingestion tests"),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},(0,r.yg)("inlineCode",{parentName:"strong"},"test_config_fingerprint.py"))," - Configuration fingerprinting tests")),(0,r.yg)("h2",{id:"running-semantic-search-tests"},"Running Semantic Search Tests"),(0,r.yg)("h3",{id:"prerequisites"},"Prerequisites"),(0,r.yg)("p",null,"DataHub must be running with semantic search enabled and an embedding provider configured.\nSee ",(0,r.yg)("a",{parentName:"p",href:"/docs/dev-guides/semantic-search/configuration"},"Semantic Search Configuration")," for GMS setup."),(0,r.yg)("h3",{id:"environment-variables"},"Environment Variables"),(0,r.yg)("p",null,"The test uses ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/BerriAI/litellm"},"LiteLLM")," which reads API keys from environment variables:"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Provider"),(0,r.yg)("th",{parentName:"tr",align:null},"Environment Variable"),(0,r.yg)("th",{parentName:"tr",align:null},"Required"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"OpenAI"),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"OPENAI_API_KEY")),(0,r.yg)("td",{parentName:"tr",align:null},"Yes")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"Cohere"),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"COHERE_API_KEY")),(0,r.yg)("td",{parentName:"tr",align:null},"Yes")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"AWS Bedrock"),(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("inlineCode",{parentName:"td"},"AWS_PROFILE")," or ",(0,r.yg)("inlineCode",{parentName:"td"},"AWS_ACCESS_KEY_ID"),"/",(0,r.yg)("inlineCode",{parentName:"td"},"AWS_SECRET_ACCESS_KEY")),(0,r.yg)("td",{parentName:"tr",align:null},"Yes")))),(0,r.yg)("h3",{id:"running-the-tests"},"Running the Tests"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-bash"},'# Activate your virtual environment\nsource venv/bin/activate\n\n# Run with OpenAI\nENABLE_SEMANTIC_SEARCH_TESTS=true \\\nOPENAI_API_KEY="sk-your-key" \\\npytest tests/semantic/test_semantic_search.py -v\n\n# Run with Cohere\nENABLE_SEMANTIC_SEARCH_TESTS=true \\\nCOHERE_API_KEY="your-cohere-key" \\\npytest tests/semantic/test_semantic_search.py -v\n\n# Run with AWS Bedrock\nENABLE_SEMANTIC_SEARCH_TESTS=true \\\nAWS_PROFILE=your-profile \\\npytest tests/semantic/test_semantic_search.py -v\n')),(0,r.yg)("p",null,"The test is ",(0,r.yg)("strong",{parentName:"p"},"provider-agnostic")," - it fetches embedding configuration from the GMS server via the AppConfig API and works with any configured provider."),(0,r.yg)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,r.yg)("h3",{id:"test-is-skipped"},"Test is skipped"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"SKIPPED [1] semantic search tests disabled\n")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Solution:")," Set ",(0,r.yg)("inlineCode",{parentName:"p"},"ENABLE_SEMANTIC_SEARCH_TESTS=true")),(0,r.yg)("h3",{id:"no-semanticcontent-found"},"No semanticContent found"),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Possible causes:")),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},"Embedding provider credentials not set (check env vars above)"),(0,r.yg)("li",{parentName:"ol"},"Semantic search not enabled on the server"),(0,r.yg)("li",{parentName:"ol"},"Provider mismatch between GMS config and test environment")),(0,r.yg)("h3",{id:"semantic-search-returns-no-results"},"Semantic search returns no results"),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Possible causes:")),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},"Semantic indices not created/populated"),(0,r.yg)("li",{parentName:"ol"},"Indexing hasn't completed - increase ",(0,r.yg)("inlineCode",{parentName:"li"},"INDEXING_WAIT_SECONDS")," in the test")),(0,r.yg)("h2",{id:"references"},"References"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"/docs/dev-guides/semantic-search/configuration"},"Semantic Search Configuration")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"/docs/dev-guides/semantic-search/switching_providers"},"Switching Embedding Providers"))))}y.isMDXComponent=!0}}]);