"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[89787],{15680:(e,t,a)=>{a.d(t,{xA:()=>y,yg:()=>m});var n=a(96540);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var o=n.createContext({}),u=function(e){var t=n.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},y=function(e){var t=u(e.components);return n.createElement(o.Provider,{value:t},e.children)},p="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var a=e.components,l=e.mdxType,s=e.originalType,o=e.parentName,y=i(e,["components","mdxType","originalType","parentName"]),p=u(a),g=l,m=p["".concat(o,".").concat(g)]||p[g]||c[g]||s;return a?n.createElement(m,r(r({ref:t},y),{},{components:a})):n.createElement(m,r({ref:t},y))}));function m(e,t){var a=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var s=a.length,r=new Array(s);r[0]=g;var i={};for(var o in t)hasOwnProperty.call(t,o)&&(i[o]=t[o]);i.originalType=e,i[p]="string"==typeof e?e:l,r[1]=i;for(var u=2;u<s;u++)r[u]=a[u];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}g.displayName="MDXCreateElement"},50046:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>y,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>u,toc:()=>p});a(96540);var n=a(15680);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})),e}function r(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}const i={title:"DataHub Analytics Backfill Tools",sidebar_label:"Analytics Backfill Tools",slug:"/smoke-test/test_resources/analytics_backfill",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/smoke-test/test_resources/analytics_backfill/README.md"},o="DataHub Analytics Backfill Tools",u={unversionedId:"smoke-test/test_resources/analytics_backfill/README",id:"smoke-test/test_resources/analytics_backfill/README",title:"DataHub Analytics Backfill Tools",description:"Populate DataHub analytics dashboards with synthetic user activity data for testing and demonstration purposes.",source:"@site/genDocs/smoke-test/test_resources/analytics_backfill/README.md",sourceDirName:"smoke-test/test_resources/analytics_backfill",slug:"/smoke-test/test_resources/analytics_backfill",permalink:"/docs/smoke-test/test_resources/analytics_backfill",draft:!1,editUrl:"https://github.com/datahub-project/datahub/blob/master/smoke-test/test_resources/analytics_backfill/README.md",tags:[],version:"current",frontMatter:{title:"DataHub Analytics Backfill Tools",sidebar_label:"Analytics Backfill Tools",slug:"/smoke-test/test_resources/analytics_backfill",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/smoke-test/test_resources/analytics_backfill/README.md"}},y={},p=[{value:"Overview",id:"overview",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"One-Command Population",id:"one-command-population",level:3},{value:"Scripts",id:"scripts",level:2},{value:"1. <code>populate_analytics.sh</code> (Master Script)",id:"1-populate_analyticssh-master-script",level:3},{value:"2. <code>generate_users.py</code>",id:"2-generate_userspy",level:3},{value:"3. <code>generate_glossary_terms.py</code>",id:"3-generate_glossary_termspy",level:3},{value:"4. <code>backfill_activity_events.py</code>",id:"4-backfill_activity_eventspy",level:3},{value:"5. <code>load_events_to_elasticsearch.sh</code>",id:"5-load_events_to_elasticsearchsh",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Environment Variables",id:"environment-variables",level:3},{value:"Customization",id:"customization",level:3},{value:"Custom Entity URNs",id:"custom-entity-urns",level:4},{value:"Temporal Patterns",id:"temporal-patterns",level:4},{value:"Generated Data Structure",id:"generated-data-structure",level:2},{value:"Users",id:"users",level:3},{value:"Activity Events",id:"activity-events",level:3},{value:"Analytics Charts Populated",id:"analytics-charts-populated",level:2},{value:"User Analytics",id:"user-analytics",level:3},{value:"Search Analytics",id:"search-analytics",level:3},{value:"Entity Analytics",id:"entity-analytics",level:3},{value:"Metadata Analytics",id:"metadata-analytics",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"&quot;Cannot connect to DataHub GMS&quot;",id:"cannot-connect-to-datahub-gms",level:3},{value:"&quot;Cannot connect to Elasticsearch&quot;",id:"cannot-connect-to-elasticsearch",level:3},{value:"&quot;datahub Python package not found&quot;",id:"datahub-python-package-not-found",level:3},{value:"&quot;jq command not found&quot;",id:"jq-command-not-found",level:3},{value:"Analytics charts not showing data",id:"analytics-charts-not-showing-data",level:3},{value:"Events loaded but charts still empty",id:"events-loaded-but-charts-still-empty",level:3},{value:"Advanced Usage",id:"advanced-usage",level:2},{value:"Integration with Smoke Tests",id:"integration-with-smoke-tests",level:3},{value:"Continuous Data Generation",id:"continuous-data-generation",level:3},{value:"Custom Activity Patterns",id:"custom-activity-patterns",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Cleanup",id:"cleanup",level:2},{value:"Support",id:"support",level:2},{value:"License",id:"license",level:2}],c={toc:p},g="wrapper";function m(e){var{components:t}=e,a=r(e,["components"]);return(0,n.yg)(g,s(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){l(e,t,a[t])}))}return e}({},c,a),{components:t,mdxType:"MDXLayout"}),(0,n.yg)("h1",{id:"datahub-analytics-backfill-tools"},"DataHub Analytics Backfill Tools"),(0,n.yg)("p",null,"Populate DataHub analytics dashboards with synthetic user activity data for testing and demonstration purposes."),(0,n.yg)("h2",{id:"overview"},"Overview"),(0,n.yg)("p",null,"These scripts generate realistic user profiles and activity events with historical timestamps to populate all DataHub analytics charts including:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Weekly Active Users (WAU)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Monthly Active Users (MAU)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"New Users (Last 30 Days)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Top Users (Last 30 Days)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Number of Searches")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Top Searches (Past Week)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Top Viewed Datasets (Past Week)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Top Viewed Dashboards (Past Week)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Tab Views By Entity Type (Past Week)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Actions By Entity Type (Past Week)")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Data Assets by Term"))),(0,n.yg)("h2",{id:"quick-start"},"Quick Start"),(0,n.yg)("h3",{id:"prerequisites"},"Prerequisites"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"DataHub instance running (quickstart or production)"),(0,n.yg)("li",{parentName:"ul"},"Python 3.7+ with ",(0,n.yg)("inlineCode",{parentName:"li"},"acryl-datahub")," package installed"),(0,n.yg)("li",{parentName:"ul"},"Access to DataHub GMS and Elasticsearch"),(0,n.yg)("li",{parentName:"ul"},"DataHub access token (generate from Settings \u2192 Access Tokens)"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"jq")," and ",(0,n.yg)("inlineCode",{parentName:"li"},"curl")," installed")),(0,n.yg)("h3",{id:"one-command-population"},"One-Command Population"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},'# Set your DataHub token\nexport DATAHUB_TOKEN="your-token-here"\n\n# Run the master script with defaults (20 users, 30 days of activity)\n./populate_analytics.sh --token $DATAHUB_TOKEN\n')),(0,n.yg)("p",null,"This will:"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},"Generate 20 synthetic users"),(0,n.yg)("li",{parentName:"ol"},"Extract existing entity URNs from DataHub"),(0,n.yg)("li",{parentName:"ol"},"Create business glossary terms and attach them to datasets"),(0,n.yg)("li",{parentName:"ol"},"Create ~6,000 activity events over 30 days"),(0,n.yg)("li",{parentName:"ol"},"Load events into Elasticsearch"),(0,n.yg)("li",{parentName:"ol"},"Populate all analytics dashboards")),(0,n.yg)("p",null,"View results at ",(0,n.yg)("inlineCode",{parentName:"p"},"http://localhost:9002/analytics")),(0,n.yg)("h2",{id:"scripts"},"Scripts"),(0,n.yg)("h3",{id:"1-populate_analyticssh-master-script"},"1. ",(0,n.yg)("inlineCode",{parentName:"h3"},"populate_analytics.sh")," (Master Script)"),(0,n.yg)("p",null,"Orchestrates the entire pipeline."),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Usage:")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"./populate_analytics.sh --token TOKEN [OPTIONS]\n")),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Options:")),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"--num-users N")," - Number of users to generate (default: 20)"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"--num-days N")," - Days of history to generate (default: 30)"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"--events-per-day N")," - Target events per day (default: 200)"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"--gms-url URL")," - DataHub GMS URL (default: http://localhost:8080)"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"--token TOKEN")," - DataHub auth token (required)"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"--elasticsearch-url URL")," - Elasticsearch URL (default: http://localhost:9200)"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"--email-domain DOMAIN")," - Email domain for users (default: example.com)"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"--skip-users")," - Skip user generation"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"--skip-events")," - Skip event generation"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"--skip-load")," - Skip loading to Elasticsearch")),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Examples:")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"# Generate 50 users with 60 days of high activity\n./populate_analytics.sh --token $TOKEN --num-users 50 --num-days 60 --events-per-day 500\n\n# Only generate events (users already exist)\n./populate_analytics.sh --token $TOKEN --skip-users\n\n# Generate data but don't load yet (for review)\n./populate_analytics.sh --token $TOKEN --skip-load\n")),(0,n.yg)("h3",{id:"2-generate_userspy"},"2. ",(0,n.yg)("inlineCode",{parentName:"h3"},"generate_users.py")),(0,n.yg)("p",null,"Creates synthetic user profiles and emits them to DataHub."),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Features:")),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Realistic names, emails, titles, departments"),(0,n.yg)("li",{parentName:"ul"},"Proper CorpUser aspects (info, editable info, status)"),(0,n.yg)("li",{parentName:"ul"},"Configurable email domain"),(0,n.yg)("li",{parentName:"ul"},"Saves user profiles to JSON for event generation")),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Usage:")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"python generate_users.py \\\n  --num-users 20 \\\n  --token $TOKEN \\\n  --output-file users.json\n")),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Output:")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-json"},'[\n  {\n    "username": "alice.anderson",\n    "first_name": "Alice",\n    "last_name": "Anderson",\n    "email": "alice.anderson@example.com",\n    "display_name": "Alice Anderson",\n    "title": "Data Engineer",\n    "department": "Engineering",\n    "team": "Platform"\n  },\n  ...\n]\n')),(0,n.yg)("h3",{id:"3-generate_glossary_termspy"},"3. ",(0,n.yg)("inlineCode",{parentName:"h3"},"generate_glossary_terms.py")),(0,n.yg)("p",null,"Creates business glossary terms and attaches them to datasets."),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Features:")),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"20+ predefined business terms across 5 categories (Customer Data, Financial Metrics, Product Metrics, Sales & Marketing, Operations)"),(0,n.yg)("li",{parentName:"ul"},"Realistic term definitions and metadata"),(0,n.yg)("li",{parentName:"ul"},"Automatic attachment to ~70% of existing datasets"),(0,n.yg)("li",{parentName:"ul"},"Each dataset receives 1-3 random terms from different categories"),(0,n.yg)("li",{parentName:"ul"},'Populates "Data Assets by Term" analytics chart')),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Categories:")),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Customer Data"),": Customer ID, Customer Lifetime Value, Customer Segment, Churn Rate"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Financial Metrics"),": Revenue, Annual Recurring Revenue, Gross Margin, Operating Expenses"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Product Metrics"),": Daily Active Users, Monthly Active Users, User Engagement, Feature Adoption"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Sales & Marketing"),": Lead, Conversion Rate, Customer Acquisition Cost, Marketing Qualified Lead"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Operations"),": Service Level Agreement, Incident, Mean Time To Resolution, Uptime")),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Usage:")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"python generate_glossary_terms.py \\\n  --token $TOKEN \\\n  --entity-urns-file entity_urns.json \\\n  --output-file glossary_terms.json\n")),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Output:")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "terms": [\n    {\n      "name": "Customer ID",\n      "urn": "urn:li:glossaryTerm:customer_id",\n      "category": "Customer Data",\n      "definition": "Unique identifier for a customer"\n    },\n    ...\n  ],\n  "attachments": [\n    {\n      "dataset_urn": "urn:li:dataset:...",\n      "term_urns": ["urn:li:glossaryTerm:customer_id", ...],\n      "num_terms": 2\n    },\n    ...\n  ]\n}\n')),(0,n.yg)("h3",{id:"4-backfill_activity_eventspy"},"4. ",(0,n.yg)("inlineCode",{parentName:"h3"},"backfill_activity_events.py")),(0,n.yg)("p",null,"Generates realistic user activity events with backdated timestamps."),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Event Types Generated:")),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"EntityViewEvent")," - Dataset, dashboard, chart views"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"EntityActionEvent")," - Tab views, actions on entities"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"SearchEvent")," - Search queries"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"SearchResultsViewEvent")," - Search results viewed"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"HomePageViewEvent")," - Home page visits"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("inlineCode",{parentName:"li"},"LogInEvent")," - User login events")),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Features:")),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Realistic temporal patterns (working hours, weekdays vs weekends)"),(0,n.yg)("li",{parentName:"ul"},"Power user simulation (20% of users generate 80% of activity)"),(0,n.yg)("li",{parentName:"ul"},"Session-based activity (login \u2192 browse \u2192 search \u2192 view entities)"),(0,n.yg)("li",{parentName:"ul"},"Varied entity types and search queries")),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Usage:")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"# Generate and save to file\npython backfill_activity_events.py \\\n  --users-file users.json \\\n  --days 30 \\\n  --events-per-day 200 \\\n  --output-file activity_events.json\n\n# Generate and load directly to Elasticsearch (for CI/automated tests)\npython backfill_activity_events.py \\\n  --users-file users.json \\\n  --days 30 \\\n  --events-per-day 200 \\\n  --elasticsearch-url http://localhost:9200 \\\n  --load-to-elasticsearch\n\n# Both save to file AND load to Elasticsearch\npython backfill_activity_events.py \\\n  --users-file users.json \\\n  --days 30 \\\n  --events-per-day 200 \\\n  --output-file activity_events.json \\\n  --elasticsearch-url http://localhost:9200 \\\n  --load-to-elasticsearch\n")),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Key Feature: Relative Timestamps")),(0,n.yg)("p",null,"The script generates events with timestamps ",(0,n.yg)("strong",{parentName:"p"},"relative to execution time"),', ensuring "Past Week" and "Past Month" analytics always have fresh data regardless of when tests run. This is critical for CI environments where tests must pass consistently over time.'),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Output:")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-json"},'[\n  {\n    "type": "EntityViewEvent",\n    "timestamp": 1696780800000,\n    "actorUrn": "urn:li:corpuser:alice.anderson",\n    "entityUrn": "urn:li:dataset:(urn:li:dataPlatform:bigquery,project.dataset.table,PROD)",\n    "entityType": "dataset",\n    "usageSource": "web"\n  },\n  ...\n]\n')),(0,n.yg)("h3",{id:"5-load_events_to_elasticsearchsh"},"5. ",(0,n.yg)("inlineCode",{parentName:"h3"},"load_events_to_elasticsearch.sh")),(0,n.yg)("p",null,"Loads events into Elasticsearch using the bulk API."),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Features:")),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Batch processing for large event volumes"),(0,n.yg)("li",{parentName:"ul"},"Progress reporting"),(0,n.yg)("li",{parentName:"ul"},"Error handling"),(0,n.yg)("li",{parentName:"ul"},"Index refresh after load")),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Usage:")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"./load_events_to_elasticsearch.sh activity_events.json\n\n# Custom Elasticsearch\n./load_events_to_elasticsearch.sh \\\n  -e http://elasticsearch:9200 \\\n  -i datahub_usage_event \\\n  activity_events.json\n")),(0,n.yg)("h2",{id:"configuration"},"Configuration"),(0,n.yg)("h3",{id:"environment-variables"},"Environment Variables"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},'# DataHub configuration\nexport DATAHUB_GMS_URL="http://localhost:8080"\nexport DATAHUB_TOKEN="your-token-here"\n\n# Elasticsearch configuration\nexport ELASTICSEARCH_URL="http://localhost:9200"\n\n# Generation parameters\nexport NUM_USERS=20\nexport NUM_DAYS=30\nexport EVENTS_PER_DAY=200\nexport EMAIL_DOMAIN="example.com"\n')),(0,n.yg)("h3",{id:"customization"},"Customization"),(0,n.yg)("h4",{id:"custom-entity-urns"},"Custom Entity URNs"),(0,n.yg)("p",null,"Provide your own entity URNs for more realistic activity:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},'# Extract entities from your DataHub instance\ndatahub get --urn "urn:li:dataset:*" > my_entities.json\n\n# Use in event generation\npython backfill_activity_events.py \\\n  --entity-urns-file my_entities.json \\\n  ...\n')),(0,n.yg)("h4",{id:"temporal-patterns"},"Temporal Patterns"),(0,n.yg)("p",null,"Events are generated with realistic patterns:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Weekdays"),": Full ",(0,n.yg)("inlineCode",{parentName:"li"},"EVENTS_PER_DAY")," count"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Weekends"),": 33% of ",(0,n.yg)("inlineCode",{parentName:"li"},"EVENTS_PER_DAY")),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Working Hours"),": 9 AM - 6 PM"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Power Users"),": 20% of users generate 80% of events")),(0,n.yg)("h2",{id:"generated-data-structure"},"Generated Data Structure"),(0,n.yg)("h3",{id:"users"},"Users"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Count"),": Configurable (default: 20)"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Departments"),": Engineering, Data Science, Product, Marketing, etc."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Titles"),": Data Engineer, Data Scientist, Analytics Engineer, etc."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Teams"),": Platform, Growth, Data Infrastructure, etc.")),(0,n.yg)("h3",{id:"activity-events"},"Activity Events"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Volume"),": ",(0,n.yg)("inlineCode",{parentName:"li"},"NUM_DAYS \xd7 EVENTS_PER_DAY")," (default: 6,000 events)"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Time Range"),": Last N days with backdated timestamps"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Event Distribution"),":",(0,n.yg)("ul",{parentName:"li"},(0,n.yg)("li",{parentName:"ul"},"Entity Views: ~40%"),(0,n.yg)("li",{parentName:"ul"},"Tab Views: ~25%"),(0,n.yg)("li",{parentName:"ul"},"Searches: ~20%"),(0,n.yg)("li",{parentName:"ul"},"Page Views: ~10%"),(0,n.yg)("li",{parentName:"ul"},"Logins: ~5%")))),(0,n.yg)("h2",{id:"analytics-charts-populated"},"Analytics Charts Populated"),(0,n.yg)("h3",{id:"user-analytics"},"User Analytics"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Weekly Active Users")," - Distinct users per week"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Monthly Active Users")," - Distinct users per month"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"New Users (Last 30 Days)")," - First-time users"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Top Users (Last 30 Days)")," - Most active users")),(0,n.yg)("h3",{id:"search-analytics"},"Search Analytics"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Number of Searches")," - Total search count over time"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Top Searches (Past Week)")," - Most frequent queries")),(0,n.yg)("h3",{id:"entity-analytics"},"Entity Analytics"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Top Viewed Datasets (Past Week)")," - Most viewed datasets"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Top Viewed Dashboards (Past Week)")," - Most viewed dashboards"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Tab Views By Entity Type (Past Week)")," - Tab views breakdown"),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Actions By Entity Type (Past Week)")," - Actions breakdown")),(0,n.yg)("h3",{id:"metadata-analytics"},"Metadata Analytics"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Data Assets by Term")," - Dataset distribution across glossary terms")),(0,n.yg)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,n.yg)("h3",{id:"cannot-connect-to-datahub-gms"},'"Cannot connect to DataHub GMS"'),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Verify DataHub is running: ",(0,n.yg)("inlineCode",{parentName:"li"},"curl http://localhost:8080/health")),(0,n.yg)("li",{parentName:"ul"},"Check ",(0,n.yg)("inlineCode",{parentName:"li"},"--gms-url")," parameter")),(0,n.yg)("h3",{id:"cannot-connect-to-elasticsearch"},'"Cannot connect to Elasticsearch"'),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Verify Elasticsearch is running: ",(0,n.yg)("inlineCode",{parentName:"li"},"curl http://localhost:9200/_cluster/health")),(0,n.yg)("li",{parentName:"ul"},"Check ",(0,n.yg)("inlineCode",{parentName:"li"},"--elasticsearch-url")," parameter"),(0,n.yg)("li",{parentName:"ul"},"For Docker: ",(0,n.yg)("inlineCode",{parentName:"li"},"docker ps | grep elasticsearch"))),(0,n.yg)("h3",{id:"datahub-python-package-not-found"},'"datahub Python package not found"'),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"pip install 'acryl-datahub[datahub-rest]'\n")),(0,n.yg)("h3",{id:"jq-command-not-found"},'"jq command not found"'),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"# macOS\nbrew install jq\n\n# Ubuntu/Debian\nsudo apt-get install jq\n\n# RHEL/CentOS\nsudo yum install jq\n")),(0,n.yg)("h3",{id:"analytics-charts-not-showing-data"},"Analytics charts not showing data"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},"Wait a few minutes for Elasticsearch indexing"),(0,n.yg)("li",{parentName:"ol"},"Refresh the analytics page"),(0,n.yg)("li",{parentName:"ol"},"Check index exists: ",(0,n.yg)("inlineCode",{parentName:"li"},"curl http://localhost:9200/datahub_usage_event/_count")),(0,n.yg)("li",{parentName:"ol"},"Verify events loaded: Check the count is > 0")),(0,n.yg)("h3",{id:"events-loaded-but-charts-still-empty"},"Events loaded but charts still empty"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"DataHub filters out backend-generated events"),(0,n.yg)("li",{parentName:"ul"},"Ensure ",(0,n.yg)("inlineCode",{parentName:"li"},"usageSource"),' is set to "web" (scripts handle this)'),(0,n.yg)("li",{parentName:"ul"},"Check DataHub logs for errors")),(0,n.yg)("h2",{id:"advanced-usage"},"Advanced Usage"),(0,n.yg)("h3",{id:"integration-with-smoke-tests"},"Integration with Smoke Tests"),(0,n.yg)("p",null,"Analytics tests now use pytest fixtures for automatic data loading with relative timestamps:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-python"},'# In smoke-test/tests/analytics/test_analytics.py\ndef test_weekly_active_users_chart(auth_session, analytics_events_loaded):\n    """Test Weekly Active Users chart - fixture ensures fresh data."""\n    # Query analytics charts...\n    # Assertions will pass because data is generated relative to execution time\n')),(0,n.yg)("p",null,"The ",(0,n.yg)("inlineCode",{parentName:"p"},"analytics_events_loaded")," fixture (defined in ",(0,n.yg)("inlineCode",{parentName:"p"},"tests/analytics/conftest.py"),"):"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Generates events with timestamps relative to current execution time"),(0,n.yg)("li",{parentName:"ul"},"Loads directly to Elasticsearch via bulk API"),(0,n.yg)("li",{parentName:"ul"},'Ensures "Past Week" and "Past Month" charts always have data'),(0,n.yg)("li",{parentName:"ul"},"Runs once per test session for efficiency")),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Benefits:")),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"\u2705 Tests pass consistently regardless of when they run"),(0,n.yg)("li",{parentName:"ul"},"\u2705 No stale pre-generated JSON files"),(0,n.yg)("li",{parentName:"ul"},"\u2705 Fresh analytics data for every CI run"),(0,n.yg)("li",{parentName:"ul"},"\u2705 Automatic cleanup between test sessions")),(0,n.yg)("h3",{id:"continuous-data-generation"},"Continuous Data Generation"),(0,n.yg)("p",null,"For ongoing testing:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"# Cron job to add daily activity\n0 0 * * * cd /path/to/analytics_backfill && ./populate_analytics.sh --token $TOKEN --num-days 1 --skip-users\n")),(0,n.yg)("h3",{id:"custom-activity-patterns"},"Custom Activity Patterns"),(0,n.yg)("p",null,"Modify ",(0,n.yg)("inlineCode",{parentName:"p"},"backfill_activity_events.py")," to add custom patterns:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-python"},'# Add specific events for your use case\ndef generate_dashboard_migration_events(self, date):\n    """Simulate a dashboard migration project."""\n    events = []\n    for dashboard_urn in self.dashboard_urns:\n        # Heavy activity on specific dashboards\n        for _ in range(50):\n            events.append(self.generate_entity_view_event(date, entity_urn=dashboard_urn))\n    return events\n')),(0,n.yg)("h2",{id:"best-practices"},"Best Practices"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("strong",{parentName:"li"},"Start Small"),": Test with 10 users and 7 days first"),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("strong",{parentName:"li"},"Review Before Loading"),": Use ",(0,n.yg)("inlineCode",{parentName:"li"},"--skip-load")," to review generated events"),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("strong",{parentName:"li"},"Backup"),": Backup Elasticsearch before loading large datasets"),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("strong",{parentName:"li"},"Realistic Numbers"),": 20-50 users, 30-90 days is realistic for most demos"),(0,n.yg)("li",{parentName:"ol"},(0,n.yg)("strong",{parentName:"li"},"Clean Up"),": Document how to remove test data if needed")),(0,n.yg)("h2",{id:"cleanup"},"Cleanup"),(0,n.yg)("p",null,"To remove generated data:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},'# Delete test users\ndatahub delete --urn "urn:li:corpuser:alice.anderson"\n\n# Delete usage events index\ncurl -X DELETE http://localhost:9200/datahub_usage_event\n\n# Recreate empty index (will be auto-created on next event)\n')),(0,n.yg)("h2",{id:"support"},"Support"),(0,n.yg)("p",null,"For issues or questions:"),(0,n.yg)("ol",null,(0,n.yg)("li",{parentName:"ol"},"Check DataHub logs: ",(0,n.yg)("inlineCode",{parentName:"li"},"docker logs datahub-gms")),(0,n.yg)("li",{parentName:"ol"},"Check Elasticsearch logs: ",(0,n.yg)("inlineCode",{parentName:"li"},"docker logs elasticsearch")),(0,n.yg)("li",{parentName:"ol"},"Review generated JSON files for correctness"),(0,n.yg)("li",{parentName:"ol"},"Open an issue in the DataHub repository")),(0,n.yg)("h2",{id:"license"},"License"),(0,n.yg)("p",null,"These tools are part of the DataHub project and follow the same Apache 2.0 license."))}m.isMDXComponent=!0}}]);