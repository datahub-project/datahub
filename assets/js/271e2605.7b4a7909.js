"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[72973],{15680:(e,t,n)=>{n.d(t,{xA:()=>p,yg:()=>y});var a=n(96540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),g=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=g(e.components);return a.createElement(s.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),m=g(n),c=r,y=m["".concat(s,".").concat(c)]||m[c]||u[c]||i;return n?a.createElement(y,l(l({ref:t},p),{},{components:n})):a.createElement(y,l({ref:t},p))}));function y(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=c;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[m]="string"==typeof e?e:r,l[1]=o;for(var g=2;g<i;g++)l[g]=n[g];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},36770:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>y,frontMatter:()=>o,metadata:()=>g,toc:()=>m});n(96540);var a=n(15680);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const o={title:"Document Change History Architecture",slug:"/datahub-web-react/src/app/entityv2/document/changehistory/architecture",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/datahub-web-react/src/app/entityV2/document/changeHistory/ARCHITECTURE.md"},s="Document Change History Architecture",g={unversionedId:"datahub-web-react/src/app/entityV2/document/changeHistory/ARCHITECTURE",id:"datahub-web-react/src/app/entityV2/document/changeHistory/ARCHITECTURE",title:"Document Change History Architecture",description:"Overview",source:"@site/genDocs/datahub-web-react/src/app/entityV2/document/changeHistory/ARCHITECTURE.md",sourceDirName:"datahub-web-react/src/app/entityV2/document/changeHistory",slug:"/datahub-web-react/src/app/entityv2/document/changehistory/architecture",permalink:"/docs/datahub-web-react/src/app/entityv2/document/changehistory/architecture",draft:!1,editUrl:"https://github.com/datahub-project/datahub/blob/master/datahub-web-react/src/app/entityV2/document/changeHistory/ARCHITECTURE.md",tags:[],version:"current",frontMatter:{title:"Document Change History Architecture",slug:"/datahub-web-react/src/app/entityv2/document/changehistory/architecture",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/datahub-web-react/src/app/entityV2/document/changeHistory/ARCHITECTURE.md"}},p={},m=[{value:"Overview",id:"overview",level:2},{value:"Architecture Principles",id:"architecture-principles",level:2},{value:"Directory Structure",id:"directory-structure",level:2},{value:"Component Hierarchy",id:"component-hierarchy",level:2},{value:"Key Features",id:"key-features",level:2},{value:"1. Testable Utilities",id:"1-testable-utilities",level:3},{value:"<code>extractChangeDetails(details)</code>",id:"extractchangedetailsdetails",level:4},{value:"<code>getActorDisplayName(actor, getDisplayName)</code>",id:"getactordisplaynameactor-getdisplayname",level:4},{value:"2. Custom Hooks",id:"2-custom-hooks",level:3},{value:"<code>useParentDocumentTitle(parentUrn)</code>",id:"useparentdocumenttitleparenturn",level:4},{value:"3. Error &amp; Loading States",id:"3-error--loading-states",level:3},{value:"4. User Experience",id:"4-user-experience",level:3},{value:"Timestamps",id:"timestamps",level:4},{value:"Change Messages",id:"change-messages",level:4},{value:"Restore Flow",id:"restore-flow",level:4},{value:"Adding a New Change Type",id:"adding-a-new-change-type",level:2},{value:"GraphQL Integration",id:"graphql-integration",level:2},{value:"Query",id:"query",level:3},{value:"Mutation (for restore)",id:"mutation-for-restore",level:3},{value:"Testing Strategy",id:"testing-strategy",level:2},{value:"Unit Tests (Recommended)",id:"unit-tests-recommended",level:3},{value:"Integration Tests",id:"integration-tests",level:3},{value:"E2E Tests",id:"e2e-tests",level:3},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"Optimizations",id:"optimizations",level:3},{value:"Data Loading",id:"data-loading",level:3},{value:"Future Enhancements",id:"future-enhancements",level:2},{value:"Potential Improvements",id:"potential-improvements",level:3},{value:"Extensibility Points",id:"extensibility-points",level:3},{value:"Code Quality Metrics",id:"code-quality-metrics",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Internal",id:"internal",level:3},{value:"External",id:"external",level:3},{value:"Maintenance Guide",id:"maintenance-guide",level:2},{value:"Common Tasks",id:"common-tasks",level:3},{value:"Debugging",id:"debugging",level:3}],u={toc:m},c="wrapper";function y(e){var{components:t}=e,n=l(e,["components"]);return(0,a.yg)(c,i(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){r(e,t,n[t])}))}return e}({},u,n),{components:t,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"document-change-history-architecture"},"Document Change History Architecture"),(0,a.yg)("h2",{id:"overview"},"Overview"),(0,a.yg)("p",null,"The Document Change History feature provides a timeline view of all changes made to a document, including creation, title changes, content modifications, moves, state changes, and deletions. Users can view previous versions and restore them if needed."),(0,a.yg)("h2",{id:"architecture-principles"},"Architecture Principles"),(0,a.yg)("p",null,"This implementation follows best practices for:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"\u2705 ",(0,a.yg)("strong",{parentName:"li"},"Testability"),": Complex logic extracted into pure utility functions and custom hooks"),(0,a.yg)("li",{parentName:"ul"},"\u2705 ",(0,a.yg)("strong",{parentName:"li"},"Extensibility"),": Easy to add new change types without touching existing code"),(0,a.yg)("li",{parentName:"ul"},"\u2705 ",(0,a.yg)("strong",{parentName:"li"},"Type Safety"),": Full TypeScript support with proper type definitions"),(0,a.yg)("li",{parentName:"ul"},"\u2705 ",(0,a.yg)("strong",{parentName:"li"},"Error Handling"),": Graceful degradation with loading and error states"),(0,a.yg)("li",{parentName:"ul"},"\u2705 ",(0,a.yg)("strong",{parentName:"li"},"User Experience"),": Relative timestamps with full date on hover, smooth interactions")),(0,a.yg)("h2",{id:"directory-structure"},"Directory Structure"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"changeHistory/\n\u251c\u2500\u2500 ARCHITECTURE.md                      # This file\n\u251c\u2500\u2500 hooks/\n\u2502   \u2514\u2500\u2500 useParentDocumentTitle.ts       # Custom hook for fetching parent titles\n\u251c\u2500\u2500 utils/\n\u2502   \u2514\u2500\u2500 changeUtils.ts                  # Pure utility functions for data extraction\n\u251c\u2500\u2500 changeMessages/\n\u2502   \u251c\u2500\u2500 ChangeMessageComponents.tsx     # Individual message components + router\n\u2502   \u2514\u2500\u2500 README.md                       # Guide for adding new change types\n\u251c\u2500\u2500 DocumentChangeHistoryDrawer.tsx     # Main drawer container\n\u251c\u2500\u2500 DocumentHistoryTimeline.tsx         # Timeline list component\n\u251c\u2500\u2500 DocumentChangeTimelineContent.tsx   # Individual timeline entry\n\u251c\u2500\u2500 DocumentChangeTimelineDot.tsx       # User avatar for each change\n\u2514\u2500\u2500 PreviousVersionModal.tsx            # View/restore previous content\n")),(0,a.yg)("h2",{id:"component-hierarchy"},"Component Hierarchy"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"DocumentChangeHistoryDrawer\n\u2514\u2500\u2500 DocumentHistoryTimeline\n    \u2514\u2500\u2500 Timeline (from alchemy-components)\n        \u251c\u2500\u2500 DocumentChangeTimelineDot (for each item)\n        \u2514\u2500\u2500 DocumentChangeTimelineContent (for each item)\n            \u251c\u2500\u2500 ChangeMessage (router component)\n            \u2502   \u251c\u2500\u2500 CreatedMessage\n            \u2502   \u251c\u2500\u2500 TitleChangedMessage\n            \u2502   \u251c\u2500\u2500 TextChangedMessage\n            \u2502   \u251c\u2500\u2500 StateChangedMessage\n            \u2502   \u251c\u2500\u2500 ParentChangedMessage (uses useParentDocumentTitle hook)\n            \u2502   \u251c\u2500\u2500 DeletedMessage\n            \u2502   \u2514\u2500\u2500 DefaultMessage\n            \u2514\u2500\u2500 PreviousVersionModal (conditional, for text changes)\n")),(0,a.yg)("h2",{id:"key-features"},"Key Features"),(0,a.yg)("h3",{id:"1-testable-utilities"},"1. Testable Utilities"),(0,a.yg)("h4",{id:"extractchangedetailsdetails"},(0,a.yg)("inlineCode",{parentName:"h4"},"extractChangeDetails(details)")),(0,a.yg)("p",null,"Converts GraphQL StringMapEntry[] to Record<string, string>"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Input"),": Array of {key, value} objects"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Output"),": Simple key-value object"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Testable"),": Pure function, no dependencies"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Location"),": ",(0,a.yg)("inlineCode",{parentName:"li"},"utils/changeUtils.ts"))),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-typescript"},"// Easy to unit test\nconst details = [\n    { key: 'oldTitle', value: 'Old' },\n    { key: 'newTitle', value: 'New' },\n];\nconst result = extractChangeDetails(details);\n// { oldTitle: 'Old', newTitle: 'New' }\n")),(0,a.yg)("h4",{id:"getactordisplaynameactor-getdisplayname"},(0,a.yg)("inlineCode",{parentName:"h4"},"getActorDisplayName(actor, getDisplayName)")),(0,a.yg)("p",null,"Extracts actor display name with fallback"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Input"),": Actor object + display name function"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Output"),": String name or 'System'"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Testable"),": Can mock the getDisplayName function"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Location"),": ",(0,a.yg)("inlineCode",{parentName:"li"},"utils/changeUtils.ts"))),(0,a.yg)("h3",{id:"2-custom-hooks"},"2. Custom Hooks"),(0,a.yg)("h4",{id:"useparentdocumenttitleparenturn"},(0,a.yg)("inlineCode",{parentName:"h4"},"useParentDocumentTitle(parentUrn)")),(0,a.yg)("p",null,"Fetches parent document title with proper state handling"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Returns"),": ",(0,a.yg)("inlineCode",{parentName:"li"},"{ title, loading, error }")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"States"),":",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Loading: returns ",(0,a.yg)("inlineCode",{parentName:"li"},"'...'")),(0,a.yg)("li",{parentName:"ul"},"Error: returns ",(0,a.yg)("inlineCode",{parentName:"li"},"'Unknown Document'")," + logs error"),(0,a.yg)("li",{parentName:"ul"},"Success: returns actual title"),(0,a.yg)("li",{parentName:"ul"},"No URN: returns ",(0,a.yg)("inlineCode",{parentName:"li"},"'...'")))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Testable"),": Can be tested with mocked GraphQL queries"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Location"),": ",(0,a.yg)("inlineCode",{parentName:"li"},"hooks/useParentDocumentTitle.ts"))),(0,a.yg)("h3",{id:"3-error--loading-states"},"3. Error & Loading States"),(0,a.yg)("table",null,(0,a.yg)("thead",{parentName:"table"},(0,a.yg)("tr",{parentName:"thead"},(0,a.yg)("th",{parentName:"tr",align:null},"Component"),(0,a.yg)("th",{parentName:"tr",align:null},"Loading Handled"),(0,a.yg)("th",{parentName:"tr",align:null},"Error Handled"),(0,a.yg)("th",{parentName:"tr",align:null},"Notes"))),(0,a.yg)("tbody",{parentName:"table"},(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"useParentDocumentTitle")),(0,a.yg)("td",{parentName:"tr",align:null},"\u2705"),(0,a.yg)("td",{parentName:"tr",align:null},"\u2705"),(0,a.yg)("td",{parentName:"tr",align:null},"Shows '...' while loading, 'Unknown Document' on error")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"PreviousVersionModal")),(0,a.yg)("td",{parentName:"tr",align:null},"\u2705"),(0,a.yg)("td",{parentName:"tr",align:null},"\u2705"),(0,a.yg)("td",{parentName:"tr",align:null},"Disables buttons during restore, shows error message")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"DocumentHistoryTimeline")),(0,a.yg)("td",{parentName:"tr",align:null},"\u2705"),(0,a.yg)("td",{parentName:"tr",align:null},"\u2705"),(0,a.yg)("td",{parentName:"tr",align:null},"Shows loading skeleton, empty state message")))),(0,a.yg)("h3",{id:"4-user-experience"},"4. User Experience"),(0,a.yg)("h4",{id:"timestamps"},"Timestamps"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Relative"),': "2 minutes ago", "3 days ago" (using dayjs.fromNow())'),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Absolute"),': Hover shows full timestamp "March 15, 2024 2:30:45 PM"'),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Implementation"),": Popover with formatted timestamp")),(0,a.yg)("h4",{id:"change-messages"},"Change Messages"),(0,a.yg)("p",null,"All messages follow the pattern: ",(0,a.yg)("inlineCode",{parentName:"p"},"{ActorName} {action} {target}")),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"\u2705 Actor names in bold"),(0,a.yg)("li",{parentName:"ul"},"\u2705 Important values (titles, parent names) in bold"),(0,a.yg)("li",{parentName:"ul"},"\u2705 Interactive elements (links) styled appropriately")),(0,a.yg)("h4",{id:"restore-flow"},"Restore Flow"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},'Click "See previous version" \u2192 Opens modal'),(0,a.yg)("li",{parentName:"ol"},"Review old content"),(0,a.yg)("li",{parentName:"ol"},'Click "Restore" \u2192 Shows confirmation'),(0,a.yg)("li",{parentName:"ol"},"Confirm \u2192 Restores content + refetches + closes modals"),(0,a.yg)("li",{parentName:"ol"},"Error handling \u2192 Shows error message, keeps modals open")),(0,a.yg)("h2",{id:"adding-a-new-change-type"},"Adding a New Change Type"),(0,a.yg)("p",null,"See ",(0,a.yg)("inlineCode",{parentName:"p"},"changeMessages/README.md")," for detailed instructions. Quick summary:"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Update GraphQL schema")," (backend)"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Update event generator")," (backend, if needed)"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Create message component"),":",(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-typescript"},"export const MyNewMessage: React.FC<ActorWithDetailsProps> = ({ actorName, details }) => (\n    <ActionText>\n        <ActorName>{actorName}</ActorName> did something\n    </ActionText>\n);\n"))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Add to router"),":",(0,a.yg)("pre",{parentName:"li"},(0,a.yg)("code",{parentName:"pre",className:"language-typescript"},"case DocumentChangeType.MyNewType:\n    return <MyNewMessage actorName={actorName} details={details} />;\n"))),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Run ",(0,a.yg)("inlineCode",{parentName:"strong"},"yarn generate"))," to update types")),(0,a.yg)("h2",{id:"graphql-integration"},"GraphQL Integration"),(0,a.yg)("h3",{id:"query"},"Query"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-graphql"},"query getDocumentChangeHistory($urn: String!, $limit: Int) {\n    document(urn: $urn) {\n        changeHistory(limit: $limit) {\n            changeType\n            description\n            actor {\n                urn\n                type\n                username\n                info\n                editableProperties\n            }\n            timestamp\n            details {\n                key\n                value\n            }\n        }\n    }\n}\n")),(0,a.yg)("h3",{id:"mutation-for-restore"},"Mutation (for restore)"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-graphql"},"mutation updateDocumentContents($input: UpdateDocumentContentsInput!) {\n    updateDocumentContents(input: $input)\n}\n")),(0,a.yg)("h2",{id:"testing-strategy"},"Testing Strategy"),(0,a.yg)("h3",{id:"unit-tests-recommended"},"Unit Tests (Recommended)"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"changeUtils.ts")," functions (pure functions, easy to test)"),(0,a.yg)("li",{parentName:"ul"},"Individual message components (can pass mock data)"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"useParentDocumentTitle")," hook (mock GraphQL responses)")),(0,a.yg)("h3",{id:"integration-tests"},"Integration Tests"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Full timeline rendering with mock data"),(0,a.yg)("li",{parentName:"ul"},"Restore flow (mock mutations)"),(0,a.yg)("li",{parentName:"ul"},"Error handling scenarios")),(0,a.yg)("h3",{id:"e2e-tests"},"E2E Tests"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Create document \u2192 view history \u2192 see creation event"),(0,a.yg)("li",{parentName:"ul"},"Edit title \u2192 view history \u2192 see title change with new title"),(0,a.yg)("li",{parentName:"ul"},"Edit content \u2192 view history \u2192 see content change \u2192 restore previous version"),(0,a.yg)("li",{parentName:"ul"},"Move document \u2192 view history \u2192 see move with parent name")),(0,a.yg)("h2",{id:"performance-considerations"},"Performance Considerations"),(0,a.yg)("h3",{id:"optimizations"},"Optimizations"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Conditional Query"),": Parent title only fetched when needed"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Skip Flag"),": GraphQL queries skipped when URN is empty"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Memoization"),": ",(0,a.yg)("inlineCode",{parentName:"li"},"details")," object memoized in component"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Code Splitting"),": Large modal only loaded when needed")),(0,a.yg)("h3",{id:"data-loading"},"Data Loading"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Timeline loads up to 100 most recent changes"),(0,a.yg)("li",{parentName:"ul"},"Each change with a parent triggers a separate query (could be optimized with batching if needed)"),(0,a.yg)("li",{parentName:"ul"},"Modal content is part of change details (no additional fetch needed)")),(0,a.yg)("h2",{id:"future-enhancements"},"Future Enhancements"),(0,a.yg)("h3",{id:"potential-improvements"},"Potential Improvements"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Diff View"),": Show inline diffs for content changes (not just full previous version)"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Batch Parent Queries"),": Load all parent titles in one query"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Infinite Scroll"),": Load more changes on demand"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Filtering"),": Filter by change type, date range, or actor"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Comparison"),": Compare any two versions side-by-side"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Annotations"),": Add comments to specific changes")),(0,a.yg)("h3",{id:"extensibility-points"},"Extensibility Points"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Add new change types in ",(0,a.yg)("inlineCode",{parentName:"li"},"ChangeMessageComponents.tsx")),(0,a.yg)("li",{parentName:"ul"},"Add new data fetching hooks in ",(0,a.yg)("inlineCode",{parentName:"li"},"hooks/")),(0,a.yg)("li",{parentName:"ul"},"Add new utilities in ",(0,a.yg)("inlineCode",{parentName:"li"},"utils/")),(0,a.yg)("li",{parentName:"ul"},"Customize message rendering per change type")),(0,a.yg)("h2",{id:"code-quality-metrics"},"Code Quality Metrics"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Lines of Code"),": ~600 total"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Number of Components"),": 11"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Number of Hooks"),": 1 custom"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Number of Utilities"),": 2"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"TypeScript Coverage"),": 100%"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Linting Errors"),": 0"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Type Errors"),": 0")),(0,a.yg)("h2",{id:"dependencies"},"Dependencies"),(0,a.yg)("h3",{id:"internal"},"Internal"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"@app/entityV2/document")," - Document queries and mutations"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"@app/useEntityRegistry")," - Entity display names"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"@app/sharedV2/modals/ConfirmationModal")," - Confirmation dialogs"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"@src/alchemy-components")," - UI components (Timeline, Popover, Button, etc.)")),(0,a.yg)("h3",{id:"external"},"External"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"dayjs")," - Date formatting and relative time"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"antd")," - Modal component"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"react")," - Component framework"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"styled-components")," - Styling")),(0,a.yg)("h2",{id:"maintenance-guide"},"Maintenance Guide"),(0,a.yg)("h3",{id:"common-tasks"},"Common Tasks"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Update message text"),": Edit the appropriate component in ",(0,a.yg)("inlineCode",{parentName:"p"},"changeMessages/ChangeMessageComponents.tsx")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Change timestamp format"),": Modify ",(0,a.yg)("inlineCode",{parentName:"p"},"dayjs.format()")," calls in ",(0,a.yg)("inlineCode",{parentName:"p"},"DocumentChangeTimelineContent.tsx")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Add new detail field"),": Update backend event generator \u2192 regenerate types \u2192 use in message component"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Customize styling"),": Update styled-components in respective files"),(0,a.yg)("h3",{id:"debugging"},"Debugging"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Timeline not showing"),": Check GraphQL query response in DevTools Network tab"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Parent name shows '...'"),": Check if parent URN is valid and document exists"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Restore not working"),": Check mutation response and refetch behavior"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"Wrong actor name"),": Verify actor data in change history response"))}y.isMDXComponent=!0}}]);