"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[90020],{15680:(e,t,a)=>{a.d(t,{xA:()=>d,yg:()=>m});var n=a(96540);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var g=n.createContext({}),p=function(e){var t=n.useContext(g),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},d=function(e){var t=p(e.components);return n.createElement(g.Provider,{value:t},e.children)},y="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},s=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,g=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),y=p(a),s=r,m=y["".concat(g,".").concat(s)]||y[s]||u[s]||l;return a?n.createElement(m,i(i({ref:t},d),{},{components:a})):n.createElement(m,i({ref:t},d))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=s;var o={};for(var g in t)hasOwnProperty.call(t,g)&&(o[g]=t[g]);o.originalType=e,o[y]="string"==typeof e?e:r,i[1]=o;for(var p=2;p<l;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}s.displayName="MDXCreateElement"},77223:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>d,contentTitle:()=>g,default:()=>m,frontMatter:()=>o,metadata:()=>p,toc:()=>y});a(96540);var n=a(15680);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})),e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}const o={sidebar_position:5,title:"Azure Data Factory",slug:"/generated/ingestion/sources/azure-data-factory",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/generated/ingestion/sources/azure-data-factory.md"},g="Azure Data Factory",p={unversionedId:"docs/generated/ingestion/sources/azure-data-factory",id:"docs/generated/ingestion/sources/azure-data-factory",title:"Azure Data Factory",description:"For context on getting started with ingestion, check out our metadata ingestion guide.",source:"@site/genDocs/docs/generated/ingestion/sources/azure-data-factory.md",sourceDirName:"docs/generated/ingestion/sources",slug:"/generated/ingestion/sources/azure-data-factory",permalink:"/docs/generated/ingestion/sources/azure-data-factory",draft:!1,editUrl:"https://github.com/datahub-project/datahub/blob/master/docs/generated/ingestion/sources/azure-data-factory.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5,title:"Azure Data Factory",slug:"/generated/ingestion/sources/azure-data-factory",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/generated/ingestion/sources/azure-data-factory.md"},sidebar:"overviewSidebar",previous:{title:"Azure AD",permalink:"/docs/generated/ingestion/sources/azure-ad"},next:{title:"BigQuery",permalink:"/docs/generated/ingestion/sources/bigquery"}},d={},y=[{value:"Setup",id:"setup",level:2},{value:"Quickstart Recipe",id:"quickstart-recipe",level:2},{value:"Authentication Methods",id:"authentication-methods",level:2},{value:"Config Details",id:"config-details",level:2},{value:"Entity Mapping",id:"entity-mapping",level:2},{value:"Questions",id:"questions",level:2},{value:"Important Capabilities",id:"important-capabilities",level:3},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Authentication",id:"authentication",level:3},{value:"Required Permissions",id:"required-permissions",level:3},{value:"Lineage Extraction",id:"lineage-extraction",level:2},{value:"Which Activities Produce Lineage?",id:"which-activities-produce-lineage",level:3},{value:"How Lineage Resolution Works",id:"how-lineage-resolution-works",level:3},{value:"Data Flow Transformation Scripts",id:"data-flow-transformation-scripts",level:3},{value:"Column-Level Lineage",id:"column-level-lineage",level:3},{value:"Supported Mapping Formats",id:"supported-mapping-formats",level:4},{value:"Limitations",id:"limitations",level:4},{value:"Execution History",id:"execution-history",level:2},{value:"Advanced: Multi-Environment Setup",id:"advanced-multi-environment-setup",level:2},{value:"When to Use <code>platform_instance</code>",id:"when-to-use-platform_instance",level:3},{value:"URN Format",id:"urn-format",level:3},{value:"CLI based Ingestion",id:"cli-based-ingestion",level:3},{value:"Starter Recipe",id:"starter-recipe",level:3},{value:"Code Coordinates",id:"code-coordinates",level:3}],u={toc:y},s="wrapper";function m(e){var{components:t}=e,a=i(e,["components"]);return(0,n.yg)(s,l(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){r(e,t,a[t])}))}return e}({},u,a),{components:t,mdxType:"MDXLayout"}),(0,n.yg)("h1",{id:"azure-data-factory"},"Azure Data Factory"),(0,n.yg)("h1",{id:"azure-data-factory-1"},"Azure Data Factory"),(0,n.yg)("p",null,"For context on getting started with ingestion, check out our ",(0,n.yg)("a",{parentName:"p",href:"/docs/metadata-ingestion"},"metadata ingestion guide"),"."),(0,n.yg)("h2",{id:"setup"},"Setup"),(0,n.yg)("p",null,"To install this plugin, run ",(0,n.yg)("inlineCode",{parentName:"p"},"pip install 'acryl-datahub[azure-data-factory]'"),"."),(0,n.yg)("h2",{id:"quickstart-recipe"},"Quickstart Recipe"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-yaml"},'source:\n  type: azure-data-factory\n  config:\n    # Required\n    subscription_id: ${AZURE_SUBSCRIPTION_ID}\n\n    # Authentication (service principal)\n    credential:\n      authentication_method: service_principal\n      client_id: ${AZURE_CLIENT_ID}\n      client_secret: ${AZURE_CLIENT_SECRET}\n      tenant_id: ${AZURE_TENANT_ID}\n\n    # Optional filters\n    factory_pattern:\n      allow: ["prod-.*"]\n\n    # Features\n    include_lineage: true\n    include_execution_history: false\n\n    env: PROD\n\nsink:\n  type: datahub-rest\n  config:\n    server: "http://localhost:8080"\n')),(0,n.yg)("h2",{id:"authentication-methods"},"Authentication Methods"),(0,n.yg)("table",null,(0,n.yg)("thead",{parentName:"table"},(0,n.yg)("tr",{parentName:"thead"},(0,n.yg)("th",{parentName:"tr",align:null},"Method"),(0,n.yg)("th",{parentName:"tr",align:null},"Config Value"),(0,n.yg)("th",{parentName:"tr",align:null},"Use Case"))),(0,n.yg)("tbody",{parentName:"table"},(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Service Principal"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"service_principal")),(0,n.yg)("td",{parentName:"tr",align:null},"Production")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Managed Identity"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"managed_identity")),(0,n.yg)("td",{parentName:"tr",align:null},"Azure-hosted")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Azure CLI"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"cli")),(0,n.yg)("td",{parentName:"tr",align:null},"Local development")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Auto-detect"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"default")),(0,n.yg)("td",{parentName:"tr",align:null},"Flexible")))),(0,n.yg)("h2",{id:"config-details"},"Config Details"),(0,n.yg)("table",null,(0,n.yg)("thead",{parentName:"table"},(0,n.yg)("tr",{parentName:"thead"},(0,n.yg)("th",{parentName:"tr",align:null},"Field"),(0,n.yg)("th",{parentName:"tr",align:null},"Required"),(0,n.yg)("th",{parentName:"tr",align:null},"Description"))),(0,n.yg)("tbody",{parentName:"table"},(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"subscription_id")),(0,n.yg)("td",{parentName:"tr",align:null},"\u2705"),(0,n.yg)("td",{parentName:"tr",align:null},"Azure subscription ID")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"credential.authentication_method")),(0,n.yg)("td",{parentName:"tr",align:null}),(0,n.yg)("td",{parentName:"tr",align:null},"Auth method (default: ",(0,n.yg)("inlineCode",{parentName:"td"},"default"),")")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"credential.client_id")),(0,n.yg)("td",{parentName:"tr",align:null}),(0,n.yg)("td",{parentName:"tr",align:null},"App (client) ID for service principal")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"credential.client_secret")),(0,n.yg)("td",{parentName:"tr",align:null}),(0,n.yg)("td",{parentName:"tr",align:null},"Client secret for service principal")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"credential.tenant_id")),(0,n.yg)("td",{parentName:"tr",align:null}),(0,n.yg)("td",{parentName:"tr",align:null},"Tenant (directory) ID")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"resource_group")),(0,n.yg)("td",{parentName:"tr",align:null}),(0,n.yg)("td",{parentName:"tr",align:null},"Filter to specific resource group")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"factory_pattern")),(0,n.yg)("td",{parentName:"tr",align:null}),(0,n.yg)("td",{parentName:"tr",align:null},"Regex allow/deny for factories")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"pipeline_pattern")),(0,n.yg)("td",{parentName:"tr",align:null}),(0,n.yg)("td",{parentName:"tr",align:null},"Regex allow/deny for pipelines")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"include_lineage")),(0,n.yg)("td",{parentName:"tr",align:null}),(0,n.yg)("td",{parentName:"tr",align:null},"Extract lineage (default: ",(0,n.yg)("inlineCode",{parentName:"td"},"true"),")")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"include_execution_history")),(0,n.yg)("td",{parentName:"tr",align:null}),(0,n.yg)("td",{parentName:"tr",align:null},"Extract pipeline runs (default: ",(0,n.yg)("inlineCode",{parentName:"td"},"false"),")")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"execution_history_days")),(0,n.yg)("td",{parentName:"tr",align:null}),(0,n.yg)("td",{parentName:"tr",align:null},"Days of history, 1-90 (default: ",(0,n.yg)("inlineCode",{parentName:"td"},"7"),")")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"platform_instance_map")),(0,n.yg)("td",{parentName:"tr",align:null}),(0,n.yg)("td",{parentName:"tr",align:null},"Map linked services to platform instances")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"env")),(0,n.yg)("td",{parentName:"tr",align:null}),(0,n.yg)("td",{parentName:"tr",align:null},"Environment (default: ",(0,n.yg)("inlineCode",{parentName:"td"},"PROD"),")")))),(0,n.yg)("h2",{id:"entity-mapping"},"Entity Mapping"),(0,n.yg)("table",null,(0,n.yg)("thead",{parentName:"table"},(0,n.yg)("tr",{parentName:"thead"},(0,n.yg)("th",{parentName:"tr",align:null},"ADF Concept"),(0,n.yg)("th",{parentName:"tr",align:null},"DataHub Entity"))),(0,n.yg)("tbody",{parentName:"table"},(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Data Factory"),(0,n.yg)("td",{parentName:"tr",align:null},"Container")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Pipeline"),(0,n.yg)("td",{parentName:"tr",align:null},"DataFlow")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Activity"),(0,n.yg)("td",{parentName:"tr",align:null},"DataJob")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Dataset"),(0,n.yg)("td",{parentName:"tr",align:null},"Dataset")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Pipeline Run"),(0,n.yg)("td",{parentName:"tr",align:null},"DataProcessInstance")))),(0,n.yg)("h2",{id:"questions"},"Questions"),(0,n.yg)("p",null,"If you've got any questions on configuring this source, feel free to ping us on ",(0,n.yg)("a",{parentName:"p",href:"https://slack.datahubproject.io/"},"our Slack"),".\n",(0,n.yg)("img",{parentName:"p",src:"https://img.shields.io/badge/support%20status-incubating-blue",alt:"Incubating"})),(0,n.yg)("h3",{id:"important-capabilities"},"Important Capabilities"),(0,n.yg)("table",null,(0,n.yg)("thead",{parentName:"table"},(0,n.yg)("tr",{parentName:"thead"},(0,n.yg)("th",{parentName:"tr",align:null},"Capability"),(0,n.yg)("th",{parentName:"tr",align:null},"Status"),(0,n.yg)("th",{parentName:"tr",align:null},"Notes"))),(0,n.yg)("tbody",{parentName:"table"},(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Asset Containers"),(0,n.yg)("td",{parentName:"tr",align:null},"\u2705"),(0,n.yg)("td",{parentName:"tr",align:null},"Enabled by default. Supported for types - Data Factory.")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("a",{parentName:"td",href:"/docs/metadata-ingestion/docs/dev_guides/stateful#stale-entity-removal"},"Detect Deleted Entities")),(0,n.yg)("td",{parentName:"tr",align:null},"\u2705"),(0,n.yg)("td",{parentName:"tr",align:null},"Enabled by default via stateful ingestion.")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("a",{parentName:"td",href:"/docs/platform-instances"},"Platform Instance")),(0,n.yg)("td",{parentName:"tr",align:null},"\u2705"),(0,n.yg)("td",{parentName:"tr",align:null},"Enabled by default.")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Table-Level Lineage"),(0,n.yg)("td",{parentName:"tr",align:null},"\u2705"),(0,n.yg)("td",{parentName:"tr",align:null},"Extracts lineage from Copy and Data Flow activities. Supported for types - Copy Activity, Data Flow Activity.")))),(0,n.yg)("admonition",{title:"Not Azure Fabric",type:"note"},(0,n.yg)("p",{parentName:"admonition"},"This connector is for ",(0,n.yg)("strong",{parentName:"p"},"Azure Data Factory")," (classic), not Azure Fabric's Data Factory. Azure Fabric support is planned for a future release.")),(0,n.yg)("h2",{id:"prerequisites"},"Prerequisites"),(0,n.yg)("h3",{id:"authentication"},"Authentication"),(0,n.yg)("p",null,"The connector supports multiple authentication methods:"),(0,n.yg)("table",null,(0,n.yg)("thead",{parentName:"table"},(0,n.yg)("tr",{parentName:"thead"},(0,n.yg)("th",{parentName:"tr",align:null},"Method"),(0,n.yg)("th",{parentName:"tr",align:null},"Best For"),(0,n.yg)("th",{parentName:"tr",align:null},"Configuration"))),(0,n.yg)("tbody",{parentName:"table"},(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"Service Principal")),(0,n.yg)("td",{parentName:"tr",align:null},"Production environments"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"authentication_method: service_principal"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"Managed Identity")),(0,n.yg)("td",{parentName:"tr",align:null},"Azure-hosted deployments (VMs, AKS, App Service)"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"authentication_method: managed_identity"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"Azure CLI")),(0,n.yg)("td",{parentName:"tr",align:null},"Local development"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"authentication_method: cli")," (run ",(0,n.yg)("inlineCode",{parentName:"td"},"az login")," first)")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"DefaultAzureCredential")),(0,n.yg)("td",{parentName:"tr",align:null},"Flexible environments"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"authentication_method: default"))))),(0,n.yg)("p",null,"For service principal setup, see ",(0,n.yg)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/entra/identity-platform/quickstart-register-app"},"Register an application with Microsoft Entra ID"),"."),(0,n.yg)("h3",{id:"required-permissions"},"Required Permissions"),(0,n.yg)("p",null,"The connector only performs ",(0,n.yg)("strong",{parentName:"p"},"read operations"),". Grant one of the following:"),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Option 1: Built-in Reader Role")," (recommended)"),(0,n.yg)("p",null,"Assign the ",(0,n.yg)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#reader"},"Reader")," role at subscription, resource group, or Data Factory level."),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Option 2: Custom Role with Minimal Permissions")),(0,n.yg)("p",null,"Download ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/datahub-project/datahub/blob/master/docs/generated/ingestion/sources/datahub-adf-reader-role.json"},(0,n.yg)("inlineCode",{parentName:"a"},"datahub-adf-reader-role.json")),", update the ",(0,n.yg)("inlineCode",{parentName:"p"},"{subscription-id}"),", then:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},'# Create custom role\naz role definition create --role-definition datahub-adf-reader-role.json\n\n# Assign to service principal\naz role assignment create \\\n  --assignee <service-principal-id> \\\n  --role "DataHub ADF Reader" \\\n  --scope /subscriptions/{subscription-id}\n')),(0,n.yg)("p",null,"For detailed instructions, see ",(0,n.yg)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/azure/role-based-access-control/custom-roles"},"Azure custom roles"),"."),(0,n.yg)("h2",{id:"lineage-extraction"},"Lineage Extraction"),(0,n.yg)("h3",{id:"which-activities-produce-lineage"},"Which Activities Produce Lineage?"),(0,n.yg)("p",null,"The connector extracts ",(0,n.yg)("strong",{parentName:"p"},"table-level lineage")," from these ADF activity types:"),(0,n.yg)("table",null,(0,n.yg)("thead",{parentName:"table"},(0,n.yg)("tr",{parentName:"thead"},(0,n.yg)("th",{parentName:"tr",align:null},"Activity Type"),(0,n.yg)("th",{parentName:"tr",align:null},"Lineage Behavior"))),(0,n.yg)("tbody",{parentName:"table"},(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"Copy Activity")),(0,n.yg)("td",{parentName:"tr",align:null},"Creates lineage from input dataset(s) to output dataset")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"Data Flow")),(0,n.yg)("td",{parentName:"tr",align:null},"Extracts sources, sinks, and transformation script")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"Lookup Activity")),(0,n.yg)("td",{parentName:"tr",align:null},"Creates input lineage from the lookup dataset")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"ExecutePipeline")),(0,n.yg)("td",{parentName:"tr",align:null},"Creates pipeline-to-pipeline lineage to the child pipeline")))),(0,n.yg)("p",null,"Lineage is enabled by default (",(0,n.yg)("inlineCode",{parentName:"p"},"include_lineage: true"),")."),(0,n.yg)("h3",{id:"how-lineage-resolution-works"},"How Lineage Resolution Works"),(0,n.yg)("p",null,"For lineage to connect properly to datasets ingested from other sources (e.g., Snowflake, BigQuery), the connector needs to know which DataHub platform each ADF linked service corresponds to."),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Step 1: Automatic Platform Mapping")),(0,n.yg)("p",null,"The connector automatically maps ADF linked service types to DataHub platforms. For example, a ",(0,n.yg)("inlineCode",{parentName:"p"},"Snowflake")," linked service maps to the ",(0,n.yg)("inlineCode",{parentName:"p"},"snowflake")," platform."),(0,n.yg)("details",null,(0,n.yg)("summary",null,"View all supported linked service mappings"),(0,n.yg)("table",null,(0,n.yg)("thead",{parentName:"table"},(0,n.yg)("tr",{parentName:"thead"},(0,n.yg)("th",{parentName:"tr",align:null},"ADF Linked Service Type"),(0,n.yg)("th",{parentName:"tr",align:null},"DataHub Platform"))),(0,n.yg)("tbody",{parentName:"table"},(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"AzureBlobStorage"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"abs"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"AzureBlobFS"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"abs"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"AzureDataLakeStore"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"abs"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"AzureFileStorage"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"abs"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"AzureSqlDatabase"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"mssql"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"AzureSqlDW"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"mssql"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"AzureSynapseAnalytics"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"mssql"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"AzureSqlMI"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"mssql"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"SqlServer"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"mssql"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"AzureDatabricks"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"databricks"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"AzureDatabricksDeltaLake"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"databricks"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"AmazonS3"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"s3"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"AmazonS3Compatible"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"s3"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"AmazonRedshift"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"redshift"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"GoogleCloudStorage"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"gcs"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"GoogleBigQuery"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"bigquery"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Snowflake"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"snowflake"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"PostgreSql"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"postgres"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"AzurePostgreSql"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"postgres"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"MySql"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"mysql"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"AzureMySql"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"mysql"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Oracle"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"oracle"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"OracleServiceCloud"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"oracle"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Db2"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"db2"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Teradata"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"teradata"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Vertica"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"vertica"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Hive"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"hive"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Spark"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"spark"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Hdfs"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"hdfs"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Salesforce"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"salesforce"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"SalesforceServiceCloud"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"salesforce"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"SalesforceMarketingCloud"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"salesforce"))))),(0,n.yg)("p",null,"Unsupported linked service types log a warning and skip lineage for that dataset.")),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Step 2: Platform Instance Mapping (for cross-recipe lineage)")),(0,n.yg)("p",null,"If you're ingesting the same data sources with other DataHub connectors (e.g., Snowflake, BigQuery), you need to ensure the ",(0,n.yg)("inlineCode",{parentName:"p"},"platform_instance")," values match. Use ",(0,n.yg)("inlineCode",{parentName:"p"},"platform_instance_map")," to map your ADF linked service names to the platform instance used in your other recipes:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-yaml"},'# ADF Recipe\nsource:\n  type: azure-data-factory\n  config:\n    subscription_id: ${AZURE_SUBSCRIPTION_ID}\n    platform_instance_map:\n      # Key: Your ADF linked service name (exact match required)\n      # Value: The platform_instance from your other source recipe\n      "snowflake-prod-connection": "prod_warehouse"\n      "bigquery-analytics": "analytics_project"\n')),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-yaml"},'# Corresponding Snowflake Recipe (platform_instance must match)\nsource:\n  type: snowflake\n  config:\n    platform_instance: "prod_warehouse" # Must match the value in platform_instance_map\n    # ... other config\n')),(0,n.yg)("p",null,"Without matching ",(0,n.yg)("inlineCode",{parentName:"p"},"platform_instance")," values, lineage will create separate dataset entities instead of connecting to your existing ingested datasets."),(0,n.yg)("h3",{id:"data-flow-transformation-scripts"},"Data Flow Transformation Scripts"),(0,n.yg)("p",null,"For Data Flow activities, the connector extracts the transformation script and stores it in the ",(0,n.yg)("inlineCode",{parentName:"p"},"dataTransformLogic")," aspect, visible in the DataHub UI under activity details."),(0,n.yg)("h3",{id:"column-level-lineage"},"Column-Level Lineage"),(0,n.yg)("p",null,"The connector extracts ",(0,n.yg)("strong",{parentName:"p"},"column-level lineage")," from Copy activities, enabled by default (",(0,n.yg)("inlineCode",{parentName:"p"},"include_column_lineage: true"),")."),(0,n.yg)("h4",{id:"supported-mapping-formats"},"Supported Mapping Formats"),(0,n.yg)("table",null,(0,n.yg)("thead",{parentName:"table"},(0,n.yg)("tr",{parentName:"thead"},(0,n.yg)("th",{parentName:"tr",align:null},"Format"),(0,n.yg)("th",{parentName:"tr",align:null},"Description"),(0,n.yg)("th",{parentName:"tr",align:null},"ADF Configuration"))),(0,n.yg)("tbody",{parentName:"table"},(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"Dictionary Format")),(0,n.yg)("td",{parentName:"tr",align:null},"Legacy format with direct source-to-sink column mapping"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},'translator.columnMappings: {"src_col": "sink_col"}'))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"List Format")),(0,n.yg)("td",{parentName:"tr",align:null},"Current format with structured source/sink objects"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("inlineCode",{parentName:"td"},"translator.mappings: [{source: {name}, sink: {name}}]"))),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"Auto-mapping")),(0,n.yg)("td",{parentName:"tr",align:null},"Inferred 1:1 mappings when no explicit mappings and source schema available"),(0,n.yg)("td",{parentName:"tr",align:null},"TabularTranslator with no columnMappings or mappings")))),(0,n.yg)("h4",{id:"limitations"},"Limitations"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Copy Activity Only"),": Column lineage is currently extracted only from Copy activities. Other activity types (Data Flow, Lookup, etc.) produce table-level lineage only."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("strong",{parentName:"li"},"Schema Availability"),": Auto-mapping inference requires source dataset schema information (defined in ADF dataset's ",(0,n.yg)("inlineCode",{parentName:"li"},"schema")," or ",(0,n.yg)("inlineCode",{parentName:"li"},"structure")," property). If schema is unavailable, only explicit mappings are extracted.")),(0,n.yg)("h2",{id:"execution-history"},"Execution History"),(0,n.yg)("p",null,"Pipeline runs are extracted as ",(0,n.yg)("inlineCode",{parentName:"p"},"DataProcessInstance")," entities by default:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-yaml"},"source:\n  type: azure-data-factory\n  config:\n    include_execution_history: true # default\n    execution_history_days: 7 # 1-90 days\n")),(0,n.yg)("p",null,"This provides run status, duration, timestamps, trigger info, parameters, and activity-level details."),(0,n.yg)("h2",{id:"advanced-multi-environment-setup"},"Advanced: Multi-Environment Setup"),(0,n.yg)("h3",{id:"when-to-use-platform_instance"},"When to Use ",(0,n.yg)("inlineCode",{parentName:"h3"},"platform_instance")),(0,n.yg)("p",null,"Use the ADF connector's ",(0,n.yg)("inlineCode",{parentName:"p"},"platform_instance")," config to distinguish ",(0,n.yg)("strong",{parentName:"p"},"separate ADF deployments")," when ingesting from multiple subscriptions or tenants:"),(0,n.yg)("table",null,(0,n.yg)("thead",{parentName:"table"},(0,n.yg)("tr",{parentName:"thead"},(0,n.yg)("th",{parentName:"tr",align:null},"Scenario"),(0,n.yg)("th",{parentName:"tr",align:null},"Risk"),(0,n.yg)("th",{parentName:"tr",align:null},"Solution"))),(0,n.yg)("tbody",{parentName:"table"},(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Single subscription"),(0,n.yg)("td",{parentName:"tr",align:null},"None"),(0,n.yg)("td",{parentName:"tr",align:null},"Not needed")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Multiple subscriptions"),(0,n.yg)("td",{parentName:"tr",align:null},"Low"),(0,n.yg)("td",{parentName:"tr",align:null},"Recommended")),(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:null},"Multiple tenants"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"High")," - name collision risk"),(0,n.yg)("td",{parentName:"tr",align:null},(0,n.yg)("strong",{parentName:"td"},"Required"))))),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-yaml"},'# Multi-tenant example\nsource:\n  type: azure-data-factory\n  config:\n    subscription_id: "tenant-a-sub"\n    platform_instance: "tenant-a" # Prevents URN collisions\n')),(0,n.yg)("admonition",{type:"warning"},(0,n.yg)("p",{parentName:"admonition"},"Factory names are unique within Azure, but different tenants could have identically-named factories. Use ",(0,n.yg)("inlineCode",{parentName:"p"},"platform_instance")," to prevent entity overwrites.")),(0,n.yg)("h3",{id:"urn-format"},"URN Format"),(0,n.yg)("p",null,"Pipeline URNs follow this format:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre"},"urn:li:dataFlow:(azure-data-factory,{factory_name}.{pipeline_name},{env})\n")),(0,n.yg)("p",null,"With ",(0,n.yg)("inlineCode",{parentName:"p"},"platform_instance"),":"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre"},"urn:li:dataFlow:(azure-data-factory,{platform_instance}.{factory_name}.{pipeline_name},{env})\n")),(0,n.yg)("p",null,"For Azure naming rules, see ",(0,n.yg)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/azure/data-factory/naming-rules"},"Azure Data Factory naming rules"),"."),(0,n.yg)("h3",{id:"cli-based-ingestion"},"CLI based Ingestion"),(0,n.yg)("h3",{id:"starter-recipe"},"Starter Recipe"),(0,n.yg)("p",null,"Check out the following recipe to get started with ingestion! See ",(0,n.yg)("a",{parentName:"p",href:"#config-details"},"below")," for full configuration options."),(0,n.yg)("p",null,"For general pointers on writing and running a recipe, see our ",(0,n.yg)("a",{parentName:"p",href:"/docs/metadata-ingestion#recipes"},"main recipe guide"),"."),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-yaml"},'# Example recipe for Azure Data Factory source\n# See README.md for full configuration options\n\nsource:\n  type: azure-data-factory\n  config:\n    # Required: Azure subscription containing Data Factories\n    subscription_id: ${AZURE_SUBSCRIPTION_ID}\n    \n    # Optional: Filter to specific resource group\n    # resource_group: my-resource-group\n    \n    # Authentication (using service principal)\n    credential:\n      authentication_method: service_principal\n      client_id: ${AZURE_CLIENT_ID}\n      client_secret: ${AZURE_CLIENT_SECRET}\n      tenant_id: ${AZURE_TENANT_ID}\n    \n    # Optional: Filter factories by name pattern\n    factory_pattern:\n      allow:\n        - ".*"  # Allow all factories by default\n      deny: []\n    \n    # Optional: Filter pipelines by name pattern\n    pipeline_pattern:\n      allow:\n        - ".*"  # Allow all pipelines by default\n      deny: []\n    \n    # Feature flags\n    include_lineage: true\n    include_column_lineage: false  # Advanced: requires Data Flow parsing\n    include_execution_history: false  # Set to true for pipeline run history\n    execution_history_days: 7  # Only used when include_execution_history is true\n    \n    # Optional: Map linked services to platform instances for accurate lineage\n    # platform_instance_map:\n    #   "my-snowflake-connection": "prod_snowflake"\n    \n    # Optional: Platform instance for this ADF connector\n    # platform_instance: "main-adf"\n    \n    # Environment\n    env: PROD\n    \n    # Optional: Stateful ingestion for stale entity removal\n    # stateful_ingestion:\n    #   enabled: true\n\nsink:\n  type: datahub-rest\n  config:\n    server: "http://localhost:8080"\n\n\n')),(0,n.yg)("h3",{id:"code-coordinates"},"Code Coordinates"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"Class Name: ",(0,n.yg)("inlineCode",{parentName:"li"},"datahub.ingestion.source.azure_data_factory.adf_source.AzureDataFactorySource"))),(0,n.yg)("h2",null,"Questions"),(0,n.yg)("p",null,"If you've got any questions on configuring ingestion for Azure Data Factory, feel free to ping us on ",(0,n.yg)("a",{parentName:"p",href:"https://datahub.com/slack"},"our Slack"),"."))}m.isMDXComponent=!0}}]);