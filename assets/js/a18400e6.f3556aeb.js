"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[53828],{15680:(e,t,n)=>{n.d(t,{xA:()=>s,yg:()=>y});var a=n(96540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=a.createContext({}),d=function(e){var t=a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},s=function(e){var t=d(e.components);return a.createElement(u.Provider,{value:t},e.children)},g="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,u=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),g=d(n),c=r,y=g["".concat(u,".").concat(c)]||g[c]||p[c]||l;return n?a.createElement(y,o(o({ref:t},s),{},{components:n})):a.createElement(y,o({ref:t},s))}));function y(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,o=new Array(l);o[0]=c;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i[g]="string"==typeof e?e:r,o[1]=i;for(var d=2;d<l;d++)o[d]=n[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},7554:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>u,default:()=>y,frontMatter:()=>i,metadata:()=>d,toc:()=>g});n(96540);var a=n(15680);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const i={title:"Snowflake Agent Setup for DataHub",slug:"/datahub-agent-context/src/datahub_agent_context/snowflake",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/datahub-agent-context/src/datahub_agent_context/snowflake/README.md"},u="Snowflake Agent Setup for DataHub",d={unversionedId:"datahub-agent-context/src/datahub_agent_context/snowflake/README",id:"datahub-agent-context/src/datahub_agent_context/snowflake/README",title:"Snowflake Agent Setup for DataHub",description:"This module provides tools to generate and deploy Snowflake UDFs (User-Defined Functions) that enable Snowflake Cortex Intelligence to query DataHub metadata.",source:"@site/genDocs/datahub-agent-context/src/datahub_agent_context/snowflake/README.md",sourceDirName:"datahub-agent-context/src/datahub_agent_context/snowflake",slug:"/datahub-agent-context/src/datahub_agent_context/snowflake",permalink:"/docs/datahub-agent-context/src/datahub_agent_context/snowflake",draft:!1,editUrl:"https://github.com/datahub-project/datahub/blob/master/datahub-agent-context/src/datahub_agent_context/snowflake/README.md",tags:[],version:"current",frontMatter:{title:"Snowflake Agent Setup for DataHub",slug:"/datahub-agent-context/src/datahub_agent_context/snowflake",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/datahub-agent-context/src/datahub_agent_context/snowflake/README.md"}},s={},g=[{value:"Overview",id:"overview",level:2},{value:"Implementation",id:"implementation",level:2},{value:"Usage",id:"usage",level:2},{value:"Basic Usage",id:"basic-usage",level:3},{value:"Direct Execution",id:"direct-execution",level:3},{value:"Direct Execution with SSO",id:"direct-execution-with-sso",level:3},{value:"Options",id:"options",level:2},{value:"Authentication Methods",id:"authentication-methods",level:2},{value:"1. Password Authentication (Default)",id:"1-password-authentication-default",level:3},{value:"2. SSO / External Browser Authentication (Recommended)",id:"2-sso--external-browser-authentication-recommended",level:3},{value:"3. OAuth Authentication",id:"3-oauth-authentication",level:3},{value:"Read-Only vs Read+Write Modes",id:"read-only-vs-readwrite-modes",level:2},{value:"Generated Files",id:"generated-files",level:2},{value:"Manual Execution",id:"manual-execution",level:2},{value:"Related Documentation",id:"related-documentation",level:2}],p={toc:g},c="wrapper";function y(e){var{components:t}=e,n=o(e,["components"]);return(0,a.yg)(c,l(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){r(e,t,n[t])}))}return e}({},p,n),{components:t,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"snowflake-agent-setup-for-datahub"},"Snowflake Agent Setup for DataHub"),(0,a.yg)("p",null,"This module provides tools to generate and deploy Snowflake UDFs (User-Defined Functions) that enable Snowflake Cortex Intelligence to query DataHub metadata."),(0,a.yg)("h2",{id:"overview"},"Overview"),(0,a.yg)("p",null,"The module generates SQL scripts to create:"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Network rules and external access integrations for DataHub API calls"),(0,a.yg)("li",{parentName:"ol"},"Python UDFs for searching and retrieving metadata from DataHub"),(0,a.yg)("li",{parentName:"ol"},"Stored procedures for dynamic SQL execution"),(0,a.yg)("li",{parentName:"ol"},"Cortex Agent configuration with DataHub tools")),(0,a.yg)("h2",{id:"implementation"},"Implementation"),(0,a.yg)("p",null,"UDFs use the ",(0,a.yg)("inlineCode",{parentName:"p"},"datahub-agent-context")," package wrapper methods that abstract away GraphQL/REST API complexity."),(0,a.yg)("h2",{id:"usage"},"Usage"),(0,a.yg)("h3",{id:"basic-usage"},"Basic Usage"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"python -m datahub.ai.snowflake.snowflake \\\n  --sf-account YOUR_ACCOUNT \\\n  --sf-user YOUR_USER \\\n  --sf-role YOUR_ROLE \\\n  --sf-warehouse YOUR_WAREHOUSE \\\n  --sf-database YOUR_DATABASE \\\n  --sf-schema YOUR_SCHEMA \\\n  --datahub-url https://your-datahub.acryl.io \\\n  --datahub-token YOUR_TOKEN \\\n  --enable-mutations\n")),(0,a.yg)("h3",{id:"direct-execution"},"Direct Execution"),(0,a.yg)("p",null,"Add ",(0,a.yg)("inlineCode",{parentName:"p"},"--execute")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"--sf-password")," to automatically run the generated scripts:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"python -m datahub.ai.snowflake.snowflake \\\n  --sf-account YOUR_ACCOUNT \\\n  --sf-user YOUR_USER \\\n  --sf-password YOUR_PASSWORD \\\n  --sf-role YOUR_ROLE \\\n  --sf-warehouse YOUR_WAREHOUSE \\\n  --sf-database YOUR_DATABASE \\\n  --sf-schema YOUR_SCHEMA \\\n  --datahub-url https://your-datahub.acryl.io \\\n  --datahub-token YOUR_TOKEN \\\n  --enable-mutations \\\n  --execute\n")),(0,a.yg)("h3",{id:"direct-execution-with-sso"},"Direct Execution with SSO"),(0,a.yg)("p",null,"Use ",(0,a.yg)("inlineCode",{parentName:"p"},"--sf-authenticator=externalbrowser")," for SSO authentication (no password required):"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"python -m datahub.ai.snowflake.snowflake \\\n  --sf-account YOUR_ACCOUNT \\\n  --sf-user YOUR_USER \\\n  --sf-authenticator externalbrowser \\\n  --sf-role YOUR_ROLE \\\n  --sf-warehouse YOUR_WAREHOUSE \\\n  --sf-database YOUR_DATABASE \\\n  --sf-schema YOUR_SCHEMA \\\n  --datahub-url https://your-datahub.acryl.io \\\n  --datahub-token YOUR_TOKEN \\\n  --enable-mutations \\\n  --execute\n")),(0,a.yg)("p",null,"This will open your browser for SSO authentication. Ideal for organizations using SAML, Okta, or other identity providers configured with Snowflake."),(0,a.yg)("h2",{id:"options"},"Options"),(0,a.yg)("table",null,(0,a.yg)("thead",{parentName:"table"},(0,a.yg)("tr",{parentName:"thead"},(0,a.yg)("th",{parentName:"tr",align:null},"Option"),(0,a.yg)("th",{parentName:"tr",align:null},"Description"),(0,a.yg)("th",{parentName:"tr",align:null},"Default"))),(0,a.yg)("tbody",{parentName:"table"},(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"--sf-account")),(0,a.yg)("td",{parentName:"tr",align:null},"Snowflake account identifier"),(0,a.yg)("td",{parentName:"tr",align:null},"Required")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"--sf-user")),(0,a.yg)("td",{parentName:"tr",align:null},"Snowflake user name"),(0,a.yg)("td",{parentName:"tr",align:null},"Required")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"--sf-role")),(0,a.yg)("td",{parentName:"tr",align:null},"Snowflake role"),(0,a.yg)("td",{parentName:"tr",align:null},"Required")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"--sf-warehouse")),(0,a.yg)("td",{parentName:"tr",align:null},"Snowflake warehouse name"),(0,a.yg)("td",{parentName:"tr",align:null},"Required")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"--sf-database")),(0,a.yg)("td",{parentName:"tr",align:null},"Snowflake database name"),(0,a.yg)("td",{parentName:"tr",align:null},"Required")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"--sf-schema")),(0,a.yg)("td",{parentName:"tr",align:null},"Snowflake schema name"),(0,a.yg)("td",{parentName:"tr",align:null},"Required")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"--datahub-url")),(0,a.yg)("td",{parentName:"tr",align:null},"DataHub instance URL"),(0,a.yg)("td",{parentName:"tr",align:null},"Required")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"--datahub-token")),(0,a.yg)("td",{parentName:"tr",align:null},"DataHub Personal Access Token"),(0,a.yg)("td",{parentName:"tr",align:null},"Required")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"--agent-name")),(0,a.yg)("td",{parentName:"tr",align:null},"Agent name in Snowflake"),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"DATAHUB_SQL_AGENT"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"--agent-display-name")),(0,a.yg)("td",{parentName:"tr",align:null},"Agent display name in UI"),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"DataHub SQL Assistant"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"--agent-color")),(0,a.yg)("td",{parentName:"tr",align:null},"Agent color in UI"),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"blue"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"--output-dir")),(0,a.yg)("td",{parentName:"tr",align:null},"Output directory for SQL files"),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"./snowflake_setup"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"--enable-mutations")),(0,a.yg)("td",{parentName:"tr",align:null},"Include mutation/write tools (tags, descriptions, owners, etc.)"),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"True")," (enabled)")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"--no-enable-mutations")),(0,a.yg)("td",{parentName:"tr",align:null},"Disable mutation tools (read-only mode with 9 UDFs instead of 20)"),(0,a.yg)("td",{parentName:"tr",align:null},"N/A")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"--execute")),(0,a.yg)("td",{parentName:"tr",align:null},"Execute scripts directly"),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"False"))),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"--sf-password")),(0,a.yg)("td",{parentName:"tr",align:null},"Snowflake password (required if --execute is used with ",(0,a.yg)("inlineCode",{parentName:"td"},"snowflake")," authenticator)"),(0,a.yg)("td",{parentName:"tr",align:null},"None")),(0,a.yg)("tr",{parentName:"tbody"},(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"--sf-authenticator")),(0,a.yg)("td",{parentName:"tr",align:null},"Authentication method: ",(0,a.yg)("inlineCode",{parentName:"td"},"snowflake")," (password), ",(0,a.yg)("inlineCode",{parentName:"td"},"externalbrowser")," (SSO), or ",(0,a.yg)("inlineCode",{parentName:"td"},"oauth")," (token-based)"),(0,a.yg)("td",{parentName:"tr",align:null},(0,a.yg)("inlineCode",{parentName:"td"},"snowflake"))))),(0,a.yg)("h2",{id:"authentication-methods"},"Authentication Methods"),(0,a.yg)("p",null,"Three authentication methods are supported when using ",(0,a.yg)("inlineCode",{parentName:"p"},"--execute"),":"),(0,a.yg)("h3",{id:"1-password-authentication-default"},"1. Password Authentication (Default)"),(0,a.yg)("p",null,"Standard username/password authentication:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"--execute --sf-password YOUR_PASSWORD\n")),(0,a.yg)("h3",{id:"2-sso--external-browser-authentication-recommended"},"2. SSO / External Browser Authentication (Recommended)"),(0,a.yg)("p",null,"Browser-based SSO authentication (SAML, Okta, Azure AD, etc.):"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"--execute --sf-authenticator externalbrowser\n")),(0,a.yg)("p",null,"When using this method:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"A browser window will automatically open for authentication"),(0,a.yg)("li",{parentName:"ul"},"No password is required on the command line"),(0,a.yg)("li",{parentName:"ul"},"Ideal for organizations with federated identity providers"),(0,a.yg)("li",{parentName:"ul"},"Your Snowflake account must be configured for SSO")),(0,a.yg)("h3",{id:"3-oauth-authentication"},"3. OAuth Authentication"),(0,a.yg)("p",null,"Token-based OAuth authentication:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"--execute --sf-authenticator oauth\n")),(0,a.yg)("p",null,"Note: OAuth authentication requires additional token configuration in your environment."),(0,a.yg)("h2",{id:"read-only-vs-readwrite-modes"},"Read-Only vs Read+Write Modes"),(0,a.yg)("p",null,"By default, the generator creates 20 UDFs including both read and write operations:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Read-only tools (9 UDFs)"),": Search, retrieve metadata, lineage, queries, documents"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"Mutation tools (11 UDFs)"),": Add/remove tags, update descriptions, manage owners, domains, glossary terms, and structured properties")),(0,a.yg)("p",null,"Use ",(0,a.yg)("inlineCode",{parentName:"p"},"--no-enable-mutations")," to generate only the 9 read-only UDFs for environments where metadata modifications should be restricted."),(0,a.yg)("h2",{id:"generated-files"},"Generated Files"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"00_configuration.sql")," - Configuration variables and secrets"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"01_network_rules.sql")," - Network rules and external access integration"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"02_datahub_udfs.sql")," - DataHub API UDFs (9 read-only or 20 read+write depending on ",(0,a.yg)("inlineCode",{parentName:"li"},"--enable-mutations"),")"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"03_stored_procedure.sql")," - Dynamic SQL execution procedure"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"04_cortex_agent.sql")," - Cortex Agent definition")),(0,a.yg)("h2",{id:"manual-execution"},"Manual Execution"),(0,a.yg)("p",null,"If not using ",(0,a.yg)("inlineCode",{parentName:"p"},"--execute"),", run the generated SQL files in order:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-sql"},"-- 1. Set up configuration and secrets\n@00_configuration.sql;\n\n-- 2. Create network rules\n@01_network_rules.sql;\n\n-- 3. Create DataHub UDFs\n@02_datahub_udfs.sql;\n\n-- 4. Create stored procedure\n@03_stored_procedure.sql;\n\n-- 5. Create Cortex Agent\n@04_cortex_agent.sql;\n")),(0,a.yg)("h2",{id:"related-documentation"},"Related Documentation"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"/docs/datahub-agent-context"},"DataHub Agent Context Documentation")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"https://docs.snowflake.com/en/developer-guide/udf/python/udf-python"},"Snowflake Python UDFs")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"https://docs.snowflake.com/en/user-guide/snowflake-cortex/cortex-intelligence"},"Snowflake Cortex Intelligence"))))}y.isMDXComponent=!0}}]);