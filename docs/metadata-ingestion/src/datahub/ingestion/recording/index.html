<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-metadata-ingestion/src/datahub/ingestion/recording/README" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Ingestion Recording and Replay | DataHub</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.datahub.com/docs/metadata-ingestion/src/datahub/ingestion/recording"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Ingestion Recording and Replay | DataHub"><meta data-rh="true" name="description" content="Beta Feature: Recording and replay is currently in beta. The feature is stable for debugging purposes but the archive format may change in future releases."><meta data-rh="true" property="og:description" content="Beta Feature: Recording and replay is currently in beta. The feature is stable for debugging purposes but the archive format may change in future releases."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.datahub.com/docs/metadata-ingestion/src/datahub/ingestion/recording"><link data-rh="true" rel="alternate" href="https://docs.datahub.com/docs/metadata-ingestion/src/datahub/ingestion/recording" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.datahub.com/docs/metadata-ingestion/src/datahub/ingestion/recording" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://RK0UG797F3-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/learn/rss.xml" title="DataHub RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/learn/atom.xml" title="DataHub Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H5QDNJNMHY"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-H5QDNJNMHY",{})</script>
<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-5M8T9HNN",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>


<link rel="search" type="application/opensearchdescription+xml" title="DataHub" href="/opensearch.xml">




<meta httpequiv="Content-Security-Policy" content="frame-ancestors &#39;self&#39; https://*.acryl.io https://acryldata.io http://localhost:*">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;700&display=swap">
<script src="https://tools.luckyorange.com/core/lo.js?site-id=28ea8a38" async defer="defer"></script>
<script src="/scripts/rb2b.js" async defer="defer"></script>
<script src="https://app.revenuehero.io/scheduler.min.js"></script>
<script src="https://tag.clearbitscripts.com/v1/pk_2e321cabe30432a5c44c0424781aa35f/tags.js" referrerpolicy="strict-origin-when-cross-origin"></script>
<script src="/scripts/reo.js"></script>
<script id="runllm-widget-script" type="module" src="https://widget.runllm.com" crossorigin="true" runllm-name="DataHub" runllm-assistant-id="81" runllm-position="BOTTOM_RIGHT" runllm-keyboard-shortcut="Mod+j" runllm-preset="docusaurus" runllm-theme-color="#1890FF" runllm-brand-logo="https://docs.datahub.com/img/datahub-logo-color-mark.svg" runllm-community-url="https://datahub.com/slack" runllm-community-type="slack" runllm-disable-ask-a-person="true" async></script><link rel="stylesheet" href="/assets/css/styles.d30462d6.css">
<link rel="preload" href="/assets/js/runtime~main.07d6be07.js" as="script">
<link rel="preload" href="/assets/js/main.561472ac.js" as="script">
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5M8T9HNN" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:transparent;color:#ffffff" role="banner"><div class="content_knG7 announcementBarContent_xLdY"><div class="shimmer-banner"><span>February Town Hall 2/26</span><a href="https://luma.com/zp3h4ex8?utm_term=docs" target="_blank" class="button"><div>Register Here<span> →</span></div></a></div></div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://datahub.com" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/datahub-logo-color-light-horizontal.svg" alt="DataHub Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/datahub-logo-color-dark-horizontal.svg" alt="DataHub Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link versionNavItem_cbn8">1.4.0</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/metadata-ingestion/src/datahub/ingestion/recording">1.4.0</a></li><li><hr class="dropdown-separator" style="margin: 0.4rem;"></li><li><div class="dropdown__link"><b>Archived versions</b></div></li><li>
                     <a class="dropdown__link" href="https://docs-website-t9sv4w3gr-acryldata.vercel.app/docs/features">1.0.0
                     <svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg>
                     </a>
                     </li><li>
                     <a class="dropdown__link" href="https://docs-website-t9sv4w3gr-acryldata.vercel.app/docs/0.15.0/features">0.15.0
                     <svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg>
                     </a>
                     </li><li>
                     <a class="dropdown__link" href="https://docs-website-8jkm4uler-acryldata.vercel.app/docs/0.14.1/features">0.14.1
                     <svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg>
                     </a>
                     </li><li>
                     <a class="dropdown__link" href="https://docs-website-eue2qafvn-acryldata.vercel.app/docs/features">0.14.0
                     <svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg>
                     </a>
                     </li><li>
                   <a class="dropdown__link" href="https://docs-website-psat3nzgi-acryldata.vercel.app/docs/features">0.13.1
                   <svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg>
                   </a>
                   </li><li>
                     <a class="dropdown__link" href="https://docs-website-lzxh86531-acryldata.vercel.app/docs/features">0.13.0
                     <svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg>
                     </a>
                     </li><li>
                   <a class="dropdown__link" href="https://docs-website-2uuxmgza2-acryldata.vercel.app/docs/features">0.12.1
                   <svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg>
                   </a>
                   </li><li>
                   <a class="dropdown__link" href="https://docs-website-irpoe2osc-acryldata.vercel.app/docs/features">0.11.0
                   <svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg>
                   </a>
                   </li><li>
                   <a class="dropdown__link" href="https://docs-website-1gv2yzn9d-acryldata.vercel.app/docs/features">0.10.5
                   <svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg>
                   </a>
                   </li></ul></div></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" href="/integrations">Integrations</a><a href="https://datahub.com/slack?utm_source=docs&amp;utm_medium=header&amp;utm_campaign=docs_header" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">
            <style>
              .slack-logo:hover {
                opacity: 0.8;
              }
            </style>
            <img class="slack-logo" src="https://upload.wikimedia.org/wikipedia/commons/d/d5/Slack_icon_2019.svg" , alt="slack" , height="20px" style="margin: 10px 0 0 0;">
          </a><a href="https://github.com/datahub-project/datahub" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">
            <style>
              .github-logo:hover {
                opacity: 0.8;
              }
            </style>
            <img class="github-logo" src="https://upload.wikimedia.org/wikipedia/commons/9/91/Octicons-mark-github.svg" , alt="slack" , height="20px" style="margin: 10px 0 0 0;">
          </a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Ingestion Recording and Replay</h1><blockquote><p><strong>Beta Feature</strong>: Recording and replay is currently in beta. The feature is stable for debugging purposes but the archive format may change in future releases.</p></blockquote><p>Debug ingestion issues by capturing all external I/O (HTTP requests and database queries) during ingestion runs, then replaying them locally in an air-gapped environment with full debugger support.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><p>The recording system captures:</p><ul><li><strong>HTTP Traffic</strong>: All requests to external APIs (Looker, PowerBI, Snowflake REST, etc.) and DataHub GMS</li><li><strong>Database Queries</strong>: SQL queries and results from native database connectors (Snowflake, Redshift, BigQuery, Databricks, etc.)</li></ul><p>Recordings are stored in encrypted, compressed archives that can be replayed offline to reproduce issues exactly as they occurred in production.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="comparing-recording-and-replay-output">Comparing Recording and Replay Output<a href="#comparing-recording-and-replay-output" class="hash-link" aria-label="Direct link to Comparing Recording and Replay Output" title="Direct link to Comparing Recording and Replay Output">​</a></h3><p>The recorded and replayed MCPs are <strong>semantically identical</strong> - they contain the same source data. However, certain metadata fields will differ because they reflect <em>when</em> MCPs are emitted, not the source data itself:</p><ul><li><code>systemMetadata.lastObserved</code> - timestamp of MCP emission</li><li><code>systemMetadata.runId</code> - unique run identifier</li><li><code>auditStamp.time</code> - audit timestamp</li></ul><p>Use <code>datahub check metadata-diff</code> to compare recordings semantically:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Compare MCPs ignoring system metadata</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub check metadata-diff </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --ignore-path </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;root[&#x27;*&#x27;][&#x27;systemMetadata&#x27;][&#x27;lastObserved&#x27;]&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --ignore-path </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;root[&#x27;*&#x27;][&#x27;systemMetadata&#x27;][&#x27;runId&#x27;]&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    recording_output.json replay_output.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A successful replay will show <strong>PERFECT SEMANTIC MATCH</strong> when ignoring these fields.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="installation">Installation<a href="#installation" class="hash-link" aria-label="Direct link to Installation" title="Direct link to Installation">​</a></h2><p>Install the optional <code>debug-recording</code> plugin:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;acryl-datahub[debug-recording]&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Or with your source connectors</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;acryl-datahub[looker,debug-recording]&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Dependencies:</strong></p><ul><li><code>vcrpy&gt;=8.0.0</code> (Python 3.10+) or <code>vcrpy&gt;=7.0.0,&lt;8.0.0</code> (Python 3.9) - HTTP recording/replay</li><li><code>pyzipper&gt;=0.3.6</code> - AES-256 encrypted archives</li></ul><p><strong>Note:</strong> The recording module uses lazy imports to avoid requiring optional dependencies (like <code>sqlalchemy</code>) when recording is not used. This means you can install the recording plugin without pulling in database connector dependencies unless you actually use them.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="quick-start">Quick Start<a href="#quick-start" class="hash-link" aria-label="Direct link to Quick Start" title="Direct link to Quick Start">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="recording-an-ingestion-run">Recording an Ingestion Run<a href="#recording-an-ingestion-run" class="hash-link" aria-label="Direct link to Recording an Ingestion Run" title="Direct link to Recording an Ingestion Run">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Record with password protection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub ingest run -c recipe.yaml --record --record-password mysecret</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Record without S3 upload (for local testing)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub ingest run -c recipe.yaml --record --record-password mysecret --no-s3-upload</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The recording creates an encrypted ZIP archive containing:</p><ul><li>HTTP cassette with all request/response pairs</li><li>Database query recordings (if applicable)</li><li>Redacted recipe (secrets replaced with safe markers)</li><li>Manifest with metadata and checksums</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="replaying-a-recording">Replaying a Recording<a href="#replaying-a-recording" class="hash-link" aria-label="Direct link to Replaying a Recording" title="Direct link to Replaying a Recording">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Replay in air-gapped mode (default) - no network required</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub ingest replay recording.zip --password mysecret</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Replay with live sink - replay source data, emit to real DataHub</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub ingest replay recording.zip --password mysecret </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --live-sink --server http://localhost:8080</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="inspecting-recordings">Inspecting Recordings<a href="#inspecting-recordings" class="hash-link" aria-label="Direct link to Inspecting Recordings" title="Direct link to Inspecting Recordings">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># View archive metadata</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub recording info recording.zip --password mysecret</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Extract archive contents</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub recording extract recording.zip --password mysecret --output-dir ./extracted</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># List contents of a recording archive</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub recording list recording.zip --password mysecret</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="recipe-configuration">Recipe Configuration<a href="#recipe-configuration" class="hash-link" aria-label="Direct link to Recipe Configuration" title="Direct link to Recipe Configuration">​</a></h3><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">source</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> looker</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ... source config ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Optional recording configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">recording</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">password</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">DATAHUB_RECORDING_PASSWORD</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Or use --record-password CLI flag</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">s3_upload</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Upload directly to S3 (default: false)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">output_path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> s3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">//my</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">bucket/recordings/ </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Required when s3_upload=true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When <code>s3_upload</code> is disabled (default), the recording is saved locally:</p><ul><li>To <code>output_path</code> if specified</li><li>To <code>INGESTION_ARTIFACT_DIR</code> directory if set</li><li>To a temp directory otherwise</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="environment-variables">Environment Variables<a href="#environment-variables" class="hash-link" aria-label="Direct link to Environment Variables" title="Direct link to Environment Variables">​</a></h3><table><thead><tr><th>Variable</th><th>Description</th></tr></thead><tbody><tr><td><code>DATAHUB_RECORDING_PASSWORD</code></td><td>Default password for recording encryption</td></tr><tr><td><code>ADMIN_PASSWORD</code></td><td>Fallback password (used in managed environments)</td></tr><tr><td><code>INGESTION_ARTIFACT_DIR</code></td><td>Directory to save recordings when S3 upload is disabled. If not set, recordings are saved to temp directory.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cli-options">CLI Options<a href="#cli-options" class="hash-link" aria-label="Direct link to CLI Options" title="Direct link to CLI Options">​</a></h3><p><strong>Recording:</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub ingest run -c recipe.yaml </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --record                    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Enable recording</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --record-password </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">pwd</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">     </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Encryption password</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --record-output-path </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">path</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Override output path (for debugging)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --no-s3-upload              </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Disable S3 upload</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --no-secret-redaction       </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Keep real credentials (for local debugging)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Or save to specific directory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">INGESTION_ARTIFACT_DIR</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/path/to/recordings</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub ingest run -c recipe.yaml --record --record-password </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">pwd</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> --no-s3-upload</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Recording saved as: /path/to/recordings/recording-{run_id}.zip</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Replay:</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub ingest replay </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">archive</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --password </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">pwd</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Decryption password</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --live-sink                 </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Enable real GMS sink</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --server </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">url</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">              </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># GMS server for live sink</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --token </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">token</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">             </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Auth token for live sink</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="archive-format">Archive Format<a href="#archive-format" class="hash-link" aria-label="Direct link to Archive Format" title="Direct link to Archive Format">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">recording-{run_id}.zip (AES-256 encrypted, LZMA compressed)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── manifest.json           # Metadata, versions, checksums</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── recipe.yaml             # Recipe with redacted secrets</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── http/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   └── cassette.yaml       # VCR HTTP recordings (YAML for binary data support)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">└── db/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    └── queries.jsonl       # Database query recordings</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="manifest-contents">Manifest Contents<a href="#manifest-contents" class="hash-link" aria-label="Direct link to Manifest Contents" title="Direct link to Manifest Contents">​</a></h3><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;format_version&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1.0.0&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;run_id&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;looker-2024-12-03-10_30_00-abc123&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;source_type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;looker&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;sink_type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;datahub-rest&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;datahub_cli_version&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0.14.0&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;python_version&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;3.10.15&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;created_at&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2024-12-03T10:35:00Z&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;recording_start_time&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2024-12-03T10:30:00Z&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;files&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;http/cassette.yaml&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;db/queries.jsonl&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;checksums&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token property">&quot;http/cassette.yaml&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;sha256:...&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;has_exception&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;exception_info&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>source_type</code>: The type of source connector (e.g., snowflake, looker, bigquery)</li><li><code>sink_type</code>: The type of sink (e.g., datahub-rest, file)</li><li><code>datahub_cli_version</code>: The DataHub CLI version used for recording</li><li><code>python_version</code>: The Python version used for recording (e.g., &quot;3.10.15&quot;)</li><li><code>recording_start_time</code>: When recording began (informational)</li><li><code>has_exception</code>: Whether the recording captured an exception</li><li><code>exception_info</code>: Stack trace and details if an exception occurred</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-use-consistent-passwords">1. Use Consistent Passwords<a href="#1-use-consistent-passwords" class="hash-link" aria-label="Direct link to 1. Use Consistent Passwords" title="Direct link to 1. Use Consistent Passwords">​</a></h3><p>Store the recording password in a secure location (secrets manager, environment variable) and use the same password across your team:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">DATAHUB_RECORDING_PASSWORD</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable" style="color:rgb(191, 199, 213)">vault </span><span class="token variable builtin class-name" style="color:rgb(255, 203, 107)">read</span><span class="token variable" style="color:rgb(191, 199, 213)"> -field</span><span class="token variable operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">password secret/datahub/recording</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub ingest run -c recipe.yaml --record</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-record-in-production-like-environments">2. Record in Production-Like Environments<a href="#2-record-in-production-like-environments" class="hash-link" aria-label="Direct link to 2. Record in Production-Like Environments" title="Direct link to 2. Record in Production-Like Environments">​</a></h3><p>For best debugging results, record in an environment that matches production:</p><ul><li>Same credentials and permissions</li><li>Same network access</li><li>Same data volume (or representative sample)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-use-descriptive-run-ids">3. Use Descriptive Run IDs<a href="#3-use-descriptive-run-ids" class="hash-link" aria-label="Direct link to 3. Use Descriptive Run IDs" title="Direct link to 3. Use Descriptive Run IDs">​</a></h3><p>The archive filename includes the run_id. Use meaningful recipe names for easy identification:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Recipe: snowflake-prod-daily.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Archive: snowflake-prod-daily-2024-12-03-10_30_00-abc123.zip</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-test-replay-immediately">4. Test Replay Immediately<a href="#4-test-replay-immediately" class="hash-link" aria-label="Direct link to 4. Test Replay Immediately" title="Direct link to 4. Test Replay Immediately">​</a></h3><p>After recording, test the replay to ensure the recording is complete:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Record (save MCP output for comparison)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub ingest run -c recipe.yaml --record --record-password </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">test</span><span class="token plain"> --no-s3-upload </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">tee</span><span class="token plain"> recording_output.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Immediately test replay (save output)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub ingest replay /tmp/recording.zip --password </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">test</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">tee</span><span class="token plain"> replay_output.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Verify semantic equivalence</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub check metadata-diff </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --ignore-path </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;root[&#x27;*&#x27;][&#x27;systemMetadata&#x27;][&#x27;lastObserved&#x27;]&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --ignore-path </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;root[&#x27;*&#x27;][&#x27;systemMetadata&#x27;][&#x27;runId&#x27;]&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    recording_output.json replay_output.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-include-exception-context">5. Include Exception Context<a href="#5-include-exception-context" class="hash-link" aria-label="Direct link to 5. Include Exception Context" title="Direct link to 5. Include Exception Context">​</a></h3><p>If recording captures an exception, the archive includes exception details:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub recording info recording.zip --password mysecret</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Output includes: has_exception: true, exception_info: {...}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-secure-archive-handling">6. Secure Archive Handling<a href="#6-secure-archive-handling" class="hash-link" aria-label="Direct link to 6. Secure Archive Handling" title="Direct link to 6. Secure Archive Handling">​</a></h3><ul><li>Never commit recordings to source control</li><li>Use strong passwords (16+ characters)</li><li>Delete recordings after debugging is complete</li><li>Use S3 lifecycle policies for automatic cleanup</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="7-minimize-recording-scope">7. Minimize Recording Scope<a href="#7-minimize-recording-scope" class="hash-link" aria-label="Direct link to 7. Minimize Recording Scope" title="Direct link to 7. Minimize Recording Scope">​</a></h3><p>For faster recordings and smaller archives, limit the scope:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">source</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> looker</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dashboard_pattern</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">allow</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;^specific-dashboard-id$&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="limitations">Limitations<a href="#limitations" class="hash-link" aria-label="Direct link to Limitations" title="Direct link to Limitations">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-thread-safe-recording-impact">1. Thread-Safe Recording Impact<a href="#1-thread-safe-recording-impact" class="hash-link" aria-label="Direct link to 1. Thread-Safe Recording Impact" title="Direct link to 1. Thread-Safe Recording Impact">​</a></h3><p>To capture all HTTP requests reliably, recording serializes HTTP calls. This has performance implications:</p><table><thead><tr><th>Scenario</th><th>Without Recording</th><th>With Recording</th></tr></thead><tbody><tr><td>Parallel API calls</td><td>~10s</td><td>~90s</td></tr><tr><td>Single-threaded</td><td>~90s</td><td>~90s</td></tr></tbody></table><p><strong>Mitigation:</strong> Recording is intended for debugging, not production. Use <code>--no-s3-upload</code> for faster local testing.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-timestamps-differ-between-runs">2. Timestamps Differ Between Runs<a href="#2-timestamps-differ-between-runs" class="hash-link" aria-label="Direct link to 2. Timestamps Differ Between Runs" title="Direct link to 2. Timestamps Differ Between Runs">​</a></h3><p>MCP metadata timestamps will always differ between recording and replay:</p><ul><li><code>systemMetadata.lastObserved</code> - set when MCP is emitted</li><li><code>systemMetadata.runId</code> - unique per run</li><li><code>auditStamp.time</code> - set during processing</li></ul><p><strong>Mitigation:</strong> The actual source data is identical. Use <code>datahub check metadata-diff</code> with <code>--ignore-path</code> to verify semantic equivalence (see &quot;Comparing Recording and Replay Output&quot; above).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-non-deterministic-source-behavior">3. Non-Deterministic Source Behavior<a href="#3-non-deterministic-source-behavior" class="hash-link" aria-label="Direct link to 3. Non-Deterministic Source Behavior" title="Direct link to 3. Non-Deterministic Source Behavior">​</a></h3><p>Some sources have non-deterministic behavior:</p><ul><li>Random sampling or ordering of results</li><li>Rate limiting/retry timing variations</li><li>Parallel processing order</li></ul><p><strong>Mitigation:</strong> The replay serves recorded API responses, so data is identical. The system includes custom VCR matchers that handle non-deterministic request ordering (e.g., Looker usage queries with varying filter orders).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-database-connection-mocking">4. Database Connection Mocking<a href="#4-database-connection-mocking" class="hash-link" aria-label="Direct link to 4. Database Connection Mocking" title="Direct link to 4. Database Connection Mocking">​</a></h3><p>Database replay mocks the connection entirely - authentication is bypassed. This means:</p><ul><li>Connection pooling behavior may differ</li><li>Transaction semantics are simplified</li><li>Cursor state is simulated</li></ul><p><strong>Mitigation:</strong> For complex database debugging, use database-specific profiling tools alongside recording.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-large-recordings">5. Large Recordings<a href="#5-large-recordings" class="hash-link" aria-label="Direct link to 5. Large Recordings" title="Direct link to 5. Large Recordings">​</a></h3><p>Recordings can be large for high-volume sources:</p><ul><li>Looker with 1000+ dashboards: ~50MB</li><li>PowerBI with many workspaces: ~100MB</li><li>Snowflake with full schema extraction: ~200MB</li></ul><p><strong>Mitigation:</strong></p><ul><li>Use patterns to limit scope</li><li>Enable LZMA compression (default)</li><li>Use S3 for storage instead of local disk</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-secret-handling">6. Secret Handling<a href="#6-secret-handling" class="hash-link" aria-label="Direct link to 6. Secret Handling" title="Direct link to 6. Secret Handling">​</a></h3><p>Secrets are redacted in the stored recipe using <code>__REPLAY_DUMMY__</code> markers. During replay:</p><ul><li>Pydantic validation receives valid dummy values</li><li>Actual API/DB calls use recorded responses (no real auth needed)</li><li>Some sources may have validation that fails with dummy values</li></ul><p><strong>Mitigation:</strong> The replay system auto-injects valid dummy values that pass common validators.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="7-http-only-for-some-sources">7. HTTP-Only for Some Sources<a href="#7-http-only-for-some-sources" class="hash-link" aria-label="Direct link to 7. HTTP-Only for Some Sources" title="Direct link to 7. HTTP-Only for Some Sources">​</a></h3><p>Sources using non-HTTP protocols cannot be fully recorded:</p><ul><li>Direct TCP/binary database protocols (partially supported via db_proxy)</li><li>gRPC (not currently supported)</li><li>WebSocket (not currently supported)</li></ul><p><strong>Mitigation:</strong> Most sources use HTTP REST APIs which are fully supported.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="8-vendored-http-libraries-snowflake-databricks">8. Vendored HTTP Libraries (Snowflake, Databricks)<a href="#8-vendored-http-libraries-snowflake-databricks" class="hash-link" aria-label="Direct link to 8. Vendored HTTP Libraries (Snowflake, Databricks)" title="Direct link to 8. Vendored HTTP Libraries (Snowflake, Databricks)">​</a></h3><p>Some database connectors use non-standard HTTP implementations:</p><ul><li><strong>Snowflake</strong>: Uses <code>snowflake.connector.vendored.urllib3</code> and <code>vendored.requests</code></li><li><strong>Databricks</strong>: Uses internal Thrift HTTP client</li></ul><p><strong>Impact:</strong> HTTP authentication calls are NOT recorded during connection setup.</p><p><strong>Why recording still works:</strong></p><ul><li>Authentication happens once during <code>connect()</code></li><li>SQL queries use standard DB-API cursors (no HTTP involved)</li><li>During replay, authentication is bypassed entirely (mock connection)</li><li>All SQL queries and results are perfectly recorded/replayed</li></ul><p><strong>What IS recorded:</strong></p><ul><li>✅ All SQL queries via <code>cursor.execute()</code></li><li>✅ All query results</li><li>✅ Cursor metadata (description, rowcount)</li></ul><p><strong>What is NOT recorded:</strong></p><ul><li>❌ HTTP authentication calls (not needed for replay)</li><li>❌ PUT/GET file operations (not used in metadata ingestion)</li></ul><p><strong>Automatic error handling:</strong>
The recording system detects when VCR interferes with connection and automatically retries with VCR bypassed. You&#x27;ll see warnings in logs but recording will succeed. SQL queries are captured normally regardless of HTTP recording status.</p><p><strong>For debugging:</strong> SQL query recordings are sufficient for all metadata extraction scenarios.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="9-stateful-ingestion">9. Stateful Ingestion<a href="#9-stateful-ingestion" class="hash-link" aria-label="Direct link to 9. Stateful Ingestion" title="Direct link to 9. Stateful Ingestion">​</a></h3><p>Stateful ingestion checkpoints may behave differently during replay:</p><ul><li>Recorded state may reference timestamps that don&#x27;t match replay time</li><li>State backend calls are mocked</li></ul><p><strong>Mitigation:</strong> For stateful debugging, record a fresh run without existing state.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="10-memory-usage">10. Memory Usage<a href="#10-memory-usage" class="hash-link" aria-label="Direct link to 10. Memory Usage" title="Direct link to 10. Memory Usage">​</a></h3><p>Large recordings are loaded into memory during replay:</p><ul><li>HTTP cassette is fully loaded</li><li>DB queries are streamed from JSONL</li></ul><p><strong>Mitigation:</strong> For very large recordings, extract and inspect specific parts:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub recording extract recording.zip --password mysecret --output-dir ./extracted</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Manually inspect http/cassette.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-lazy-imports">11. Lazy Imports<a href="#11-lazy-imports" class="hash-link" aria-label="Direct link to 11. Lazy Imports" title="Direct link to 11. Lazy Imports">​</a></h3><p>The recording module uses lazy imports to avoid requiring optional dependencies when recording is not used:</p><ul><li><code>sqlalchemy</code> is only imported when actually recording/replaying SQLAlchemy-based sources</li><li><code>RecordingConfig</code>, <code>IngestionRecorder</code>, and <code>IngestionReplayer</code> are imported on-demand via <code>__getattr__</code></li><li>This allows installing the recording plugin without pulling in database connector dependencies</li><li>This also allows other sources not depending on SQLAlchemy (e.g., HTTP-based sources like Looker, PowerBI) to be safely installed when no recording is used</li></ul><p><strong>Impact:</strong> This is transparent to users - the recording system works exactly the same, but with better dependency isolation. The <code>debug-recording</code> plugin is designed to be installed alongside source connectors, not as a standalone package. Dependencies like <code>sqlalchemy</code> are expected to be provided by the source connector itself when needed.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="supported-sources">Supported Sources<a href="#supported-sources" class="hash-link" aria-label="Direct link to Supported Sources" title="Direct link to Supported Sources">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fully-supported-http-based">Fully Supported (HTTP-based)<a href="#fully-supported-http-based" class="hash-link" aria-label="Direct link to Fully Supported (HTTP-based)" title="Direct link to Fully Supported (HTTP-based)">​</a></h3><table><thead><tr><th>Source</th><th>HTTP Recording</th><th>Notes</th></tr></thead><tbody><tr><td>Looker</td><td>✅</td><td>Full support including SDK calls</td></tr><tr><td>PowerBI</td><td>✅</td><td>Full support</td></tr><tr><td>Tableau</td><td>✅</td><td>Full support</td></tr><tr><td>Superset</td><td>✅</td><td>Full support</td></tr><tr><td>Mode</td><td>✅</td><td>Full support</td></tr><tr><td>Sigma</td><td>✅</td><td>Full support</td></tr><tr><td>dbt Cloud</td><td>✅</td><td>Full support</td></tr><tr><td>Fivetran</td><td>✅</td><td>Full support</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="database-sources">Database Sources<a href="#database-sources" class="hash-link" aria-label="Direct link to Database Sources" title="Direct link to Database Sources">​</a></h3><table><thead><tr><th>Source</th><th>HTTP Recording</th><th>DB Recording</th><th>Strategy</th><th>Notes</th></tr></thead><tbody><tr><td>Snowflake</td><td>❌ Not needed</td><td>✅ Full</td><td>Connection wrapper</td><td>Native connector wrapped at <code>connect()</code></td></tr><tr><td>Redshift</td><td>N/A</td><td>✅ Full</td><td>Connection wrapper</td><td>Native connector wrapped at <code>connect()</code></td></tr><tr><td>Databricks</td><td>❌ Not needed</td><td>✅ Full</td><td>Connection wrapper</td><td>Native connector wrapped at <code>connect()</code></td></tr><tr><td>BigQuery</td><td>✅ (REST API)</td><td>✅ Full</td><td>Client wrapper</td><td>Client class wrapped</td></tr><tr><td>PostgreSQL</td><td>N/A</td><td>✅ Full</td><td>Connection.execute() wrapper</td><td>SQLAlchemy <code>connection.execute()</code> wrapped</td></tr><tr><td>MySQL</td><td>N/A</td><td>✅ Full</td><td>Connection.execute() wrapper</td><td>SQLAlchemy <code>connection.execute()</code> wrapped</td></tr><tr><td>SQLite</td><td>N/A</td><td>✅ Full</td><td>Connection.execute() wrapper</td><td>SQLAlchemy <code>connection.execute()</code> wrapped</td></tr><tr><td>MSSQL</td><td>N/A</td><td>✅ Full</td><td>Connection.execute() wrapper</td><td>SQLAlchemy <code>connection.execute()</code> wrapped</td></tr></tbody></table><p><strong>Note:</strong> File staging operations (PUT/GET) are not used in metadata extraction and are therefore not a concern for recording/replay.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="hybrid-recording-strategy">Hybrid Recording Strategy<a href="#hybrid-recording-strategy" class="hash-link" aria-label="Direct link to Hybrid Recording Strategy" title="Direct link to Hybrid Recording Strategy">​</a></h4><p>The recording system uses a <strong>hybrid approach</strong> that selects the best interception method for each database connector type:</p><p><strong>1. Wrapper Strategy (Native Connectors)</strong></p><ul><li><strong>Used for:</strong> Snowflake, Redshift, Databricks, BigQuery</li><li><strong>How it works:</strong> Wraps the connector&#x27;s <code>connect()</code> function or Client class</li><li><strong>Why:</strong> These connectors have direct <code>connect()</code> functions that return connections we can wrap</li><li><strong>Implementation:</strong> <code>ConnectionProxy</code> wraps the real connection, <code>CursorProxy</code> intercepts queries</li></ul><p><strong>2. Connection.execute() Wrapper Strategy (SQLAlchemy-based)</strong></p><ul><li><strong>Used for:</strong> PostgreSQL, MySQL, SQLite, MSSQL, and other SQLAlchemy-based sources</li><li><strong>How it works:</strong> Wraps <code>engine.connect()</code> to intercept connections, then wraps <code>connection.execute()</code> to capture queries and results</li><li><strong>Why:</strong> SQLAlchemy 2.x uses Result objects that are best captured at the <code>execute()</code> level, avoiding import reference issues with modules that import <code>create_engine</code> directly</li><li><strong>Implementation:</strong> Wraps <code>engine.connect()</code> to return connections with wrapped <code>execute()</code> methods that materialize and record results</li><li><strong>Benefits:</strong> Works even when modules import <code>create_engine</code> directly (e.g., <code>from sqlalchemy import create_engine</code>), avoiding stale reference issues</li></ul><p><strong>Why Different Strategies?</strong></p><ul><li><strong>Native connectors</strong> (Snowflake, Redshift) expose direct <code>connect()</code> functions that are easy to wrap</li><li><strong>SQLAlchemy-based sources</strong> use connection pooling and engines. Wrapping <code>connection.execute()</code> captures Result objects directly, avoiding issues with modules that import <code>create_engine</code> directly</li><li><strong>BigQuery</strong> uses a Client class pattern, requiring class-level wrapping</li></ul><p>Both strategies achieve the same goal: intercepting SQL queries and results for recording/replay, but use the most appropriate method for each connector&#x27;s architecture.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="database-connection-architecture">Database Connection Architecture<a href="#database-connection-architecture" class="hash-link" aria-label="Direct link to Database Connection Architecture" title="Direct link to Database Connection Architecture">​</a></h4><p>Database sources have a two-phase execution model:</p><p><strong>Phase 1: Authentication (During <code>connect()</code>)</strong></p><ul><li>Uses source-specific HTTP clients (may be vendored/custom)</li><li>NOT recorded (but also not needed during replay)</li><li>During replay: Bypassed entirely with mock connection</li><li>Automatic retry if VCR interferes with connection</li></ul><p><strong>Phase 2: SQL Execution (After <code>connect()</code>)</strong></p><ul><li>Uses standard Python DB-API 2.0 cursor interface</li><li>Fully recorded via <code>CursorProxy</code> (works for both wrapper strategies)</li><li>Protocol-agnostic (works for any DB-API connector)</li><li>During replay: Served from recorded <code>queries.jsonl</code></li></ul><p>This architecture makes recording resilient to HTTP library changes while maintaining perfect SQL replay fidelity. For Snowflake and Databricks, all metadata extraction happens via SQL queries in Phase 2, making HTTP recording unnecessary.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="datahub-backend">DataHub Backend<a href="#datahub-backend" class="hash-link" aria-label="Direct link to DataHub Backend" title="Direct link to DataHub Backend">​</a></h3><table><thead><tr><th>Component</th><th>Recording</th><th>Notes</th></tr></thead><tbody><tr><td>GMS REST API</td><td>✅</td><td>Sink emissions captured</td></tr><tr><td>GraphQL API</td><td>✅</td><td>If used by source</td></tr><tr><td>Stateful Backend</td><td>✅</td><td>Checkpoint calls captured</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="module-not-found-vcrpy">&quot;Module not found: vcrpy&quot;<a href="#module-not-found-vcrpy" class="hash-link" aria-label="Direct link to &quot;Module not found: vcrpy&quot;" title="Direct link to &quot;Module not found: vcrpy&quot;">​</a></h3><p>Install the debug-recording plugin:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;acryl-datahub[debug-recording]&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="checksum-verification-failed">&quot;Checksum verification failed&quot;<a href="#checksum-verification-failed" class="hash-link" aria-label="Direct link to &quot;Checksum verification failed&quot;" title="Direct link to &quot;Checksum verification failed&quot;">​</a></h3><p>The archive may be corrupted. Re-download or re-record:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub recording info recording.zip --password mysecret</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Check for checksum errors in output</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="no-match-for-request-during-replay">&quot;No match for request&quot; during replay<a href="#no-match-for-request-during-replay" class="hash-link" aria-label="Direct link to &quot;No match for request&quot; during replay" title="Direct link to &quot;No match for request&quot; during replay">​</a></h3><p>The recorded cassette doesn&#x27;t have a matching request. This can happen if:</p><ol><li>Recording was incomplete (check <code>has_exception</code> in manifest)</li><li>Source behavior changed between recording and replay</li><li>Different credentials caused different API paths</li></ol><p><strong>Solution:</strong> Re-record with the exact same configuration.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="replay-produces-different-event-count">Replay produces different event count<a href="#replay-produces-different-event-count" class="hash-link" aria-label="Direct link to Replay produces different event count" title="Direct link to Replay produces different event count">​</a></h3><p>A small difference in event count (e.g., 3259 vs 3251) is normal due to:</p><ul><li>Duplicate MCP emissions during recording</li><li>Timing-dependent code paths</li><li>Non-deterministic processing order</li></ul><p><strong>Verification:</strong> Use <code>datahub check metadata-diff</code> to confirm semantic equivalence:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub check metadata-diff </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --ignore-path </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;root[&#x27;*&#x27;][&#x27;systemMetadata&#x27;][&#x27;lastObserved&#x27;]&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --ignore-path </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;root[&#x27;*&#x27;][&#x27;systemMetadata&#x27;][&#x27;runId&#x27;]&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    recording_output.json replay_output.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A &quot;PERFECT SEMANTIC MATCH&quot; confirms the replay is correct despite count differences.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="recording-takes-too-long">Recording takes too long<a href="#recording-takes-too-long" class="hash-link" aria-label="Direct link to Recording takes too long" title="Direct link to Recording takes too long">​</a></h3><p>HTTP requests are serialized during recording for reliability. To speed up:</p><ol><li>Reduce source scope with patterns</li><li>Use <code>--no-s3-upload</code> for local testing</li><li>Accept that recording is slower than normal ingestion</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="archive-too-large-for-s3-upload">Archive too large for S3 upload<a href="#archive-too-large-for-s3-upload" class="hash-link" aria-label="Direct link to Archive too large for S3 upload" title="Direct link to Archive too large for S3 upload">​</a></h3><p>Large archives may timeout during upload:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Record locally first</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">datahub ingest run -c recipe.yaml --record --record-password mysecret --no-s3-upload</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Upload manually with multipart</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">aws s3 </span><span class="token function" style="color:rgb(130, 170, 255)">cp</span><span class="token plain"> recording.zip s3://bucket/recordings/ --expected-size </span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">stat</span><span class="token variable" style="color:rgb(191, 199, 213)"> -f%z recording.zip</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="architecture">Architecture<a href="#architecture" class="hash-link" aria-label="Direct link to Architecture" title="Direct link to Architecture">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│                    IngestionRecorder                         │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│  ┌─────────────────┐  ┌─────────────────┐  ┌──────────────┐ │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│  │  HTTPRecorder   │  │   ModulePatcher │  │ QueryRecorder│ │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│  │  (VCR.py)       │  │   (DB proxies)  │  │  (JSONL)     │ │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│  └────────┬────────┘  └────────┬────────┘  └──────┬───────┘ │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│           │                    │                   │         │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│           ▼                    ▼                   ▼         │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│  ┌─────────────────────────────────────────────────────────┐│</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│  │                 Encrypted Archive                        ││</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌────────────┐  ││</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│  │  │manifest  │ │ recipe   │ │cassette  │ │queries.jsonl│ ││</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│  │  │.json     │ │ .yaml    │ │.yaml     │ │            │  ││</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│  │  └──────────┘ └──────────┘ └──────────┘ └────────────┘  ││</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│  └─────────────────────────────────────────────────────────┘│</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                              ▼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│                    IngestionReplayer                         │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│  ┌─────────────────┐  ┌─────────────────┐  ┌──────────────┐ │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│  │  HTTPReplayer   │  │  ReplayPatcher  │  │ QueryReplayer│ │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│  │  (VCR replay)   │  │  (Mock conns)   │  │  (Mock cursor│ │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│  └─────────────────┘  └─────────────────┘  └──────────────┘ │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│                              │                               │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│                              ▼                               │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│              ┌──────────────────────────────┐               │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│              │    Air-Gapped Replay         │               │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│              │  - No network required       │               │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│              │  - Full debugger support     │               │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│              │  - Exact reproduction        │               │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│              └──────────────────────────────┘               │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="contributing">Contributing<a href="#contributing" class="hash-link" aria-label="Direct link to Contributing" title="Direct link to Contributing">​</a></h2><p>When adding new source connectors:</p><ol><li>HTTP-based sources work automatically via VCR</li><li>Database sources may need additions to <code>patcher.py</code> for their specific connector</li><li>Test recording and replay with the new source before releasing</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="see-also">See Also<a href="#see-also" class="hash-link" aria-label="Direct link to See Also" title="Direct link to See Also">​</a></h2><ul><li><a href="https://datahubproject.io/docs/metadata-ingestion" target="_blank" rel="noopener noreferrer">DataHub Ingestion Framework</a></li><li><a href="https://vcrpy.readthedocs.io/" target="_blank" rel="noopener noreferrer">VCR.py Documentation</a></li><li><a href="https://datahubproject.io/docs/how/debugging" target="_blank" rel="noopener noreferrer">Debugging Ingestion Issues</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="slackUtm_uoBr"><div class="slackUtm_uoBr"><hr>Need more help? Join the conversation in <a href="https://datahub.com/slack?utm_source=docs&amp;utm_medium=footer&amp;utm_campaign=docs_footer&amp;utm_content=metadata-ingestion/src/datahub/ingestion/recording/README">Slack!</a></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/datahub-project/datahub/blob/master/metadata-ingestion/src/datahub/ingestion/recording/README.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_VsjB"></div></div></footer><div class="feedbackWrapper_mUHF"><div class="feedbackWidget_PX4d"><div class="feedbackButtons_wn3V"><strong>Is this page helpful?</strong><div><button class="feedbackButton_UgQs"><span role="img" aria-label="like" class="anticon anticon-like"><svg viewBox="64 64 896 896" focusable="false" data-icon="like" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M885.9 533.7c16.8-22.2 26.1-49.4 26.1-77.7 0-44.9-25.1-87.4-65.5-111.1a67.67 67.67 0 00-34.3-9.3H572.4l6-122.9c1.4-29.7-9.1-57.9-29.5-79.4A106.62 106.62 0 00471 99.9c-52 0-98 35-111.8 85.1l-85.9 311H144c-17.7 0-32 14.3-32 32v364c0 17.7 14.3 32 32 32h601.3c9.2 0 18.2-1.8 26.5-5.4 47.6-20.3 78.3-66.8 78.3-118.4 0-12.6-1.8-25-5.4-37 16.8-22.2 26.1-49.4 26.1-77.7 0-12.6-1.8-25-5.4-37 16.8-22.2 26.1-49.4 26.1-77.7-.2-12.6-2-25.1-5.6-37.1zM184 852V568h81v284h-81zm636.4-353l-21.9 19 13.9 25.4a56.2 56.2 0 016.9 27.3c0 16.5-7.2 32.2-19.6 43l-21.9 19 13.9 25.4a56.2 56.2 0 016.9 27.3c0 16.5-7.2 32.2-19.6 43l-21.9 19 13.9 25.4a56.2 56.2 0 016.9 27.3c0 22.4-13.2 42.6-33.6 51.8H329V564.8l99.5-360.5a44.1 44.1 0 0142.2-32.3c7.6 0 15.1 2.2 21.1 6.7 9.9 7.4 15.2 18.6 14.6 30.5l-9.6 198.4h314.4C829 418.5 840 436.9 840 456c0 16.5-7.2 32.1-19.6 43z"></path></svg></span></button><button class="feedbackButton_UgQs"><span role="img" aria-label="dislike" class="anticon anticon-dislike"><svg viewBox="64 64 896 896" focusable="false" data-icon="dislike" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M885.9 490.3c3.6-12 5.4-24.4 5.4-37 0-28.3-9.3-55.5-26.1-77.7 3.6-12 5.4-24.4 5.4-37 0-28.3-9.3-55.5-26.1-77.7 3.6-12 5.4-24.4 5.4-37 0-51.6-30.7-98.1-78.3-118.4a66.1 66.1 0 00-26.5-5.4H144c-17.7 0-32 14.3-32 32v364c0 17.7 14.3 32 32 32h129.3l85.8 310.8C372.9 889 418.9 924 470.9 924c29.7 0 57.4-11.8 77.9-33.4 20.5-21.5 31-49.7 29.5-79.4l-6-122.9h239.9c12.1 0 23.9-3.2 34.3-9.3 40.4-23.5 65.5-66.1 65.5-111 0-28.3-9.3-55.5-26.1-77.7zM184 456V172h81v284h-81zm627.2 160.4H496.8l9.6 198.4c.6 11.9-4.7 23.1-14.6 30.5-6.1 4.5-13.6 6.8-21.1 6.7a44.28 44.28 0 01-42.2-32.3L329 459.2V172h415.4a56.85 56.85 0 0133.6 51.8c0 9.7-2.3 18.9-6.9 27.3l-13.9 25.4 21.9 19a56.76 56.76 0 0119.6 43c0 9.7-2.3 18.9-6.9 27.3l-13.9 25.4 21.9 19a56.76 56.76 0 0119.6 43c0 9.7-2.3 18.9-6.9 27.3l-14 25.5 21.9 19a56.76 56.76 0 0119.6 43c0 19.1-11 37.5-28.8 48.4z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a><ul><li><a href="#comparing-recording-and-replay-output" class="table-of-contents__link toc-highlight">Comparing Recording and Replay Output</a></li></ul></li><li><a href="#installation" class="table-of-contents__link toc-highlight">Installation</a></li><li><a href="#quick-start" class="table-of-contents__link toc-highlight">Quick Start</a><ul><li><a href="#recording-an-ingestion-run" class="table-of-contents__link toc-highlight">Recording an Ingestion Run</a></li><li><a href="#replaying-a-recording" class="table-of-contents__link toc-highlight">Replaying a Recording</a></li><li><a href="#inspecting-recordings" class="table-of-contents__link toc-highlight">Inspecting Recordings</a></li></ul></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a><ul><li><a href="#recipe-configuration" class="table-of-contents__link toc-highlight">Recipe Configuration</a></li><li><a href="#environment-variables" class="table-of-contents__link toc-highlight">Environment Variables</a></li><li><a href="#cli-options" class="table-of-contents__link toc-highlight">CLI Options</a></li></ul></li><li><a href="#archive-format" class="table-of-contents__link toc-highlight">Archive Format</a><ul><li><a href="#manifest-contents" class="table-of-contents__link toc-highlight">Manifest Contents</a></li></ul></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a><ul><li><a href="#1-use-consistent-passwords" class="table-of-contents__link toc-highlight">1. Use Consistent Passwords</a></li><li><a href="#2-record-in-production-like-environments" class="table-of-contents__link toc-highlight">2. Record in Production-Like Environments</a></li><li><a href="#3-use-descriptive-run-ids" class="table-of-contents__link toc-highlight">3. Use Descriptive Run IDs</a></li><li><a href="#4-test-replay-immediately" class="table-of-contents__link toc-highlight">4. Test Replay Immediately</a></li><li><a href="#5-include-exception-context" class="table-of-contents__link toc-highlight">5. Include Exception Context</a></li><li><a href="#6-secure-archive-handling" class="table-of-contents__link toc-highlight">6. Secure Archive Handling</a></li><li><a href="#7-minimize-recording-scope" class="table-of-contents__link toc-highlight">7. Minimize Recording Scope</a></li></ul></li><li><a href="#limitations" class="table-of-contents__link toc-highlight">Limitations</a><ul><li><a href="#1-thread-safe-recording-impact" class="table-of-contents__link toc-highlight">1. Thread-Safe Recording Impact</a></li><li><a href="#2-timestamps-differ-between-runs" class="table-of-contents__link toc-highlight">2. Timestamps Differ Between Runs</a></li><li><a href="#3-non-deterministic-source-behavior" class="table-of-contents__link toc-highlight">3. Non-Deterministic Source Behavior</a></li><li><a href="#4-database-connection-mocking" class="table-of-contents__link toc-highlight">4. Database Connection Mocking</a></li><li><a href="#5-large-recordings" class="table-of-contents__link toc-highlight">5. Large Recordings</a></li><li><a href="#6-secret-handling" class="table-of-contents__link toc-highlight">6. Secret Handling</a></li><li><a href="#7-http-only-for-some-sources" class="table-of-contents__link toc-highlight">7. HTTP-Only for Some Sources</a></li><li><a href="#8-vendored-http-libraries-snowflake-databricks" class="table-of-contents__link toc-highlight">8. Vendored HTTP Libraries (Snowflake, Databricks)</a></li><li><a href="#9-stateful-ingestion" class="table-of-contents__link toc-highlight">9. Stateful Ingestion</a></li><li><a href="#10-memory-usage" class="table-of-contents__link toc-highlight">10. Memory Usage</a></li><li><a href="#11-lazy-imports" class="table-of-contents__link toc-highlight">11. Lazy Imports</a></li></ul></li><li><a href="#supported-sources" class="table-of-contents__link toc-highlight">Supported Sources</a><ul><li><a href="#fully-supported-http-based" class="table-of-contents__link toc-highlight">Fully Supported (HTTP-based)</a></li><li><a href="#database-sources" class="table-of-contents__link toc-highlight">Database Sources</a></li><li><a href="#datahub-backend" class="table-of-contents__link toc-highlight">DataHub Backend</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#module-not-found-vcrpy" class="table-of-contents__link toc-highlight">&quot;Module not found: vcrpy&quot;</a></li><li><a href="#checksum-verification-failed" class="table-of-contents__link toc-highlight">&quot;Checksum verification failed&quot;</a></li><li><a href="#no-match-for-request-during-replay" class="table-of-contents__link toc-highlight">&quot;No match for request&quot; during replay</a></li><li><a href="#replay-produces-different-event-count" class="table-of-contents__link toc-highlight">Replay produces different event count</a></li><li><a href="#recording-takes-too-long" class="table-of-contents__link toc-highlight">Recording takes too long</a></li><li><a href="#archive-too-large-for-s3-upload" class="table-of-contents__link toc-highlight">Archive too large for S3 upload</a></li></ul></li><li><a href="#architecture" class="table-of-contents__link toc-highlight">Architecture</a></li><li><a href="#contributing" class="table-of-contents__link toc-highlight">Contributing</a></li><li><a href="#see-also" class="table-of-contents__link toc-highlight">See Also</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/quickstart">Quickstart</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://datahub.com/slack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UC3qFQC5IiwR5fvWEqi_tJ5w" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://medium.com/datahub-project" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/townhalls">Town Halls</a></li><li class="footer__item"><a href="https://datahub.com/resources/?2004611554=dh-stories" target="_blank" rel="noopener noreferrer" class="footer__link-item">Customer Stories<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://demo.datahub.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Demo</a></li><li class="footer__item"><a href="https://feature-requests.datahubproject.io/roadmap" target="_blank" rel="noopener noreferrer" class="footer__link-item">Roadmap<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/contributing">Contributing</a></li><li class="footer__item"><a href="https://github.com/datahub-project/datahub" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://feature-requests.datahubproject.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Feature Requests<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2015-2026 DataHub Project Authors.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.07d6be07.js"></script>
<script src="/assets/js/main.561472ac.js"></script>
</body>
</html>