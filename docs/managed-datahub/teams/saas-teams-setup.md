import FeatureAvailability from '@site/src/components/FeatureAvailability';

# Microsoft Teams App Setup

<FeatureAvailability saasOnly />

## Installing the DataHub Microsoft Teams App

To enable the DataHub Teams app, you will need to install the DataHub Teams bot into your Teams workspace.
DataHub Teams app is currently in **Private Beta** - you will need to manually upload the Teams app package (a ZIP file) to your Teams workspace.

The following steps should be performed by a Teams or Azure Administrator:

(Here's where I need help - specifically what steps need to be performed inside
of teams and datahub to link the two. you can include screenshots using the format below).

<p align="center">
    <img width="80%" alt="Example Ask DataHub in Microsoft Teams." src="https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/ask_datahub.png" />
</p>

### Required Bot Permissions (Also need validation here - was generated by AI)

The DataHub Teams bot requires certain Microsoft Graph permissions to function. We've listed them below with their explanations:

```
# Required to resolve DataHub users to Teams user IDs
User.Read.All

# Required to read team membership information
TeamMember.Read.All

# Required to read basic channel information for @DataHub chat sessions
Channel.ReadBasic.All
```

## Connecting Your Teams Account

To receive personal notifications via teams (e.g. for asset subscriptions), you'll need to connect your Teams account to your DataHub user profile.
This can be done by navigating to **Settings** > **My Notifications** and enable Teams notifications by clicking the toggle
switch on the right hand side.

<p align="center">
    <img width="80%" alt="Connect to Microsoft Teams." src="https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/connect_user.png" />
</p>

Next, click **Connect to Teams** to be redirected to teams, where you can bind your account.
Upon successfully linking accounts, you'll be redirected to DataHub.

<p align="center">
    <img width="80%" alt="Connected to Microsoft Teams." src="https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/connected_user.png" />
</p>

## Troubleshooting

**"App won't upload to Teams"**

- Ensure you have Teams admin permissions
- Check ZIP file isn't corrupted
- Verify custom app uploads are enabled in Teams admin center

**"Bot doesn't respond to commands"**

- Verify webhook URL is correct in Azure Bot Service
- Check that credentials were provided correctly to DataHub
- Ensure Bot Framework channel is enabled for Teams

**"Permission errors in Azure"**

- Verify admin consent was granted for API permissions
- Check client secret hasn't expired
- Confirm app ID and tenant ID are correct
