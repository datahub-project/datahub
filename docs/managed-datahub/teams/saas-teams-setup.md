import FeatureAvailability from '@site/src/components/FeatureAvailability';

# Microsoft Teams App Setup

<FeatureAvailability saasOnly />

## Installing the DataHub Microsoft Teams App

To enable the DataHub Teams app, you will need to install the DataHub Teams bot into your Teams workspace.
DataHub Teams app is currently in **Private Beta** - you will need to manually upload the Teams app package (a ZIP file) to your Teams workspace.

The following steps should be performed by a Teams or Azure Administrator:

1. Download Teams App zip package from [here](https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/setup/datahub-teams.zip)
1. Open [Teams Admin UI](https://admin.teams.microsoft.com/) in your web browser, and in the side bar click "Teams Apps" -> "Manage Apps"
   <p align="center"><img width="80%" alt="Connected to Microsoft Teams." src="https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/setup/step-1.png" /></p>
1. On the Apps page, click "Actions" -> "Upload new app"
   <p align="center"><img width="80%" alt="Connected to Microsoft Teams." src="https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/setup/step-2.png" /></p>
1. In the "Upload a custom app" window, click "Upload" button, and then in the file browser, select the zip package you obtained in Step #1.
   <p align="center"><img width="80%" alt="Connected to Microsoft Teams." src="https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/setup/step-3.png" /></p>
1. Once the app is uploaded, log out of Teams Admin and User UIs, wait 5 min and then log back into [Teams Web UI](https://teams.microsoft.com/v2/) in a new tab.
   <p align="center"><img width="80%" alt="Connected to Microsoft Teams." src="https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/setup/step-4.png" /></p>
1. On the side bar in the Teams Web UI, click "Apps" -> "Built for your org"
   <p align="center"><img width="80%" alt="Connected to Microsoft Teams." src="https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/setup/step-5.png" /></p>
1. On "Built for your org" page, locate "DataHub" application in the list, and click "Add" button.
   <p align="center"><img width="80%" alt="Connected to Microsoft Teams." src="https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/setup/step-6.png" /></p>
   <p align="center"><img width="80%" alt="Connected to Microsoft Teams." src="https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/setup/step-7.png" /></p>
1. Confirm installation by clicking "Add" button in the pop-up window
   <p align="center"><img width="80%" alt="Connected to Microsoft Teams." src="https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/setup/step-8.png" /></p>
1. In the pop-up window, click "Open" button to open a chat window with the DataHub Teams bot.
   <p align="center"><img width="80%" alt="Connected to Microsoft Teams." src="https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/setup/step-9.png" /></p>
1. On the side bar, click "Chat", locate your team name in the list, click "..." button next to it to open a dropdown manu, and click "Copy Link"
   <p align="center"><img width="80%" alt="Connected to Microsoft Teams." src="https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/setup/step-10.png" /></p>
1. In a separate web browser tab, open your DataHub instance UI, go to "Settings" -> "Integrations" and click "Teams"
   <p align="center"><img width="80%" alt="Connected to Microsoft Teams." src="https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/setup/step-11.png" /></p>
1. Paste the URL obtained is Step #10 into the Teams URL field, and click "Connect to Teams" button.
   <p align="center"><img width="80%" alt="Connected to Microsoft Teams." src="https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/setup/step-12.png" /></p>
1. When promtped, complete your Teams authentication flow as usual.
1. Your Teams integration is now ready to use.

### Required Bot Permissions (Also need validation here - was generated by AI)

The DataHub Teams bot requires certain Microsoft Graph permissions to function. We've listed them below with their explanations:

```
# Required to resolve DataHub users to Teams user IDs
User.Read.All

# Required to read team membership information
TeamMember.Read.All

# Required to read basic channel information for @DataHub chat sessions
Channel.ReadBasic.All
```

## Connecting Your Teams Account

To receive personal notifications via teams (e.g. for asset subscriptions), you'll need to connect your Teams account to your DataHub user profile.
This can be done by navigating to **Settings** > **My Notifications** and enable Teams notifications by clicking the toggle
switch on the right hand side.

<p align="center">
    <img width="80%" alt="Connect to Microsoft Teams." src="https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/connect_user.png" />
</p>

Next, click **Connect to Teams** to be redirected to teams, where you can bind your account.
Upon successfully linking accounts, you'll be redirected to DataHub.

<p align="center">
    <img width="80%" alt="Connected to Microsoft Teams." src="https://raw.githubusercontent.com/datahub-project/static-assets/main/imgs/saas/teams/connected_user.png" />
</p>

## Troubleshooting

**"App won't upload to Teams"**

- Ensure you have Teams admin permissions
- Check ZIP file isn't corrupted
- Verify custom app uploads are enabled in Teams admin center

**"Bot doesn't respond to commands"**

- Verify webhook URL is correct in Azure Bot Service
- Check that credentials were provided correctly to DataHub
- Ensure Bot Framework channel is enabled for Teams

**"Permission errors in Azure"**

- Verify admin consent was granted for API permissions
- Check client secret hasn't expired
- Confirm app ID and tenant ID are correct
