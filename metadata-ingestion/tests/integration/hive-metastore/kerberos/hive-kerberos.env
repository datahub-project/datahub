# =============================================================================
# Kerberos Environment Variables for Hive Services
# =============================================================================
# These override/extend the base hadoop-hive.env settings.
#
# IMPORTANT NOTES:
# 1. Only HMS requires Kerberos in customer's environment
# 2. HiveServer2 uses NONE auth since customer doesn't have it
# 3. HDFS is NOT Kerberized - we use fallback to simple auth
# 4. Proxy user config is in docker-compose.kerberos.yml (namenode)
# =============================================================================

# -----------------------------------------------------------------------------
# Hive Metastore SASL/Kerberos Configuration
# This is the PRIMARY authentication target
# -----------------------------------------------------------------------------
HIVE_SITE_CONF_hive_metastore_sasl_enabled=true
HIVE_SITE_CONF_hive_metastore_kerberos_keytab_file=/keytabs/hive.keytab
# Use FQDN to match Python/MIT Kerberos canonicalization
HIVE_SITE_CONF_hive_metastore_kerberos_principal=hive/hive-metastore.test.local@TEST.LOCAL

# -----------------------------------------------------------------------------
# HiveServer2 Configuration
# Set to NONE since customer doesn't have HiveServer2
# This also simplifies test data loading
# -----------------------------------------------------------------------------
HIVE_SITE_CONF_hive_server2_authentication=NONE

# -----------------------------------------------------------------------------
# Hadoop Security Configuration
# -----------------------------------------------------------------------------
# Enable Kerberos for Hadoop services (required for HMS keytab login)
CORE_CONF_hadoop_security_authentication=kerberos
CORE_CONF_hadoop_security_authorization=false

# CRITICAL: Allow fallback to simple auth for HDFS connections
# Our HDFS cluster is NOT Kerberized, so this is required
CORE_CONF_ipc_client_fallback___to___simple___auth___allowed=true

# Disable HDFS block access tokens (not needed without Kerberized HDFS)
HDFS_CONF_dfs_block_access_token_enable=false

# -----------------------------------------------------------------------------
# Debug Settings
# -----------------------------------------------------------------------------
HADOOP_JAAS_DEBUG=true
HADOOP_OPTS=-Dsun.security.krb5.debug=false -Djavax.security.auth.useSubjectCredsOnly=false
